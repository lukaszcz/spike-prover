\documentclass[12pt]{report}
\usepackage[]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fullpage}
\usepackage{coqdoc}
\usepackage{amsmath,amssymb}
\usepackage{url}
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% This file has been automatically generated with the command
%% coqdoc --latex even_odd.v even_odd_spec.v ../../../Coccinelle/Coq8.5/rpo.v 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\coqlibrary{rpo}{Library }{rpo}

\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Bool}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{List}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{closure}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{more\_list}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{equiv\_list}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{list\_permut}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{dickson}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Relations}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Wellfounded}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Arith}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Wf\_nat}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{term\_spec}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{term}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{decidable\_set}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{ordered\_set}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Recdef}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Program}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Set Implicit Arguments}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
A non-dependant version of lexicographic extension. \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{lex} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) \coqdoceol
\coqdocindent{2.50em}
(\coqdocvar{eq\_bool} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) \coqdoceol
\coqdocindent{2.50em}
(\coqdocvar{o1} : \coqdocvar{relation} \coqdocvar{A}) (\coqdocvar{o2} : \coqdocvar{relation} \coqdocvar{B}) (\coqdocvar{s} \coqdocvar{t} : \coqdocvar{\_} \ensuremath{\times} \coqdocvar{\_}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} (\coqdocvar{s1},\coqdocvar{s2}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{match} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} (\coqdocvar{t1},\coqdocvar{t2}) \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{3.50em}
\coqdockw{if} \coqdocvar{eq\_bool} \coqdocvar{s1} \coqdocvar{t1}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{then} \coqdocvar{o2} \coqdocvar{s2} \coqdocvar{t2}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{else} \coqdocvar{o1} \coqdocvar{s1} \coqdocvar{t1}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Transitivity of  lexicographic extension. \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lex\_trans} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) (\coqdocvar{eq\_bool} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) \coqdocvar{o1} \coqdocvar{o2}\coqdoceol
\coqdocindent{0.50em}
(\coqdocvar{eq\_bool\_ok} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a1} \coqdocvar{a2}, \coqdockw{if} \coqdocvar{eq\_bool} \coqdocvar{a1} \coqdocvar{a2} \coqdockw{then} \coqdocvar{a1} = \coqdocvar{a2} \coqdockw{else} \coqdocvar{a1} \ensuremath{\not=} \coqdocvar{a2}), \coqdoceol
\coqdocindent{0.50em}
\coqdocvar{antisymmetric} \coqdocvar{A} \coqdocvar{o1} \ensuremath{\rightarrow} \coqdocvar{transitive} \coqdocvar{A} \coqdocvar{o1} \ensuremath{\rightarrow} \coqdocvar{transitive} \coqdocvar{B} \coqdocvar{o2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{transitive} \coqdocvar{\_} (\coqdocvar{lex} \coqdocvar{eq\_bool} \coqdocvar{o1} \coqdocvar{o2}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{transitive}, \coqdocvar{lex}; \coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{A} \coqdocvar{B} \coqdocvar{eq\_bool} \coqdocvar{o1} \coqdocvar{o2} \coqdocvar{eq\_bool\_ok} \coqdocvar{A1} \coqdocvar{T1} \coqdocvar{T2} \coqdocvar{p1} \coqdocvar{p2} \coqdocvar{p3}; \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{p1} \coqdockw{as} [\coqdocvar{a1} \coqdocvar{b1}]; \coqdoctac{destruct} \coqdocvar{p2} \coqdockw{as} [\coqdocvar{a2} \coqdocvar{b2}]; \coqdoctac{destruct} \coqdocvar{p3} \coqdockw{as} [\coqdocvar{a3} \coqdocvar{b3}].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{eq\_bool\_ok} \coqdocvar{a1} \coqdocvar{a2}); \coqdoctac{case} (\coqdocvar{eq\_bool} \coqdocvar{a1} \coqdocvar{a2}); [\coqdoctac{intro} \coqdocvar{a1\_eq\_a2}; \coqdoctac{subst} \coqdocvar{a1} \ensuremath{|} \coqdoctac{intro} \coqdocvar{a1\_diff\_a2}].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{eq\_bool\_ok} \coqdocvar{a2} \coqdocvar{a3}); \coqdoctac{case} (\coqdocvar{eq\_bool} \coqdocvar{a2} \coqdocvar{a3}); [\coqdoctac{intro} \coqdocvar{a2\_eq\_a3}; \coqdoctac{subst} \coqdocvar{a2} \ensuremath{|} \coqdoctac{intro} \coqdocvar{a2\_diff\_a3}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{T2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_} \coqdocvar{a2\_t\_a3}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{eq\_bool\_ok} \coqdocvar{a2} \coqdocvar{a3}); \coqdoctac{case} (\coqdocvar{eq\_bool} \coqdocvar{a2} \coqdocvar{a3}); [\coqdoctac{intro} \coqdocvar{a2\_eq\_a3}; \coqdoctac{subst} \coqdocvar{a2} \ensuremath{|} \coqdoctac{intro} \coqdocvar{a2\_diff\_a3}].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{eq\_bool\_ok} \coqdocvar{a1} \coqdocvar{a3}); \coqdoctac{case} (\coqdocvar{eq\_bool} \coqdocvar{a1} \coqdocvar{a3}); [\coqdoctac{intro} \coqdocvar{a1\_eq\_a3}; \coqdoctac{subst} \coqdocvar{a1} \ensuremath{|} \coqdoctac{intro} \coqdocvar{a1\_diff\_a3}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{a1\_diff\_a2}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a1\_lt\_a3} \coqdocvar{\_}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{eq\_bool\_ok} \coqdocvar{a1} \coqdocvar{a3}); \coqdoctac{case} (\coqdocvar{eq\_bool} \coqdocvar{a1} \coqdocvar{a3}); [\coqdoctac{intro} \coqdocvar{a1\_eq\_a3}; \coqdoctac{subst} \coqdocvar{a1} \ensuremath{|} \coqdoctac{intro} \coqdocvar{a1\_diff\_a3}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a3\_lt\_a2} \coqdocvar{a2\_lt\_a3}; \coqdocvar{absurd} (\coqdocvar{a3} = \coqdocvar{a2}).\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} ( \coqdocvar{A1} \coqdocvar{a3} \coqdocvar{a2} \coqdocvar{a3\_lt\_a2} \coqdocvar{a2\_lt\_a3}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a1\_lt\_a2} \coqdocvar{a2\_lt\_a3}; \coqdoctac{exact} (\coqdocvar{T1} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{a1\_lt\_a2} \coqdocvar{a2\_lt\_a3}).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Well-foundedness of  lexicographic extension. \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{wf\_lex} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{A} \coqdocvar{B} (\coqdocvar{eq\_bool} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) \coqdocvar{o1} \coqdocvar{o2} \coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{eq\_bool\_ok} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a1} \coqdocvar{a2}, \coqdockw{if} \coqdocvar{eq\_bool} \coqdocvar{a1} \coqdocvar{a2} \coqdockw{then} \coqdocvar{a1} = \coqdocvar{a2} \coqdockw{else} \coqdocvar{a1} \ensuremath{\not=} \coqdocvar{a2}), \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{well\_founded} \coqdocvar{o1} \ensuremath{\rightarrow} \coqdocvar{well\_founded} \coqdocvar{o2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{well\_founded} (@\coqdocvar{lex} \coqdocvar{A} \coqdocvar{B} \coqdocvar{eq\_bool} \coqdocvar{o1} \coqdocvar{o2}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{A} \coqdocvar{B} \coqdocvar{eq\_bool} \coqdocvar{o1} \coqdocvar{o2} \coqdocvar{eq\_bool\_ok} \coqdocvar{W1} \coqdocvar{W2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{a1} \coqdocvar{a2}]; \coqdocvar{revert} \coqdocvar{a2}; \coqdoctac{generalize} (\coqdocvar{W1} \coqdocvar{a1}); \coqdoctac{intros} \coqdocvar{Wa1} \coqdocvar{a2}; \coqdoctac{generalize} (\coqdocvar{W2} \coqdocvar{a2}).\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{a2}; \coqdoctac{induction} \coqdocvar{Wa1} \coqdockw{as} [\coqdocvar{a1} \coqdocvar{Wa1} \coqdocvar{wf\_lex}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a2} \coqdocvar{Wa2}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{a1} \coqdocvar{Wa1} \coqdocvar{wf\_lex}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{a2} \coqdocvar{Wa2}; \coqdockw{fix} \coqdocvar{wf\_lex2} 2.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a2} \coqdocvar{Wa2} \coqdocvar{a1} \coqdocvar{Wa1} \coqdocvar{wf\_lex}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} [\coqdocvar{b1} \coqdocvar{b2}]; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{eq\_bool\_ok} \coqdocvar{b1} \coqdocvar{a1}); \coqdoctac{case} (\coqdocvar{eq\_bool} \coqdocvar{b1} \coqdocvar{a1}); [\coqdoctac{intro} \coqdocvar{b1\_eq\_a1} \ensuremath{|} \coqdoctac{intro} \coqdocvar{b1\_diff\_a1}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b2\_lt\_a2}; \coqdoctac{rewrite} \coqdocvar{b1\_eq\_a1}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{wf\_lex2} \coqdocvar{b2} (\coqdocvar{Acc\_inv} \coqdocvar{Wa2} \coqdocvar{b2\_lt\_a2}) \coqdocvar{a1} \coqdocvar{Wa1} \coqdocvar{wf\_lex}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{b1\_lt\_a1}; \coqdoctac{exact} (\coqdocvar{wf\_lex} \coqdocvar{b1} \coqdocvar{b1\_lt\_a1} \coqdocvar{\_} (\coqdocvar{W2} \coqdocvar{b2})).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{Module Type Precedence,}


\subsection{Definition of a precedence.}

\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{status\_type} : \coqdockw{Set} :=\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Lex} : \coqdocvar{status\_type}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Mul} : \coqdocvar{status\_type}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Record} \coqdocvar{Precedence} (\coqdocvar{A} : \coqdockw{Type}) : \coqdockw{Type} := \{\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{status} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{status\_type};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec} : \coqdocvar{relation} \coqdocvar{A};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_bool} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_bool\_ok} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a1} \coqdocvar{a2}, \coqdockw{match} \coqdocvar{prec\_bool} \coqdocvar{a1} \coqdocvar{a2} \coqdockw{with} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{prec} \coqdocvar{a1} \coqdocvar{a2} \ensuremath{|} \coqdocvar{false} \ensuremath{\Rightarrow} \ensuremath{\lnot}\coqdocvar{prec} \coqdocvar{a1} \coqdocvar{a2} \coqdockw{end};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_antisym} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{prec} \coqdocvar{s} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{False};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_transitive} : \coqdocvar{transitive} \coqdocvar{A} \coqdocvar{prec};\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_eq} : \coqdocvar{relation} \coqdocvar{A};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_eq\_bool} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_eq\_transitive} : \coqdocvar{transitive} \coqdocvar{A} \coqdocvar{prec\_eq};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_eq\_refl} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{prec\_eq} \coqdocvar{s} \coqdocvar{s};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_eq\_bool\_ok}: \coqdockw{\ensuremath{\forall}} \coqdocvar{a1} \coqdocvar{a2}, \coqdockw{match} \coqdocvar{prec\_eq\_bool} \coqdocvar{a1} \coqdocvar{a2} \coqdockw{with} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{prec\_eq}  \coqdocvar{a1} \coqdocvar{a2} \ensuremath{|} \coqdocvar{false} \ensuremath{\Rightarrow} \ensuremath{\lnot}\coqdocvar{prec\_eq} \coqdocvar{a1} \coqdocvar{a2} \coqdockw{end};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_eq\_prec1}: \coqdockw{\ensuremath{\forall}} \coqdocvar{a1} \coqdocvar{a2} \coqdocvar{a3}, \coqdocvar{prec} \coqdocvar{a1} \coqdocvar{a2} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{a2} \coqdocvar{a3} \ensuremath{\rightarrow} \coqdocvar{prec} \coqdocvar{a1} \coqdocvar{a3};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_eq\_prec2}: \coqdockw{\ensuremath{\forall}} \coqdocvar{a1} \coqdocvar{a2} \coqdocvar{a3}, \coqdocvar{prec} \coqdocvar{a1} \coqdocvar{a2} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{a1} \coqdocvar{a3} \ensuremath{\rightarrow} \coqdocvar{prec} \coqdocvar{a3} \coqdocvar{a2};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_eq\_sym} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{prec\_eq} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{t} \coqdocvar{s};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_not\_prec\_eq}: \coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g}, \coqdocvar{prec} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{False};\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prec\_eq\_status}: \coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g}, \coqdocvar{prec\_eq} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{f} = \coqdocvar{status} \coqdocvar{g}\coqdoceol
\coqdocnoindent
\}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{Module Type RPO,}


\subsection{Definition of RPO from a precedence on symbols.}

\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Module} \coqdockw{Type} \coqdocvar{RPO}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdockw{Declare Module} \coqdockw{Import} \coqdocvar{T} : \coqdocvar{Term}.\coqdoceol
\coqdocindent{1.00em}
\coqdockw{Section} \coqdocvar{S}.\coqdoceol
\coqdocindent{2.00em}
\coqdockw{Variable} \coqdocvar{P} : \coqdocvar{Precedence} \coqdocvar{T.symbol}.\coqdoceol
\end{coqdoccode}
\subsection{Definition of rpo.}

\begin{coqdoccode}
\coqdocindent{2.00em}
\coqdockw{Inductive} \coqdocvar{equiv} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Eq} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Eq\_lex} : \coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{status} \coqdocvar{P} \coqdocvar{f} = \coqdocvar{Lex} \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{P} \coqdocvar{g} = \coqdocvar{Lex} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{P} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{equiv\_list\_lex} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{equiv} (\coqdocvar{Term} \coqdocvar{f}  \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l2}) \coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Eq\_mul} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l1} \coqdocvar{l2},  \coqdocvar{status} \coqdocvar{P} \coqdocvar{f} = \coqdocvar{Mul} \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{P} \coqdocvar{g} = \coqdocvar{Mul} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{P} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{equiv} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l2})\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{2.00em}
\coqdockw{with} \coqdocvar{equiv\_list\_lex} : \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Eq\_list\_nil} : \coqdocvar{equiv\_list\_lex} \coqdocvar{nil} \coqdocvar{nil}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Eq\_list\_cons} : \coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{equiv\_list\_lex} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{equiv\_list\_lex} (\coqdocvar{t1} :: \coqdocvar{l1}) (\coqdocvar{t2} :: \coqdocvar{l2}).\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{equiv\_in\_list} : \coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} (\coqdocvar{f\_stat} : \coqdocvar{status}  \coqdocvar{P} \coqdocvar{f}= \coqdocvar{Lex}) (\coqdocvar{g\_stat}: \coqdocvar{status} \coqdocvar{P} \coqdocvar{g} = \coqdocvar{Lex}) \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{length} \coqdocvar{l1} = \coqdocvar{length} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{P} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{combine} \coqdocvar{l1} \coqdocvar{l2}) \ensuremath{\rightarrow} \coqdocvar{equiv}  \coqdocvar{t1}  \coqdocvar{t2}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{equiv} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l2}).\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{equiv\_equiv}  : \coqdocvar{equivalence} \coqdocvar{term} \coqdocvar{equiv}.\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{equiv\_dec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \{\coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}\}+\{\~{}\coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}\}.\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Inductive} \coqdocvar{rpo} (\coqdocvar{bb} : \coqdocvar{nat}) : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Subterm} : \coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Top\_gt} : \coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{prec} \coqdocvar{P} \coqdocvar{g} \coqdocvar{f} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s'}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s'} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s'} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l'}) (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Top\_eq\_lex} : \coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{status} \coqdocvar{P} \coqdocvar{f} = \coqdocvar{Lex} \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{P} \coqdocvar{g} = \coqdocvar{Lex} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{P} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} (\coqdocvar{length} \coqdocvar{l} = \coqdocvar{length} \coqdocvar{l'} \ensuremath{\lor} (\coqdocvar{length} \coqdocvar{l'} \ensuremath{\le} \coqdocvar{bb} \ensuremath{\land} \coqdocvar{length} \coqdocvar{l} \ensuremath{\le} \coqdocvar{bb})) \ensuremath{\rightarrow} \coqdocvar{rpo\_lex} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{s'}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s'} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s'} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l'}) (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Top\_eq\_mul} : \coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{status} \coqdocvar{P} \coqdocvar{f} = \coqdocvar{Mul}  \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{P} \coqdocvar{g} = \coqdocvar{Mul} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{P} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l'}) (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l})\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{2.00em}
\coqdockw{with} \coqdocvar{rpo\_eq} (\coqdocvar{bb} : \coqdocvar{nat}) : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Equiv} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Lt} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{2.00em}
\coqdockw{with} \coqdocvar{rpo\_lex} (\coqdocvar{bb} : \coqdocvar{nat}) : \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{List\_gt} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{t} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo\_lex} \coqdocvar{bb} (\coqdocvar{s} :: \coqdocvar{l}) (\coqdocvar{t} :: \coqdocvar{l'})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{List\_eq} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{s'} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{s'} \ensuremath{\rightarrow} \coqdocvar{rpo\_lex} \coqdocvar{bb} \coqdocvar{l} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{rpo\_lex} \coqdocvar{bb} (\coqdocvar{s} :: \coqdocvar{l}) (\coqdocvar{s'} :: \coqdocvar{l'})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{List\_nil} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{l}, \coqdocvar{rpo\_lex} \coqdocvar{bb} \coqdocvar{nil} (\coqdocvar{s} :: \coqdocvar{l})\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{2.00em}
\coqdockw{with} \coqdocvar{rpo\_mul} ( \coqdocvar{bb} : \coqdocvar{nat}) : \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{List\_mul} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l} \coqdocvar{l'}, \coqdoceol
\coqdocindent{3.00em}
\coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l'} (\coqdocvar{ls} ++ \coqdocvar{lc}) \ensuremath{\rightarrow} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l} (\coqdocvar{a} :: \coqdocvar{lg} ++ \coqdocvar{lc}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{b}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a'} (\coqdocvar{a} :: \coqdocvar{lg}) \ensuremath{\land} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{b} \coqdocvar{a'}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l}.\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{equiv\_rpo\_equiv\_1} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\leftrightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t'}).\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{equiv\_rpo\_equiv\_2} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\leftrightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t'} \coqdocvar{s}).\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{equiv\_rpo\_equiv\_3} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\leftrightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t'}).\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{equiv\_rpo\_equiv\_4} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\leftrightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t'} \coqdocvar{s}).\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{rpo is a preorder, and its reflexive closure is an ordering.}

\begin{coqdoccode}
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{rpo\_closure} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \coqdocvar{u}, \coqdoceol
\coqdocindent{4.00em}
(\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{s}) \ensuremath{\land}\coqdoceol
\coqdocindent{4.00em}
(\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{False}) \ensuremath{\land}\coqdoceol
\coqdocindent{4.00em}
(\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{False}) \ensuremath{\land}\coqdoceol
\coqdocindent{4.00em}
(\coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{s}  \coqdocvar{t}).\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{rpo\_trans} : \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \coqdocvar{u}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{u} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{u}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{Main theorem: when the precedence is well-founded, so is the rpo.}

\begin{coqdoccode}
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{wf\_rpo} :  \coqdocvar{well\_founded} (\coqdocvar{prec} \coqdocvar{P}) \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{bb}, \coqdocvar{well\_founded} (\coqdocvar{rpo} \coqdocvar{bb}).\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{RPO is compatible with the instanciation by a substitution.}

\begin{coqdoccode}
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{equiv\_subst} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{sigma}, \coqdocvar{equiv} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{s}) (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{t}).\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{rpo\_subst} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{sigma}, \coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{s}) (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{t}).\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{rpo\_eq\_subst} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{sigma}, \coqdocvar{rpo\_eq} \coqdocvar{bb} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{s}) (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{t}).\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{RPO is compatible with adding context.}

\begin{coqdoccode}
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{equiv\_add\_context} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{is\_a\_pos} \coqdocvar{ctx} \coqdocvar{p} = \coqdocvar{true} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{equiv} (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{p}) (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{t} \coqdocvar{p}).\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{rpo\_add\_context} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{p} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{is\_a\_pos} \coqdocvar{ctx} \coqdocvar{p} = \coqdocvar{true} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{p}) (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{t} \coqdocvar{p}).\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{rpo\_eq\_add\_context} :\coqdoceol
\coqdocindent{3.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{p} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{is\_a\_pos} \coqdocvar{ctx} \coqdocvar{p} = \coqdocvar{true} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo\_eq} \coqdocvar{bb} (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{p}) (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{t} \coqdocvar{p}).\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\coqdockw{Parameter} \coqdocvar{rpo\_dec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{t1} \coqdocvar{t2}, \{\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t1} \coqdocvar{t2}\}+\{\~{}\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t1} \coqdocvar{t2}\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqdocvar{S}.\coqdoceol
\coqdocnoindent
\coqdockw{End} \coqdocvar{RPO}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Module} \coqdocvar{Make} (\coqdocvar{T1}: \coqdocvar{Term}) \coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocnoindent
<: \coqdocvar{RPO} \coqdockw{with} \coqdockw{Module} \coqdocvar{T} := \coqdocvar{T1}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Module} \coqdocvar{T} := \coqdocvar{T1}.\coqdoceol
\coqdocnoindent
\coqdockw{Import} \coqdocvar{T1}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\end{coqdoccode}
\subsection{Definition of size-based well-founded orderings for induction.}

\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{o\_size} \coqdocvar{s} \coqdocvar{t} := \coqdocvar{size} \coqdocvar{s} < \coqdocvar{size} \coqdocvar{t}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{wf\_size} :  \coqdocvar{well\_founded} \coqdocvar{o\_size}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{well\_founded\_ltof} \coqdocvar{\_} \coqdocvar{size}); \coqdoctac{unfold} \coqdocvar{ltof}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{size2} \coqdocvar{s} := \coqdockw{match} \coqdocvar{s} \coqdockw{with} (\coqdocvar{s1},\coqdocvar{s2}) \ensuremath{\Rightarrow} (\coqdocvar{size} \coqdocvar{s1}, \coqdocvar{size} \coqdocvar{s2}) \coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{o\_size2} \coqdocvar{s} \coqdocvar{t} := \coqdocvar{lex} \coqdocvar{beq\_nat} \coqdocvar{lt} \coqdocvar{lt} (\coqdocvar{size2} \coqdocvar{s}) (\coqdocvar{size2} \coqdocvar{t}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{wf\_size2} : \coqdocvar{well\_founded} \coqdocvar{o\_size2}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{wf\_inverse\_image} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{lex}  \coqdocvar{beq\_nat} \coqdocvar{lt} \coqdocvar{lt}) \coqdocvar{size2} \coqdocvar{\_});\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{wf\_lex}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{beq\_nat\_ok}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_wf}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_wf}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size2\_lex1} : \coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{o\_size2} (\coqdocvar{s},\coqdocvar{t1}) (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l},\coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{s\_in\_l}; \coqdoctac{unfold} \coqdocvar{o\_size2}, \coqdocvar{size2}, \coqdocvar{lex}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}))); \coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}))); [\coqdoctac{intro} \coqdocvar{s\_eq\_t} \ensuremath{|} \coqdoctac{intro} \coqdocvar{s\_lt\_t}].\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) < \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{size\_direct\_subterm} \coqdocvar{s} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) \coqdocvar{s\_in\_l}); \coqdoctac{rewrite} \coqdocvar{s\_eq\_t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{size\_direct\_subterm} \coqdocvar{s} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) \coqdocvar{s\_in\_l}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size2\_lex1\_bis} : \coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{a} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{o\_size2} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{t1}) (\coqdocvar{Term} \coqdocvar{f} (\coqdocvar{a}::\coqdocvar{l}), \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{t2}; \coqdoctac{unfold} \coqdocvar{o\_size2}, \coqdocvar{size2}, \coqdocvar{lex};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} (\coqdocvar{a} :: \coqdocvar{l})))); \coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} (\coqdocvar{a} :: \coqdocvar{l})))); [\coqdoctac{intro} \coqdocvar{s\_eq\_t} \ensuremath{|} \coqdoctac{intro} \coqdocvar{s\_lt\_t}].\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{size\_unfold} \coqdoctac{in} \coqdocvar{s\_eq\_t}; \coqdoctac{injection} \coqdocvar{s\_eq\_t}; \coqdoctac{clear} \coqdocvar{s\_eq\_t}; \coqdoctac{intro} \coqdocvar{s\_eq\_t};\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l} < \coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l}); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{plus\_le\_compat\_r} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l}) (\coqdocvar{size\_ge\_one} \coqdocvar{a}));\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{s\_eq\_t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{size\_unfold};\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{lt\_n\_S}; \coqdoctac{apply} \coqdocvar{lt\_le\_trans} \coqdockw{with} (1 + \coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l});\coqdoceol
\coqdocnoindent
\coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}; \coqdoctac{apply} \coqdocvar{size\_ge\_one}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size2\_lex2} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s}, \coqdocvar{In} \coqdocvar{t} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{o\_size2} (\coqdocvar{s},\coqdocvar{t}) (\coqdocvar{s}, \coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{t\_in\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size2}, \coqdocvar{size2}, \coqdocvar{lex};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); \coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); [\coqdoctac{intros} \coqdocvar{\_} \ensuremath{|} \coqdoctac{intro} \coqdocvar{s\_diff\_s}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{s\_diff\_s}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size2\_lex2\_bis} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s}, \coqdocvar{o\_size2} (\coqdocvar{s},\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) (\coqdocvar{s}, \coqdocvar{Term} \coqdocvar{f} (\coqdocvar{t} :: \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s};\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size2}, \coqdocvar{size2}, \coqdocvar{lex};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); \coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); [\coqdoctac{intros} \coqdocvar{\_} \ensuremath{|} \coqdoctac{intro} \coqdocvar{s\_diff\_s}].\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{size\_unfold}; \coqdoctac{apply} \coqdocvar{plus\_lt\_compat\_l}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} (\coqdocvar{plus\_le\_compat\_r} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l}) (\coqdocvar{size\_ge\_one} \coqdocvar{a})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{s\_diff\_s}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{o\_size2\_trans} : \coqdocvar{transitive} \coqdocvar{\_} \coqdocvar{o\_size2}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{x1} \coqdocvar{x2}] [\coqdocvar{y1} \coqdocvar{y2}] [\coqdocvar{z1} \coqdocvar{z2}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{lex\_trans} \coqdocvar{beq\_nat} \coqdocvar{beq\_nat\_ok}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{m} \coqdocvar{n\_lt\_m} \coqdocvar{m\_lt\_n};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{lt\_asym} \coqdocvar{n} \coqdocvar{m} \coqdocvar{n\_lt\_m} \coqdocvar{m\_lt\_n}); \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n1} \coqdocvar{n2} \coqdocvar{n3}; \coqdoctac{apply} \coqdocvar{lt\_trans}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n1} \coqdocvar{n2} \coqdocvar{n3}; \coqdoctac{apply} \coqdocvar{lt\_trans}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{size3} \coqdocvar{s} := \coqdockw{match} \coqdocvar{s} \coqdockw{with} (\coqdocvar{s1},\coqdocvar{s2}) \ensuremath{\Rightarrow} (\coqdocvar{size} \coqdocvar{s1}, \coqdocvar{size2} \coqdocvar{s2}) \coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{o\_size3} \coqdocvar{s} \coqdocvar{t} := \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{lex} \coqdocvar{beq\_nat} \coqdocvar{lt} (\coqdocvar{lex} \coqdocvar{beq\_nat} \coqdocvar{lt} \coqdocvar{lt}) (\coqdocvar{size3} \coqdocvar{s}) (\coqdocvar{size3} \coqdocvar{t}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{wf\_size3} : \coqdocvar{well\_founded} \coqdocvar{o\_size3}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{wf\_inverse\_image} \coqdocvar{\_} \coqdocvar{\_} \coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{lex}  \coqdocvar{beq\_nat} \coqdocvar{lt} (\coqdocvar{lex}  \coqdocvar{beq\_nat} \coqdocvar{lt} \coqdocvar{lt})) \coqdocvar{size3} \coqdocvar{\_}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{wf\_lex}; \coqdoceol
\coqdocnoindent
[ \coqdoctac{exact} \coqdocvar{beq\_nat\_ok} \coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdoctac{apply} \coqdocvar{lt\_wf} \coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdoctac{apply} \coqdocvar{wf\_lex}; [ \coqdoctac{exact} \coqdocvar{beq\_nat\_ok} \ensuremath{|} \coqdoctac{apply} \coqdocvar{lt\_wf} \ensuremath{|} \coqdoctac{apply} \coqdocvar{lt\_wf} ]].\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size3\_lex1} : \coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{u1} \coqdocvar{t2} \coqdocvar{u2}, \coqdocvar{In} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{o\_size3} (\coqdocvar{s},(\coqdocvar{t1},\coqdocvar{u1})) (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l},(\coqdocvar{t2},\coqdocvar{u2})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{u1} \coqdocvar{t2} \coqdocvar{u2} \coqdocvar{s\_in\_l}; \coqdoctac{unfold} \coqdocvar{o\_size3}, \coqdocvar{size3}, \coqdocvar{size2}, \coqdocvar{lex}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}))); \coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}))); [\coqdoctac{intro} \coqdocvar{s\_eq\_t} \ensuremath{|} \coqdoctac{intro} \coqdocvar{s\_lt\_t}].\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) < \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{size\_direct\_subterm} \coqdocvar{s} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) \coqdocvar{s\_in\_l}); \coqdoctac{rewrite} \coqdocvar{s\_eq\_t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{size\_direct\_subterm} \coqdocvar{s} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) \coqdocvar{s\_in\_l}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size3\_lex1\_bis} : \coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{a} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{u1} \coqdocvar{t2} \coqdocvar{u2}, \coqdocvar{o\_size3} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l},(\coqdocvar{t1},\coqdocvar{u1})) (\coqdocvar{Term} \coqdocvar{f} (\coqdocvar{a}::\coqdocvar{l}),(\coqdocvar{t2},\coqdocvar{u2})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{u1} \coqdocvar{t2} \coqdocvar{u2}; \coqdoctac{unfold} \coqdocvar{o\_size3}, \coqdocvar{size3}, \coqdocvar{lex};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} (\coqdocvar{a} :: \coqdocvar{l})))); \coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} (\coqdocvar{a} :: \coqdocvar{l})))); [\coqdoctac{intro} \coqdocvar{s\_eq\_t} \ensuremath{|} \coqdoctac{intro} \coqdocvar{s\_lt\_t}].\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{size\_unfold} \coqdoctac{in} \coqdocvar{s\_eq\_t}; \coqdoctac{injection} \coqdocvar{s\_eq\_t}; \coqdoctac{clear} \coqdocvar{s\_eq\_t}; \coqdoctac{intro} \coqdocvar{s\_eq\_t};\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l} < \coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l}); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{plus\_le\_compat\_r} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l}) (\coqdocvar{size\_ge\_one} \coqdocvar{a}));\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{s\_eq\_t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{size\_unfold};\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{lt\_n\_S}; \coqdoctac{apply} \coqdocvar{lt\_le\_trans} \coqdockw{with} (1 + \coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l});\coqdoceol
\coqdocnoindent
\coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}; \coqdoctac{apply} \coqdocvar{size\_ge\_one}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size3\_lex2} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{u1} \coqdocvar{u2}, \coqdocvar{In} \coqdocvar{t} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{o\_size3} (\coqdocvar{s},(\coqdocvar{t},\coqdocvar{u1})) (\coqdocvar{s},(\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{u2})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{u1} \coqdocvar{u2} \coqdocvar{t\_in\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size3}, \coqdocvar{size3}, \coqdocvar{size2}, \coqdocvar{lex}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); \coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); [\coqdoctac{intros} \coqdocvar{\_} \ensuremath{|} \coqdoctac{intro} \coqdocvar{s\_diff\_s}].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} \coqdocvar{t}) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}))); \coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} \coqdocvar{t}) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}))); [\coqdoctac{intro} \coqdocvar{t\_eq\_fl} \ensuremath{|} \coqdoctac{intro} \coqdocvar{t\_lt\_fl}].\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) < \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{size\_direct\_subterm} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) \coqdocvar{t\_in\_l}); \coqdoctac{rewrite} \coqdocvar{t\_eq\_fl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{size\_direct\_subterm} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) \coqdocvar{t\_in\_l}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{s\_diff\_s}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size3\_lex3} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{u} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{In} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{o\_size3} (\coqdocvar{s},(\coqdocvar{t},\coqdocvar{u})) (\coqdocvar{s},(\coqdocvar{t},\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{t} \coqdocvar{u\_in\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size3}, \coqdocvar{size3}, \coqdocvar{size2}, \coqdocvar{lex};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); \coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); [\coqdoctac{intros} \coqdocvar{\_} \ensuremath{|} \coqdoctac{intro} \coqdocvar{s\_diff\_s}].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} \coqdocvar{t}) (\coqdocvar{size} \coqdocvar{t})); \coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} \coqdocvar{t}) (\coqdocvar{size} \coqdocvar{t})); [\coqdoctac{intros} \coqdocvar{\_} \ensuremath{|} \coqdoctac{intro} \coqdocvar{t\_diff\_t}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{size\_direct\_subterm} \coqdocvar{u} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) \coqdocvar{u\_in\_l}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{t\_diff\_t}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{s\_diff\_s}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{o\_size3\_trans} : \coqdocvar{transitive} \coqdocvar{\_} \coqdocvar{o\_size3}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{x1} \coqdocvar{x2}] [\coqdocvar{y1} \coqdocvar{y2}] [\coqdocvar{z1} \coqdocvar{z2}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{lex\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{beq\_nat} \coqdocvar{lt} (\coqdocvar{lex} \coqdocvar{beq\_nat} \coqdocvar{lt} \coqdocvar{lt}) \coqdocvar{beq\_nat\_ok}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{m} \coqdocvar{n\_lt\_m} \coqdocvar{m\_lt\_n};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{lt\_asym} \coqdocvar{n} \coqdocvar{m} \coqdocvar{n\_lt\_m} \coqdocvar{m\_lt\_n}); \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n1} \coqdocvar{n2} \coqdocvar{n3}; \coqdoctac{apply} \coqdocvar{lt\_trans}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lex\_trans}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{beq\_nat\_ok}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{m} \coqdocvar{n\_lt\_m} \coqdocvar{m\_lt\_n};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{lt\_asym} \coqdocvar{n} \coqdocvar{m} \coqdocvar{n\_lt\_m} \coqdocvar{m\_lt\_n}); \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n1} \coqdocvar{n2} \coqdocvar{n3}; \coqdoctac{apply} \coqdocvar{lt\_trans}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n1} \coqdocvar{n2} \coqdocvar{n3}; \coqdoctac{apply} \coqdocvar{lt\_trans}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{Definition of rpo.}

\subsubsection{Equivalence modulo rpo}

\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Section} \coqdocvar{S}.\coqdoceol
\coqdocnoindent
\coqdockw{Variable} \coqdocvar{Prec}: \coqdocvar{Precedence} \coqdocvar{T1.symbol}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{equiv} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Eq} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Eq\_lex} : \coqdoceol
\coqdocindent{2.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f} = \coqdocvar{Lex} \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g} = \coqdocvar{Lex} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{equiv\_list\_lex} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.50em}
\coqdocvar{equiv} (\coqdocvar{Term} \coqdocvar{f}  \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l2}) \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Eq\_mul} :\coqdoceol
\coqdocindent{2.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l1} \coqdocvar{l2},  \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f} = \coqdocvar{Mul} \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g} = \coqdocvar{Mul} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{equiv} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l2})\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocnoindent
\coqdockw{with} \coqdocvar{equiv\_list\_lex} : \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{Eq\_list\_nil} : \coqdocvar{equiv\_list\_lex} \coqdocvar{nil} \coqdocvar{nil}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{Eq\_list\_cons} : \coqdoceol
\coqdocindent{3.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{equiv\_list\_lex} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{equiv\_list\_lex} (\coqdocvar{t1} :: \coqdocvar{l1}) (\coqdocvar{t2} :: \coqdocvar{l2}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_same\_top} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{equiv} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l'}) \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H}; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_refl}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_list\_lex\_same\_length} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{equiv\_list\_lex} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{length} \coqdocvar{l1} = \coqdocvar{length} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l1}; \coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_eq\_l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{\_} \coqdocvar{l1'\_eq\_l2'}]; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} (\coqdocvar{IHl1} \coqdocvar{l2'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_same\_length} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f1} \coqdocvar{f2} \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{equiv} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \ensuremath{\rightarrow} \coqdocvar{length} \coqdocvar{l1} = \coqdocvar{length} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f1} \coqdocvar{f2} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{t1\_eq\_t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t1\_eq\_t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_list\_lex\_same\_length}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{permut\_length} \coqdocvar{\_} \coqdocvar{equiv}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_same\_size} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t} = \coqdocvar{size} \coqdocvar{t'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t}; \coqdoctac{pattern} \coqdocvar{t}; \coqdoctac{apply} \coqdocvar{term\_rec2}; \coqdoctac{clear} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{n}; \coqdoctac{induction} \coqdocvar{n} \coqdockw{as} [ \ensuremath{|} \coqdocvar{n}]; \coqdoctac{intros} \coqdocvar{t1} \coqdocvar{St1} \coqdocvar{t2} \coqdocvar{t1\_eq\_t2}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (1 \ensuremath{\le} 0); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}; \coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} \coqdocvar{t1}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_ge\_one}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t1\_eq\_t2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{prec\_eq\_f\_g} \coqdocvar{l1\_eq\_l2} \ensuremath{|} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{prec\_eq\_f\_g} \coqdocvar{P}];  \coqdoceol
\coqdocnoindent
\coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{size\_unfold}; \coqdoctac{apply} (\coqdoctac{f\_equal} (\coqdockw{fun} \coqdocvar{n} \ensuremath{\Rightarrow} 1 + \coqdocvar{n})).\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l2'} \coqdocvar{l1\_eq\_l2}; \coqdoctac{clear} \coqdocvar{l2'} \coqdocvar{l1\_eq\_l2} \coqdocvar{t1\_eq\_t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l1'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_eq\_l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{s1\_eq\_s2} \coqdocvar{l1'\_eq\_l2'}]; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{St1'} : \coqdocvar{size} \coqdocvar{t1} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} (\coqdocvar{t1} :: \coqdocvar{l1}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{IHn} \coqdocvar{t1} \coqdocvar{St1'} \coqdocvar{s2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Sl1} : \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l1}) \ensuremath{\le} \coqdocvar{S} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} (\coqdocvar{t1} :: \coqdocvar{l1}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{size\_unfold}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{le\_n\_S}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{plus\_le\_compat\_r} 0 (\coqdocvar{size} \coqdocvar{t1}) (\coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l1})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_le\_weak}; \coqdoctac{apply} (\coqdocvar{size\_ge\_one} \coqdocvar{t1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{IHl1} \coqdocvar{Sl1} \coqdocvar{l2'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{size\_unfold}; \coqdoctac{apply} (\coqdoctac{f\_equal} (\coqdockw{fun} \coqdocvar{n} \ensuremath{\Rightarrow} 1 + \coqdocvar{n})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{permut\_size} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a} \coqdocvar{a'} \coqdocvar{a\_in\_l1} \coqdocvar{\_} \coqdocvar{a\_eq\_a'}; \coqdoctac{apply} \coqdocvar{IHn}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l1'})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_in\_list} : \coqdoceol
\coqdocindent{2.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} (\coqdocvar{f\_stat} : \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f} = \coqdocvar{Lex}) (\coqdocvar{g\_stat}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g} = \coqdocvar{Lex}) \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{length} \coqdocvar{l1} = \coqdocvar{length} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{combine} \coqdocvar{l1} \coqdocvar{l2}) \ensuremath{\rightarrow} \coqdocvar{equiv}  \coqdocvar{t1}  \coqdocvar{t2}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{3.00em}
\coqdocvar{equiv} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{g} \coqdocvar{f\_stat} \coqdocvar{g\_stat} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{L} \coqdocvar{prec\_eq\_f\_g} \coqdocvar{E}. \coqdoctac{apply} (\coqdocvar{Eq\_lex} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{f\_stat} \coqdocvar{g\_stat} \coqdocvar{prec\_eq\_f\_g}).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{f} \coqdocvar{f\_stat} \coqdocvar{prec\_eq\_f\_g}; \coqdocvar{revert} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{L} \coqdocvar{E}; \coqdockw{fix} 1; \coqdoctac{intro} \coqdocvar{l1}; \coqdoctac{case} \coqdocvar{l1}; \coqdoctac{clear} \coqdocvar{l1}. \coqdoctac{intros} \coqdocvar{l2}; \coqdoctac{case} \coqdocvar{l2}; \coqdoctac{clear} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{Eq\_list\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a2} \coqdocvar{l2} \coqdocvar{L} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a1} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{case} \coqdocvar{l2}; \coqdoctac{clear} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{L}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a2} \coqdocvar{l2} \coqdocvar{L} \coqdocvar{E}; \coqdoctac{apply} \coqdocvar{Eq\_list\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{E}; \coqdoctac{left}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_in\_list} \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{injection} \coqdocvar{L}; \coqdoctac{intros}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{E}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_equiv}  : \coqdocvar{equivalence} \coqdocvar{term} \coqdocvar{equiv}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{t}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1}; \coqdoctac{pattern} \coqdocvar{t1}; \coqdoctac{apply} \coqdocvar{term\_rec3}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v} \coqdocvar{t2} \coqdocvar{t3} \coqdocvar{t1\_eq\_t2} \coqdocvar{t2\_eq\_t3}; \coqdoctac{inversion} \coqdocvar{t1\_eq\_t2}; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{l1} \coqdocvar{E\_l1} \coqdocvar{t2} \coqdocvar{t3} \coqdocvar{t1\_eq\_t2} \coqdocvar{t2\_eq\_t3}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t1\_eq\_t2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{l1'} \coqdocvar{l2} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{eq\_f\_g} \coqdocvar{l1\_eq\_l2} \coqdocvar{H2} \coqdocvar{H'} \ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{l1'} \coqdocvar{l2} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{eq\_f\_g} \coqdocvar{P}]; \coqdoctac{subst}; \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t2\_eq\_t3} \coqdockw{as} [ \ensuremath{|} \coqdocvar{f'} \coqdocvar{g'{}'} \coqdocvar{l2'} \coqdocvar{l3} \coqdocvar{Sf'} \coqdocvar{Sg'} \coqdocvar{eq\_f\_g'} \coqdocvar{l2\_eq\_l3} \coqdocvar{H2} \coqdocvar{H'{}'} \ensuremath{|} \coqdocvar{f'} \coqdocvar{g'{}'} \coqdocvar{l2'} \coqdocvar{l3} \coqdocvar{Sf'} \coqdocvar{Sg'} \coqdocvar{eq\_f\_g'} \coqdocvar{P'} ]; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_lex}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_transitive} \coqdockw{with} \coqdocvar{g'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l2} \coqdocvar{l3} \coqdocvar{l1\_eq\_l2} \coqdocvar{l2\_eq\_l3};\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{t1\_eq\_t2} \coqdocvar{t2\_eq\_t3} \coqdocvar{l2} \coqdocvar{l3} \coqdocvar{l1\_eq\_l2} \coqdocvar{l2\_eq\_l3};\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|}\coqdocvar{s1} \coqdocvar{l1}]; \coqdoctac{intros} \coqdocvar{l2} \coqdocvar{l3} \coqdocvar{l1\_eq\_l2} \coqdocvar{l2\_eq\_l3}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_eq\_l2}; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_eq\_l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s1'} \coqdocvar{s2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{s1\_eq\_s2} \coqdocvar{l1'\_eq\_l2'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l2\_eq\_l3} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s2'} \coqdocvar{s3} \coqdocvar{l2'{}'} \coqdocvar{l3'} \coqdocvar{s2\_eq\_s3} \coqdocvar{l2'{}'\_eq\_l3'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{E\_l1} \coqdockw{with} \coqdocvar{s2}; \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl1} \coqdockw{with} \coqdocvar{l2'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t\_in\_l1}; \coqdoctac{apply} \coqdocvar{E\_l1}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Sg} \coqdoctac{in} \coqdocvar{Sf'}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Sg} \coqdoctac{in} \coqdocvar{Sf'}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_mul}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_transitive} \coqdockw{with} \coqdocvar{g'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_trans} \coqdockw{with} \coqdocvar{l2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a} \coqdocvar{b} \coqdocvar{c} \coqdocvar{a\_in\_l1} \coqdocvar{\_} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{E\_l1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1}; \coqdoctac{pattern} \coqdocvar{t1}; \coqdoctac{apply} \coqdocvar{term\_rec3}; \coqdoctac{clear} \coqdocvar{t1}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v} \coqdocvar{t2} \coqdocvar{t1\_eq\_t2}; \coqdoctac{inversion} \coqdocvar{t1\_eq\_t2}; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{l1} \coqdocvar{IHl} \coqdocvar{t2} \coqdocvar{t1\_eq\_t2}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t1\_eq\_t2} \coqdockw{as} \coqdoceol
\coqdocindent{1.00em}
[ \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{l1'} \coqdocvar{l2} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{preceq\_f\_g} \coqdocvar{l1\_eq\_l2} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{l1'} \coqdocvar{l2} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{preceq\_f\_g} \coqdocvar{P}]; \coqdoctac{clear} \coqdocvar{t1\_eq\_t2}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_lex}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_sym}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2}; \coqdoctac{clear} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2}; \coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_eq\_l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{s1\_eq\_s2} \coqdocvar{l1'\_eq\_l2'}]; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t\_in\_l1}; \coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_mul}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_sym}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a} \coqdocvar{b} \coqdocvar{a\_in\_l1} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdockw{Add} \coqdocvar{Relation} \coqdocvar{term} \coqdocvar{equiv} \coqdoceol
\coqdocindent{1.00em}
\coqdoctac{reflexivity} \coqdocvar{proved} \coqdoctac{by} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{symmetry} \coqdocvar{proved} \coqdoctac{by} (\coqdocvar{Relation\_Definitions.equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{transitivity} \coqdocvar{proved} \coqdoctac{by} (\coqdocvar{Relation\_Definitions.equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{as} \coqdocvar{EQUIV\_RPO}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{equiv\_bool\_F} := \coqdoceol
\coqdocnoindent
(\coqdockw{fun} (\coqdocvar{equiv\_bool} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{bool}) (\coqdocvar{t1} \coqdocvar{t2} : \coqdocvar{term}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{t1}, \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Var} \coqdocvar{v1}, \coqdocvar{Var} \coqdocvar{v2} \ensuremath{\Rightarrow} \coqdocvar{X.eq\_bool} \coqdocvar{v1} \coqdocvar{v2}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Var} \coqdocvar{\_}, \coqdocvar{Term} \coqdocvar{\_} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Term} \coqdocvar{\_} \coqdocvar{\_}, \coqdocvar{Var} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}, \coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{if} \coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{then}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{match} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Lex} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{4.50em}
\coqdockw{let} \coqdocvar{equiv\_lex\_bool} :=\coqdoceol
\coqdocindent{7.00em}
(\coqdockw{fix} \coqdocvar{equiv\_lex\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) \{\coqdockw{struct} \coqdocvar{kk1}\} :  \coqdocvar{bool} :=  \coqdoceol
\coqdocindent{7.50em}
(\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with} [] \ensuremath{\Rightarrow} \coqdocvar{true} \ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_}\ensuremath{\Rightarrow} \coqdocvar{false} \coqdockw{end}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{10.50em}
\coqdockw{match} \coqdocvar{kk2} \coqdockw{with} \coqdoceol
\coqdocindent{12.50em}
[] \ensuremath{\Rightarrow} \coqdocvar{false} \coqdoceol
\coqdocindent{11.50em}
\ensuremath{|} \coqdocvar{t2} :: \coqdocvar{k2}\ensuremath{\Rightarrow} (\coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{t2}) \&\& (\coqdocvar{equiv\_lex\_bool} \coqdocvar{k1} \coqdocvar{k2})\coqdoceol
\coqdocindent{11.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{end})) \coqdoctac{in}\coqdoceol
\coqdocindent{7.00em}
(\coqdocvar{equiv\_lex\_bool} \coqdocvar{l1} \coqdocvar{l2})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Mul} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{3.50em}
\coqdockw{let} \coqdocvar{equiv\_mult\_bool} :=\coqdoceol
\coqdocindent{7.00em}
(\coqdockw{fix} \coqdocvar{equiv\_mult\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) \{\coqdockw{struct} \coqdocvar{kk1}\} :  \coqdocvar{bool} :=  \coqdoceol
\coqdocindent{7.50em}
(\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with} [] \ensuremath{\Rightarrow} \coqdocvar{true} \ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_}\ensuremath{\Rightarrow} \coqdocvar{false} \coqdockw{end}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{10.50em}
\coqdockw{match} \coqdocvar{remove} \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{kk2} \coqdockw{with} \coqdoceol
\coqdocindent{13.50em}
\coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{false} \coqdoceol
\coqdocindent{12.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{k2} \ensuremath{\Rightarrow} \coqdocvar{equiv\_mult\_bool} \coqdocvar{k1} \coqdocvar{k2} \coqdockw{end}\coqdoceol
\coqdocindent{12.50em}
\coqdockw{end})) \coqdoctac{in}\coqdoceol
\coqdocindent{7.00em}
(\coqdocvar{equiv\_mult\_bool} \coqdocvar{l1} \coqdocvar{l2})\coqdoceol
\coqdocindent{2.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{else} \coqdocvar{false}\coqdoceol
\coqdocnoindent
\coqdockw{end}) : (\coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{bool}) \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{bool}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{equiv\_bool\_terminate} :\coqdoceol
\coqdocnoindent
\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2} : \coqdocvar{term},\coqdoceol
\coqdocindent{3.50em}
\{\coqdocvar{v} : \coqdocvar{bool} \ensuremath{|}  \coqdockw{\ensuremath{\forall}} \coqdocvar{k} : \coqdocvar{nat}, (\coqdocvar{size} \coqdocvar{t1}) \ensuremath{\le} \coqdocvar{k} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{def} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{bool},\coqdoceol
\coqdocindent{4.50em}
\coqdocvar{iter} (\coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{bool}) \coqdocvar{k} \coqdocvar{equiv\_bool\_F} \coqdocvar{def} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{v}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{t1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Acc\_t1} := \coqdocvar{well\_founded\_ltof} \coqdocvar{term} \coqdocvar{size} \coqdocvar{t1}).\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{Acc\_t1} \coqdockw{as} [\coqdocvar{t1} \coqdocvar{Acc\_t1} \coqdocvar{IHAcc}].\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{Acc\_t1} \coqdocvar{IHAcc}; \coqdoctac{case} \coqdocvar{t1}; \coqdoctac{clear} \coqdocvar{t1}; [\coqdoctac{intro} \coqdocvar{v1} \ensuremath{|} \coqdoctac{intros} \coqdocvar{f1} \coqdocvar{l1}]; \coqdoceol
\coqdocnoindent
(\coqdoctac{intros} \coqdocvar{Acc\_t1} \coqdocvar{IHAcc} \coqdocvar{t2}; \coqdoctac{case} \coqdocvar{t2}; \coqdoctac{clear} \coqdocvar{t2}; [\coqdoctac{intro} \coqdocvar{v2} \ensuremath{|} \coqdoctac{intros} \coqdocvar{f2} \coqdocvar{l2}]).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{X.eq\_bool} \coqdocvar{v1} \coqdocvar{v2}); \coqdoctac{intros} [ \ensuremath{|} \coqdocvar{p}] \coqdocvar{p\_lt\_k} \coqdocvar{def}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_ind}; \coqdoctac{exact} (\coqdocvar{gt\_irrefl} 0 \coqdocvar{p\_lt\_k}).\coqdoceol
\coqdocnoindent
\coqdoctac{exact} (\coqdocvar{refl\_equal} ).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{false}; \coqdoctac{intros} [ \ensuremath{|} \coqdocvar{p}] \coqdocvar{p\_lt\_k} \coqdocvar{def}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_ind}; \coqdoctac{exact} (\coqdocvar{gt\_irrefl} 0 \coqdocvar{p\_lt\_k}).\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{false}; \coqdoctac{intros} [ \ensuremath{|} \coqdocvar{p}] \coqdocvar{p\_lt\_k} \coqdocvar{def}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_ind}; \coqdoctac{exact} (\coqdocvar{le\_Sn\_O} \coqdocvar{\_} \coqdocvar{p\_lt\_k}).\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{size\_unfold}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\{\coqdocvar{v} : \coqdocvar{bool} \ensuremath{|}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{k} : \coqdocvar{nat},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l1} \ensuremath{\le} \coqdocvar{k} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{def} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{bool},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{iter} (\coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{bool}) (\coqdocvar{S} \coqdocvar{k}) \coqdocvar{equiv\_bool\_F} \coqdocvar{def} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) = \coqdocvar{v}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{iter}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IH} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} : \coqdocvar{term}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} : \coqdocvar{term},\coqdoceol
\coqdocindent{2.50em}
\{\coqdocvar{v} : \coqdocvar{bool} \ensuremath{|}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{k} : \coqdocvar{nat},\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{size} \coqdocvar{t1} \ensuremath{\le} \coqdocvar{k} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{def} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{bool},\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{iter} (\coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{bool}) \coqdocvar{k} \coqdocvar{equiv\_bool\_F} \coqdocvar{def} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{v}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t1\_in\_l1}; \coqdoctac{exact} (\coqdocvar{IHAcc} \coqdocvar{t1} (\coqdocvar{size\_direct\_subterm} \coqdocvar{t1} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t1\_in\_l1})).\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1}).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{IHAcc} \coqdocvar{Acc\_t1} \coqdocvar{f2}; \coqdocvar{revert} \coqdocvar{l1} \coqdocvar{IH} \coqdocvar{l2}; \coqdockw{fix} \coqdocvar{equiv\_lex\_bool} 1.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l1}; \coqdoctac{case} \coqdocvar{l1}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_} \coqdocvar{l2}; \coqdoctac{case} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{true}; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{p\_lt\_k} \coqdocvar{def}; \coqdoctac{exact} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{false}; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{p\_lt\_k} \coqdocvar{def}; \coqdoctac{exact} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a1} \coqdocvar{k1} \coqdocvar{IHl1} \coqdocvar{l2}; \coqdoctac{case} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{false}; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{p\_lt\_k} \coqdocvar{def}; \coqdoctac{exact} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a2} \coqdocvar{k2}; \coqdoctac{case} (\coqdocvar{equiv\_lex\_bool} \coqdocvar{k1} (\coqdocvar{tail\_set} \coqdocvar{\_} \coqdocvar{IHl1}) \coqdocvar{k2}); \coqdoctac{intros} \coqdocvar{bl} \coqdocvar{IH'}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{IHl1} \coqdocvar{a1} (\coqdocvar{or\_introl} \coqdocvar{\_} \coqdocvar{refl\_equal}) \coqdocvar{a2}); \coqdoctac{intros} \coqdocvar{ba} \coqdocvar{IH'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{ba} \&\& \coqdocvar{bl}); \coqdoctac{intros} \coqdocvar{k} \coqdocvar{p\_le\_k} \coqdocvar{def}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{pa\_lt\_k} : \coqdocvar{size} \coqdocvar{a1} \ensuremath{\le} \coqdocvar{k}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{list\_size} \coqdocvar{size} (\coqdocvar{a1} :: \coqdocvar{k1})); [\coqdoctac{apply} \coqdocvar{le\_plus\_l} \ensuremath{|} \coqdoctac{exact} \coqdocvar{p\_le\_k}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{IH'{}'} \coqdocvar{k} \coqdocvar{pa\_lt\_k}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{pl\_le\_k} : \coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{k1} \ensuremath{\le} \coqdocvar{k}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{list\_size} \coqdocvar{size} (\coqdocvar{a1} :: \coqdocvar{k1})); [\coqdoctac{apply} \coqdocvar{le\_plus\_r} \ensuremath{|} \coqdoctac{exact} \coqdocvar{p\_le\_k}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{IH'} \coqdocvar{k} \coqdocvar{pl\_le\_k} \coqdocvar{def}).\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{IHAcc} \coqdocvar{Acc\_t1} \coqdocvar{f2}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{l1} \coqdocvar{IH} \coqdocvar{l2}; \coqdockw{fix} \coqdocvar{IHl1} 1.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{l1}; \coqdoctac{case} \coqdocvar{l1}; \coqdoctac{clear} \coqdocvar{l1}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_} \coqdocvar{l2}; \coqdoctac{case} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{true}; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{p\_lt\_k} \coqdocvar{def}; \coqdoctac{exact} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{false}; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{p\_lt\_k} \coqdocvar{def}; \coqdoctac{exact} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a1} \coqdocvar{l1} \coqdocvar{IH} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Hrem} : \{\coqdocvar{ok} : \coqdocvar{option} (\coqdocvar{list} \coqdocvar{term}) \ensuremath{|}\coqdoceol
\coqdocindent{14.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{k} : \coqdocvar{nat}, \coqdocvar{list\_size} \coqdocvar{size} (\coqdocvar{a1} :: \coqdocvar{l1}) \ensuremath{\le} \coqdocvar{k} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{14.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{def} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{bool},\coqdoceol
\coqdocindent{14.50em}
\coqdocvar{remove} (\coqdocvar{iter} \coqdocvar{\_} \coqdocvar{k} \coqdocvar{equiv\_bool\_F} \coqdocvar{def}) \coqdocvar{a1} \coqdocvar{l2} = \coqdocvar{ok}\}).\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{l2}; \coqdockw{fix} \coqdocvar{IHl2} 1.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{l2}; \coqdoctac{case} \coqdocvar{l2}; \coqdoctac{clear} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (@\coqdocvar{None} (\coqdocvar{list} \coqdocvar{term})); \coqdoctac{intro} \coqdocvar{k}; \coqdoctac{case} \coqdocvar{k}; \coqdoctac{clear} \coqdocvar{k}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{L}; \coqdoctac{apply} \coqdocvar{False\_rec}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{le\_Sn\_O} \coqdocvar{\_} (\coqdocvar{le\_trans} 1 \coqdocvar{\_} 0 (\coqdocvar{size\_ge\_one} \coqdocvar{a1}) (\coqdocvar{le\_trans} (\coqdocvar{size} \coqdocvar{a1}) \coqdocvar{\_} 0 (\coqdocvar{le\_plus\_l} \coqdocvar{\_} \coqdocvar{\_}) \coqdocvar{L}))).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{\_} \coqdocvar{def}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a2} \coqdocvar{l2};\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{IH} \coqdocvar{a1} (\coqdocvar{or\_introl} \coqdocvar{\_} \coqdocvar{refl\_equal}) \coqdocvar{a2}); \coqdoctac{intro} \coqdocvar{v}; \coqdoctac{case} \coqdocvar{v}; \coqdoctac{intro} \coqdocvar{Ha1}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{Some} \coqdocvar{l2}); \coqdoctac{intros} \coqdocvar{k} \coqdocvar{L} \coqdocvar{def}; \coqdoctac{simpl}; \coqdoctac{rewrite} \coqdocvar{Ha1}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{list\_size} \coqdocvar{size} (\coqdocvar{a1} :: \coqdocvar{l1})); [\coqdoctac{apply} \coqdocvar{le\_plus\_l} \ensuremath{|} \coqdoctac{apply} \coqdocvar{L}].\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{IHl2} \coqdocvar{l2}); \coqdoctac{clear} \coqdocvar{IHl2}; \coqdoctac{intro} \coqdocvar{ok}; \coqdoctac{case} \coqdocvar{ok}; \coqdoctac{clear} \coqdocvar{ok}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{k2} \coqdocvar{IHl2}; \coqdoctac{\ensuremath{\exists}} (\coqdocvar{Some} (\coqdocvar{a2} :: \coqdocvar{k2})); \coqdoctac{intros} \coqdocvar{k} \coqdocvar{L} \coqdocvar{def}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Ha1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{IHl2}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{list\_size} \coqdocvar{size} (\coqdocvar{a1} :: \coqdocvar{l1})); [\coqdoctac{apply} \coqdocvar{le\_plus\_l} \ensuremath{|} \coqdoctac{apply} \coqdocvar{L}].\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{IHl2}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{None} (\coqdocvar{list} \coqdocvar{term})); \coqdoctac{intros} \coqdocvar{k} \coqdocvar{L} \coqdocvar{def}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Ha1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{IHl2}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{list\_size} \coqdocvar{size} (\coqdocvar{a1} :: \coqdocvar{l1})); [\coqdoctac{apply} \coqdocvar{le\_plus\_l} \ensuremath{|} \coqdoctac{apply} \coqdocvar{L}].\coqdoceol
\coqdocnoindent
\coqdoctac{case} \coqdocvar{Hrem}; \coqdoctac{clear} \coqdocvar{Hrem}; \coqdoctac{intro} \coqdocvar{ok}; \coqdoctac{case} \coqdocvar{ok}; \coqdoctac{clear} \coqdocvar{ok}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{k2} \coqdocvar{Hrem}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{IHl1} \coqdocvar{\_} (\coqdocvar{tail\_set} \coqdocvar{\_} \coqdocvar{IH}) \coqdocvar{k2}); \coqdoctac{intros} \coqdocvar{v} \coqdocvar{Hl1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{v}; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{L} \coqdocvar{def}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{Hrem} \coqdocvar{k} \coqdocvar{L}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{l1\_le\_k} : \coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l1} \ensuremath{\le} \coqdocvar{k}).\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}); \coqdoctac{apply} \coqdocvar{le\_plus\_r}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{Hl1} \coqdocvar{k} \coqdocvar{l1\_le\_k} \coqdocvar{def}).\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{Hrem}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{false}; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{L} \coqdocvar{def}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{Hrem} \coqdocvar{k} \coqdocvar{L}).\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{false}; \coqdoctac{intros} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}; \coqdoctac{exact} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{v} \coqdocvar{H}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{v}; \coqdoctac{intro} \coqdocvar{k}; \coqdoctac{case} \coqdocvar{k}; \coqdoctac{clear} \coqdocvar{k}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{L}; \coqdoctac{apply} \coqdocvar{False\_rec}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{le\_Sn\_O} \coqdocvar{\_} (\coqdocvar{le\_trans} 1 \coqdocvar{\_} 0 (\coqdocvar{le\_plus\_l} \coqdocvar{\_} \coqdocvar{\_}) \coqdocvar{L})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{L} \coqdocvar{def}; \coqdoctac{rewrite} (\coqdocvar{H} \coqdocvar{k}).\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{le\_S\_n}  \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{equiv\_bool} := \coqdockw{fun} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdockw{let} (\coqdocvar{v},\coqdocvar{\_}) := \coqdocvar{equiv\_bool\_terminate} \coqdocvar{t1} \coqdocvar{t2} \coqdoctac{in} \coqdocvar{v}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_bool\_equation} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{t2} = \coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{t1}, \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Var} \coqdocvar{v1}, \coqdocvar{Var} \coqdocvar{v2} \ensuremath{\Rightarrow} \coqdocvar{X.eq\_bool} \coqdocvar{v1} \coqdocvar{v2}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Var} \coqdocvar{\_}, \coqdocvar{Term} \coqdocvar{\_} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Term} \coqdocvar{\_} \coqdocvar{\_}, \coqdocvar{Var} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}, \coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{if} \coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{then}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{match} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Lex} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{4.50em}
\coqdockw{let} \coqdocvar{equiv\_lex\_bool} :=\coqdoceol
\coqdocindent{7.00em}
(\coqdockw{fix} \coqdocvar{equiv\_lex\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) \{\coqdockw{struct} \coqdocvar{kk1}\} :  \coqdocvar{bool} :=  \coqdoceol
\coqdocindent{7.50em}
(\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with} [] \ensuremath{\Rightarrow} \coqdocvar{true} \ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_}\ensuremath{\Rightarrow} \coqdocvar{false} \coqdockw{end}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{10.50em}
\coqdockw{match} \coqdocvar{kk2} \coqdockw{with} \coqdoceol
\coqdocindent{12.50em}
[] \ensuremath{\Rightarrow} \coqdocvar{false} \coqdoceol
\coqdocindent{11.50em}
\ensuremath{|} \coqdocvar{t2} :: \coqdocvar{k2}\ensuremath{\Rightarrow} (\coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{t2}) \&\& (\coqdocvar{equiv\_lex\_bool} \coqdocvar{k1} \coqdocvar{k2})\coqdoceol
\coqdocindent{11.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{end})) \coqdoctac{in}\coqdoceol
\coqdocindent{7.00em}
(\coqdocvar{equiv\_lex\_bool} \coqdocvar{l1} \coqdocvar{l2})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Mul} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{3.50em}
\coqdockw{let} \coqdocvar{equiv\_mult\_bool} :=\coqdoceol
\coqdocindent{7.00em}
(\coqdockw{fix} \coqdocvar{equiv\_mult\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) \{\coqdockw{struct} \coqdocvar{kk1}\} :  \coqdocvar{bool} :=  \coqdoceol
\coqdocindent{7.50em}
(\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with} [] \ensuremath{\Rightarrow} \coqdocvar{true} \ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_}\ensuremath{\Rightarrow} \coqdocvar{false} \coqdockw{end}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{10.50em}
\coqdockw{match} \coqdocvar{remove} \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{kk2} \coqdockw{with} \coqdoceol
\coqdocindent{13.50em}
\coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{false} \coqdoceol
\coqdocindent{12.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{k2} \ensuremath{\Rightarrow} \coqdocvar{equiv\_mult\_bool} \coqdocvar{k1} \coqdocvar{k2} \coqdockw{end}\coqdoceol
\coqdocindent{12.50em}
\coqdockw{end})) \coqdoctac{in}\coqdoceol
\coqdocindent{7.00em}
(\coqdocvar{equiv\_mult\_bool} \coqdocvar{l1} \coqdocvar{l2})\coqdoceol
\coqdocindent{2.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{else} \coqdocvar{false}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{k}, \coqdocvar{size} \coqdocvar{t1} \ensuremath{\le} \coqdocvar{k} \ensuremath{\rightarrow} \coqdocvar{iter} (\coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{bool}) \coqdocvar{k} \coqdocvar{equiv\_bool\_F} \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{k} \coqdocvar{L}; \coqdoctac{unfold} \coqdocvar{equiv\_bool} \coqdoctac{at} 2; \coqdoctac{generalize} (\coqdocvar{equiv\_bool\_terminate} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}; \coqdoctac{case} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intros} \coqdocvar{v} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{t1}; \coqdoctac{pattern} \coqdocvar{t1}; \coqdoctac{apply} \coqdocvar{term\_rec3}; \coqdoctac{clear} \coqdocvar{t1}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v1} [\coqdocvar{v2} \ensuremath{|} \coqdocvar{f2} \coqdocvar{l2}]; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f1} \coqdocvar{l1} \coqdocvar{IH} [\coqdocvar{v2} \ensuremath{|} \coqdocvar{f2} \coqdocvar{l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{H} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdocvar{\_} (\coqdocvar{le\_n} \coqdocvar{\_})). \coqdoctac{rewrite} \coqdocvar{size\_unfold}. \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}); [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{reflexivity}].\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1}); \coqdoctac{clear} \coqdocvar{f1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l1} \coqdocvar{f1} \coqdocvar{f2}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{f1} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{f2} \coqdocvar{t1} \coqdocvar{t2}) \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{l2},\coqdoceol
\coqdocindent{8.50em}
(\coqdockw{fix} \coqdocvar{equiv\_lex\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) : \coqdocvar{bool} :=\coqdoceol
\coqdocindent{8.50em}
\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{true}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqdocvar{t2} :: \coqdocvar{k2} \ensuremath{\Rightarrow} \coqdocvar{f1} \coqdocvar{t1} \coqdocvar{t2} \&\& \coqdocvar{equiv\_lex\_bool} \coqdocvar{k1} \coqdocvar{k2}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}) \coqdocvar{l1} \coqdocvar{l2} =\coqdoceol
\coqdocnoindent
(\coqdockw{fix} \coqdocvar{equiv\_lex\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) : \coqdocvar{bool} :=\coqdoceol
\coqdocindent{8.50em}
\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{true}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqdocvar{t2} :: \coqdocvar{k2} \ensuremath{\Rightarrow} \coqdocvar{f2} \coqdocvar{t1} \coqdocvar{t2} \&\& \coqdocvar{equiv\_lex\_bool} \coqdocvar{k1} \coqdocvar{k2}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}) \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{IH}; \coqdoctac{intro} \coqdocvar{l1}; \coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a1} \coqdocvar{l1}]; \coqdoctac{intros} \coqdocvar{g1} \coqdocvar{g2} \coqdocvar{IH} [ \ensuremath{|} \coqdocvar{a2} \coqdocvar{l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{f\_equal2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IH}; \coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IHl1} \coqdocvar{g1} \coqdocvar{g2} (\coqdocvar{tail\_prop} \coqdocvar{\_} \coqdocvar{IH}) \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{H'} \coqdocvar{l1} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{l2}); \coqdoctac{clear} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t1\_in\_l1} \coqdocvar{t2}; \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{size\_direct\_subterm} \coqdocvar{t1} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l1}) \coqdocvar{t1\_in\_l1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{size\_unfold} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l1})).\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{L}; \coqdoctac{apply} (\coqdocvar{le\_S\_n} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l1} \coqdocvar{f1} \coqdocvar{f2}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{f1} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{f2} \coqdocvar{t1} \coqdocvar{t2}) \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{l2},\coqdoceol
\coqdocindent{8.50em}
(\coqdockw{fix} \coqdocvar{equiv\_mult\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) : \coqdocvar{bool} :=\coqdoceol
\coqdocindent{1.50em}
\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{true}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match}\coqdoceol
\coqdocindent{4.50em}
\coqdocvar{remove} \coqdocvar{f1} \coqdocvar{t1} \coqdocvar{kk2}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{k2} \ensuremath{\Rightarrow} \coqdocvar{equiv\_mult\_bool} \coqdocvar{k1} \coqdocvar{k2}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}) \coqdocvar{l1} \coqdocvar{l2} =\coqdoceol
\coqdocnoindent
(\coqdockw{fix} \coqdocvar{equiv\_mult\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) : \coqdocvar{bool} :=\coqdoceol
\coqdocindent{1.50em}
\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{true}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{remove} \coqdocvar{f2} \coqdocvar{t1} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{k2} \ensuremath{\Rightarrow} \coqdocvar{equiv\_mult\_bool} \coqdocvar{k1} \coqdocvar{k2}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}) \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{IH}; \coqdoctac{intro} \coqdocvar{l1}; \coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a1} \coqdocvar{l1}]; \coqdoctac{intros} \coqdocvar{g1} \coqdocvar{g2} \coqdocvar{IH} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{f1} \coqdocvar{f2}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{f1} \coqdocvar{a1} \coqdocvar{t2} = \coqdocvar{f2} \coqdocvar{a1} \coqdocvar{t2}) \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{l2}, \coqdocvar{remove} \coqdocvar{f1} \coqdocvar{a1} \coqdocvar{l2} = \coqdocvar{remove} \coqdocvar{f2} \coqdocvar{a1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{g1} \coqdocvar{g2} \coqdocvar{IH} \coqdocvar{IHl1}; \coqdoctac{intros} \coqdocvar{g1} \coqdocvar{g2} \coqdocvar{IH}; \coqdoctac{induction} \coqdocvar{l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a2} \coqdocvar{l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} (\coqdocvar{IH} \coqdocvar{a2}); \coqdoctac{rewrite} \coqdocvar{IHl2}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{H'} \coqdocvar{g1} \coqdocvar{g2} (\coqdocvar{IH} \coqdocvar{a1} (\coqdocvar{or\_introl} \coqdocvar{\_} \coqdocvar{refl\_equal}))).\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{remove} \coqdocvar{g2} \coqdocvar{a1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{k2}; \coqdoctac{apply} (\coqdocvar{IHl1} \coqdocvar{g1} \coqdocvar{g2} (\coqdocvar{tail\_prop} \coqdocvar{\_} \coqdocvar{IH})).\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{H'} \coqdocvar{l1} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t1\_in\_l1} \coqdocvar{t2}; \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{size\_direct\_subterm} \coqdocvar{t1} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l1}) \coqdocvar{t1\_in\_l1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{size\_unfold} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l1})).\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{L}; \coqdoctac{apply} (\coqdocvar{le\_S\_n} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_bool\_ok} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdockw{match} \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{t2} \coqdockw{with} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{|} \coqdocvar{false} \ensuremath{\Rightarrow} \ensuremath{\lnot}\coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2} \coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1}; \coqdoctac{pattern} \coqdocvar{t1}; \coqdoctac{apply} \coqdocvar{term\_rec3}; \coqdoctac{clear} \coqdocvar{t1}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v1} \coqdocvar{t2}; \coqdoctac{case} \coqdocvar{t2}; \coqdoctac{clear} \coqdocvar{t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{v2}; \coqdoctac{rewrite} \coqdocvar{equiv\_bool\_equation}; \coqdoctac{generalize} (\coqdocvar{X.eq\_bool\_ok} \coqdocvar{v1} \coqdocvar{v2}); \coqdoctac{case} (\coqdocvar{X.eq\_bool} \coqdocvar{v1} \coqdocvar{v2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{v1\_eq\_v2}; \coqdoctac{rewrite} \coqdocvar{v1\_eq\_v2}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v1\_diff\_v2} \coqdocvar{v1\_eq\_v2}; \coqdoctac{apply} \coqdocvar{v1\_diff\_v2}; \coqdoctac{inversion} \coqdocvar{v1\_eq\_v2}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f2} \coqdocvar{l2}; \coqdoctac{rewrite} \coqdocvar{equiv\_bool\_equation}; \coqdoctac{intro} \coqdocvar{t1\_eq\_t2}; \coqdoctac{inversion} \coqdocvar{t1\_eq\_t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f1} \coqdocvar{l1} \coqdocvar{IH} \coqdocvar{t2}; \coqdoctac{case} \coqdocvar{t2}; \coqdoctac{clear} \coqdocvar{t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v2}; \coqdoctac{rewrite} \coqdocvar{equiv\_bool\_equation}; \coqdoctac{intro} \coqdocvar{t1\_eq\_t2}; \coqdoctac{inversion} \coqdocvar{t1\_eq\_t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f2} \coqdocvar{l2}; \coqdoctac{rewrite} \coqdocvar{equiv\_bool\_equation}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{f1\_eq\_f2}; \coqdocvar{case\_eq} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{Lex\_f1}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \coqdockw{if} (\coqdockw{fix} \coqdocvar{equiv\_lex\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) : \coqdocvar{bool} :=\coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{true}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{t2} :: \coqdocvar{k2} \ensuremath{\Rightarrow} \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{t2} \&\& \coqdocvar{equiv\_lex\_bool} \coqdocvar{k1} \coqdocvar{k2}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}) \coqdocvar{l1} \coqdocvar{l2}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{then} \coqdocvar{equiv\_list\_lex} \coqdocvar{l1} \coqdocvar{l2} \coqdockw{else} \ensuremath{\lnot}\coqdocvar{equiv\_list\_lex} \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{l2}; \coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a1} \coqdocvar{l1}]; \coqdoctac{intro} \coqdocvar{l2}; \coqdoctac{case} \coqdocvar{l2}; \coqdoctac{clear} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a2} \coqdocvar{l2}; \coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{l1\_eq\_l2}; \coqdoctac{inversion} \coqdocvar{l1\_eq\_l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{l1\_eq\_l2}; \coqdoctac{inversion} \coqdocvar{l1\_eq\_l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a2} \coqdocvar{l2}; \coqdoctac{simpl}; \coqdoctac{generalize} (\coqdocvar{IH} \coqdocvar{a1} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})) \coqdocvar{a2}).\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{equiv\_bool} \coqdocvar{a1} \coqdocvar{a2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{a1\_eq\_a2}; \coqdoctac{generalize} (\coqdocvar{IHl1} (\coqdocvar{tail\_prop} \coqdocvar{\_} \coqdocvar{IH}) \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} ((\coqdockw{fix} \coqdocvar{equiv\_lex\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) : \coqdocvar{bool} :=\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{true}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{7.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{t3} :: \coqdocvar{k2} \ensuremath{\Rightarrow} \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{t3} \&\& \coqdocvar{equiv\_lex\_bool} \coqdocvar{k1} \coqdocvar{k2}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{l1\_eq\_l2}; \coqdoctac{apply} \coqdocvar{Eq\_list\_cons}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l1\_diff\_l2} \coqdocvar{l1\_eq\_l2}; \coqdoctac{apply} \coqdocvar{l1\_diff\_l2}; \coqdoctac{inversion} \coqdocvar{l1\_eq\_l2}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a1\_diff\_a2} \coqdocvar{l1\_eq\_l2}; \coqdoctac{apply} \coqdocvar{a1\_diff\_a2}; \coqdoctac{inversion} \coqdocvar{l1\_eq\_l2}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{H}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} ((\coqdockw{fix} \coqdocvar{equiv\_lex\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) : \coqdocvar{bool} :=\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{true}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{7.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{t3} :: \coqdocvar{k2} \ensuremath{\Rightarrow} \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{t3} \&\& \coqdocvar{equiv\_lex\_bool} \coqdocvar{k1} \coqdocvar{k2}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{l1\_eq\_l2}. \coqdoctac{apply} \coqdocvar{Eq\_lex}; \coqdoctac{trivial}. \coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H2} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{rewrite} \coqdocvar{f1\_eq\_f2} \coqdoctac{in} \coqdocvar{H2'}. \coqdoctac{assert} (\coqdocvar{H5}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{assert} (\coqdocvar{H6}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}). \coqdoctac{apply} \coqdocvar{H5}; \coqdoctac{trivial}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H6}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H2'}:= (\coqdocvar{H2} \coqdocvar{f1} \coqdocvar{f2})). \coqdoctac{rewrite} \coqdocvar{f1\_eq\_f2} \coqdoctac{in} \coqdocvar{H2'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l1\_diff\_l2} \coqdocvar{t1\_eq\_t2}; \coqdoctac{inversion} \coqdocvar{t1\_eq\_t2}; \coqdoctac{subst} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{l1\_diff\_l2}; \coqdoctac{generalize} \coqdocvar{l1}; \coqdoctac{intro} \coqdocvar{l}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a} \coqdocvar{l}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_cons}; [\coqdoctac{apply} \coqdocvar{Eq} \ensuremath{|} \coqdoctac{assumption}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{l1\_diff\_l2}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{f2}; \coqdoctac{rewrite} \coqdocvar{Lex\_f1} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{Mul\_f1}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \coqdockw{if} (\coqdockw{fix} \coqdocvar{equiv\_mult\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) : \coqdocvar{bool} :=\coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{true}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{remove} \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{k2} \ensuremath{\Rightarrow} \coqdocvar{equiv\_mult\_bool} \coqdocvar{k1} \coqdocvar{k2}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}) \coqdocvar{l1} \coqdocvar{l2}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{then} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l1} \coqdocvar{l2} \coqdockw{else} \ensuremath{\lnot}\coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{l2}; \coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a1} \coqdocvar{l1}].\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{l2}; \coqdoctac{case} \coqdocvar{l2}; \coqdoctac{clear} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Pnil}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a2} \coqdocvar{l2}; \coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{t1\_eq\_t2}; \coqdoctac{inversion} \coqdocvar{t1\_eq\_t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{R} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l2}, \coqdockw{match} \coqdocvar{remove} \coqdocvar{equiv\_bool} \coqdocvar{a1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{0.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\{\coqdocvar{a2} : \coqdocvar{term} \& \coqdoceol
\coqdocindent{2.50em}
\{\coqdocvar{l2'} : \coqdocvar{list} \coqdocvar{term} \& \coqdoceol
\coqdocindent{2.50em}
\{\coqdocvar{l2'{}'} : \coqdocvar{list} \coqdocvar{term} \ensuremath{|}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{equiv} \coqdocvar{a1} \coqdocvar{a2} \ensuremath{\land}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{l2} = \coqdocvar{l2'} ++ \coqdocvar{a2} :: \coqdocvar{l2'{}'} \ensuremath{\land} \coqdocvar{remove} \coqdocvar{equiv\_bool} \coqdocvar{a1} \coqdocvar{l2} = \coqdocvar{Some} (\coqdocvar{l2'} ++ \coqdocvar{l2'{}'})\}\}\}\coqdoceol
\coqdocindent{0.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{a2}, \coqdocvar{equiv} \coqdocvar{a1} \coqdocvar{a2} \ensuremath{\rightarrow} \ensuremath{\lnot} \coqdocvar{In} \coqdocvar{a2}  \coqdocvar{l2}\coqdoceol
\coqdocindent{0.50em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{l2}; \coqdoctac{induction} \coqdocvar{l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a2} \coqdocvar{l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a2} \coqdocvar{a1\_eq\_a2} \coqdocvar{F}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{remove\_equation}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IH} \coqdocvar{a1} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})) \coqdocvar{a2}); \coqdoctac{case} (\coqdocvar{equiv\_bool} \coqdocvar{a1} \coqdocvar{a2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{a1\_eq\_a2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{a2}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} \coqdocvar{term}); \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{a1\_diff\_a2}; \coqdocvar{revert} \coqdocvar{IHl2}; \coqdoctac{case} (\coqdocvar{remove} \coqdocvar{equiv\_bool} \coqdocvar{a1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{k2} [\coqdocvar{a1'} [\coqdocvar{l2'} [\coqdocvar{l2'{}'} [\coqdocvar{H1} [\coqdocvar{H2} \coqdocvar{H3}]]]]]; \coqdoctac{\ensuremath{\exists}} \coqdocvar{a1'}; \coqdoctac{\ensuremath{\exists}} (\coqdocvar{a2} :: \coqdocvar{l2'}); \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2'{}'}; \coqdoctac{repeat} \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdoctac{f\_equal}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{do} 2 \coqdoctac{apply} \coqdoctac{f\_equal}; \coqdoctac{injection} \coqdocvar{H3}; \coqdoctac{intros}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{a1\_not\_in\_l2}; \coqdoctac{intros} \coqdocvar{a} \coqdocvar{a\_eq\_a1} [\coqdocvar{a\_eq\_a2} \ensuremath{|} \coqdocvar{a\_in\_l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{a}; \coqdoctac{apply} \coqdocvar{a1\_diff\_a2}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{a1\_not\_in\_l2} \coqdocvar{a} \coqdocvar{a\_eq\_a1} \coqdocvar{a\_in\_l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{l2}; \coqdoctac{generalize} (\coqdocvar{R} \coqdocvar{l2}); \coqdoctac{case} (\coqdocvar{remove} \coqdocvar{equiv\_bool} \coqdocvar{a1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{k2} [\coqdocvar{a2} [\coqdocvar{k2'} [\coqdocvar{k2'{}'} [\coqdocvar{H1} [\coqdocvar{H2} \coqdocvar{H3}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHl1} (\coqdocvar{tail\_prop} \coqdocvar{\_} \coqdocvar{IH}) \coqdocvar{k2}); \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{injection} \coqdocvar{H3}; \coqdoctac{clear} \coqdocvar{H3}; \coqdoctac{intro} \coqdocvar{H3}; \coqdoceol
\coqdocnoindent
\coqdoctac{case} ((\coqdockw{fix} \coqdocvar{equiv\_mult\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) : \coqdocvar{bool} :=\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{true}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{7.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{match} \coqdocvar{remove} \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{k3} \ensuremath{\Rightarrow} \coqdocvar{equiv\_mult\_bool} \coqdocvar{k1} \coqdocvar{k3}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) \coqdocvar{l1} \coqdocvar{k2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{P}; \coqdoctac{subst} \coqdocvar{l2} \coqdocvar{k2}; \coqdoctac{apply} \coqdocvar{Pcons}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{not\_P} \coqdocvar{P}; \coqdoctac{subst} \coqdocvar{l2} \coqdocvar{k2}; \coqdoctac{apply} \coqdocvar{not\_P}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{permut\_cons\_inside} \coqdocvar{term} \coqdocvar{term} \coqdocvar{equiv}) \coqdockw{with} \coqdocvar{a1} \coqdocvar{a2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u3} \coqdocvar{u1} \coqdocvar{u4} \coqdocvar{u2} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{H31} \coqdocvar{H41} \coqdocvar{H42}; \coqdoctac{transitivity} \coqdocvar{u1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{u4}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H} \coqdocvar{P}; \coqdoctac{inversion} \coqdocvar{P} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a1'} \coqdocvar{a2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{l2'{}'} \coqdocvar{a1\_eq\_a2} \coqdocvar{P'}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{H} \coqdocvar{a2} \coqdocvar{a1\_eq\_a2}); \coqdoctac{subst} \coqdocvar{l2}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{H}; \coqdoctac{case} ((\coqdockw{fix} \coqdocvar{equiv\_mult\_bool} (\coqdocvar{kk1} \coqdocvar{kk2} : \coqdocvar{list} \coqdocvar{term}) : \coqdocvar{bool} :=\coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{kk1} \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{true}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{\_} :: \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{t1} :: \coqdocvar{k1} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{remove} \coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{kk2} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{k2} \ensuremath{\Rightarrow} \coqdocvar{equiv\_mult\_bool} \coqdocvar{k1} \coqdocvar{k2}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}) \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{P}. \coqdoctac{apply} \coqdocvar{Eq\_mul}. \coqdoctac{assumption}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H2} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{rewrite} \coqdocvar{f1\_eq\_f2} \coqdoctac{in} \coqdocvar{H2'}. \coqdoctac{assert} (\coqdocvar{H6}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}); \coqdoctac{trivial}. \coqdoctac{assert} (\coqdocvar{H7}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}). \coqdoctac{apply} \coqdocvar{H6}. \coqdoctac{trivial}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H7}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H2} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{rewrite} \coqdocvar{f1\_eq\_f2} \coqdoctac{in} \coqdocvar{H2'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{not\_P} \coqdocvar{t1\_eq\_t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t1\_eq\_t2}. \coqdoctac{subst} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{not\_P}; \coqdoctac{apply} \coqdocvar{permut\_refl}; \coqdoctac{intros}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Mul\_f1} \coqdoctac{in} \coqdocvar{H3}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{not\_P}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f1\_diff\_f2} \coqdocvar{t1\_eq\_t2}. \coqdoctac{inversion} \coqdocvar{t1\_eq\_t2}. \coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} \coqdocvar{f1\_diff\_f2}. \coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f2} \coqdocvar{f2}). \coqdoctac{rewrite} \coqdocvar{f1\_diff\_f2} \coqdoctac{in} \coqdocvar{H3'}. \coqdocvar{contradict} \coqdocvar{H3'}. \coqdoctac{apply} \coqdocvar{prec\_eq\_refl}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H8}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H8'}:= \coqdocvar{H8} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{rewrite} \coqdocvar{f1\_diff\_f2} \coqdoctac{in} \coqdocvar{H8'}. \coqdocvar{contradict} \coqdocvar{H8'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H8}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H8'}:= \coqdocvar{H8} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{rewrite} \coqdocvar{f1\_diff\_f2} \coqdoctac{in} \coqdocvar{H8'}. \coqdocvar{contradict} \coqdocvar{H8'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_dec} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \{\coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}\}+\{\~{}\coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2}; \coqdoctac{generalize} (\coqdocvar{equiv\_bool\_ok} \coqdocvar{t1} \coqdocvar{t2}); \coqdoctac{case} (\coqdocvar{equiv\_bool} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_rec3\_mem} : \coqdoceol
\coqdocindent{1.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{P} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Type},\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{v} : \coqdocvar{variable}, \coqdocvar{P} (\coqdocvar{Var} \coqdocvar{v})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{\ensuremath{\forall}} (\coqdocvar{f} : \coqdocvar{symbol}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{term}),\coqdoceol
\coqdocindent{4.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t} : \coqdocvar{term}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{P} \coqdocvar{t}) \ensuremath{\rightarrow} \coqdocvar{P} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} : \coqdocvar{term}, \coqdocvar{P} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{P} \coqdocvar{Hvar} \coqdocvar{Hterm}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{term\_rec2}; \coqdoctac{induction} \coqdocvar{n}; \coqdoctac{intros} \coqdocvar{t} \coqdocvar{Size\_t}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (1 \ensuremath{\le} 0); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} \coqdocvar{t}); \coqdoctac{trivial}; \coqdoctac{apply} \coqdocvar{size\_ge\_one}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t} \coqdockw{as} [ \coqdocvar{x} \ensuremath{|} \coqdocvar{f} \coqdocvar{l} ]; \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Hterm}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHn};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_n\_Sm\_le}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_le\_trans} \coqdockw{with} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{H}) \coqdockw{as} [\coqdocvar{t'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{t\_eq\_t'} [\coqdocvar{H'} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{t\_eq\_t'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H'}; \coqdoctac{subst} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_same\_size} \coqdocvar{t\_eq\_t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{rpo} (\coqdocvar{bb} : \coqdocvar{nat}) : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Subterm} : \coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Top\_gt} : \coqdoceol
\coqdocindent{3.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{prec} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{f} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s'}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s'} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s'} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{3.50em}
\coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l'}) (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Top\_eq\_lex} : \coqdoceol
\coqdocindent{4.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f} = \coqdocvar{Lex}  \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g} = \coqdocvar{Lex} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} (\coqdocvar{length} \coqdocvar{l} = \coqdocvar{length} \coqdocvar{l'} \ensuremath{\lor} (\coqdocvar{length} \coqdocvar{l'} \ensuremath{\le} \coqdocvar{bb} \ensuremath{\land} \coqdocvar{length} \coqdocvar{l} \ensuremath{\le} \coqdocvar{bb})) \ensuremath{\rightarrow} \coqdocvar{rpo\_lex} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{s'}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s'} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s'} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l'}) (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l})\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Top\_eq\_mul} : \coqdoceol
\coqdocindent{4.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f} = \coqdocvar{Mul}  \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g} = \coqdocvar{Mul} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l'}) (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l})\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocnoindent
\coqdockw{with} \coqdocvar{rpo\_eq} (\coqdocvar{bb} : \coqdocvar{nat}) : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Equiv} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Lt} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocnoindent
\coqdockw{with} \coqdocvar{rpo\_lex} (\coqdocvar{bb} : \coqdocvar{nat}) : \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{List\_gt} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{t} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo\_lex} \coqdocvar{bb} (\coqdocvar{s} :: \coqdocvar{l}) (\coqdocvar{t} :: \coqdocvar{l'})\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{List\_eq} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{s'} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{s'} \ensuremath{\rightarrow} \coqdocvar{rpo\_lex} \coqdocvar{bb} \coqdocvar{l} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{rpo\_lex} \coqdocvar{bb} (\coqdocvar{s} :: \coqdocvar{l}) (\coqdocvar{s'} :: \coqdocvar{l'})\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{List\_nil} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{l}, \coqdocvar{rpo\_lex} \coqdocvar{bb} \coqdocvar{nil} (\coqdocvar{s} :: \coqdocvar{l})\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocnoindent
\coqdockw{with} \coqdocvar{rpo\_mul} ( \coqdocvar{bb} : \coqdocvar{nat}) : \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{List\_mul} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l} \coqdocvar{l'}, \coqdoceol
\coqdocindent{3.50em}
\coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l'} (\coqdocvar{ls} ++ \coqdocvar{lc}) \ensuremath{\rightarrow} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l} (\coqdocvar{a} :: \coqdocvar{lg} ++ \coqdocvar{lc}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{b}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a'} (\coqdocvar{a} :: \coqdocvar{lg}) \ensuremath{\land} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{b} \coqdocvar{a'}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size\_direct\_subterm\_mem} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{t} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) \ensuremath{\le} \coqdocvar{S} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t} \ensuremath{\le} \coqdocvar{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{t} \coqdocvar{f} \coqdocvar{l} \coqdocvar{Sfl} \coqdocvar{t\_mem\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{t\_mem\_l}) \coqdockw{as} [\coqdocvar{t'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{t\_eq\_t'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{t\_eq\_t'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{subst} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_same\_size} \coqdocvar{t\_eq\_t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size2\_lex1\_mem} : \coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{o\_size2} (\coqdocvar{s},\coqdocvar{t1}) (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l},\coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{s\_mem\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{s\_mem\_l}) \coqdockw{as} [\coqdocvar{s'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{s\_eq\_s'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{s\_eq\_s'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size2}, \coqdocvar{size2}; \coqdoctac{rewrite} (\coqdocvar{equiv\_same\_size} \coqdocvar{s\_eq\_s'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{size2\_lex1} \coqdocvar{s'} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size2\_lex2\_mem} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{o\_size2} (\coqdocvar{s},\coqdocvar{t}) (\coqdocvar{s}, \coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{t\_mem\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{t\_mem\_l}) \coqdockw{as} [\coqdocvar{t'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{t\_eq\_t'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{t\_eq\_t'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size2}, \coqdocvar{size2}; \coqdoctac{rewrite} (\coqdocvar{equiv\_same\_size} \coqdocvar{t\_eq\_t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{size2\_lex2} \coqdocvar{t'} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size3\_lex1\_mem} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{u1} \coqdocvar{t2} \coqdocvar{u2}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{o\_size3} (\coqdocvar{s},(\coqdocvar{t1},\coqdocvar{u1})) (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l},(\coqdocvar{t2},\coqdocvar{u2})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{u1} \coqdocvar{t2} \coqdocvar{u2} \coqdocvar{s\_mem\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{s\_mem\_l}) \coqdockw{as} [\coqdocvar{s'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{s\_eq\_s'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{s\_eq\_s'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size3}, \coqdocvar{size3}; \coqdoctac{rewrite} (\coqdocvar{equiv\_same\_size} \coqdocvar{s\_eq\_s'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{size3\_lex1} \coqdocvar{s'} \coqdocvar{f} \coqdocvar{l} \coqdocvar{t1} \coqdocvar{u1} \coqdocvar{t2} \coqdocvar{u2}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size3\_lex2\_mem} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{u1} \coqdocvar{u2}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{o\_size3} (\coqdocvar{s},(\coqdocvar{t},\coqdocvar{u1})) (\coqdocvar{s},(\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{u2})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{u1} \coqdocvar{u2} \coqdocvar{t\_mem\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{t\_mem\_l}) \coqdockw{as} [\coqdocvar{t'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{t\_eq\_t'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{t\_eq\_t'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size3}, \coqdocvar{size3}, \coqdocvar{size2}; \coqdoctac{rewrite} (\coqdocvar{equiv\_same\_size} \coqdocvar{t\_eq\_t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{size3\_lex2} \coqdocvar{t'} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{u1} \coqdocvar{u2}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size3\_lex3\_mem} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{u} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{o\_size3} (\coqdocvar{s},(\coqdocvar{t},\coqdocvar{u})) (\coqdocvar{s},(\coqdocvar{t},\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{t} \coqdocvar{u\_mem\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{u\_mem\_l}) \coqdockw{as} [\coqdocvar{u'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{u\_eq\_u'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{u\_eq\_u'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size3}, \coqdocvar{size3}, \coqdocvar{size2}; \coqdoctac{rewrite} (\coqdocvar{equiv\_same\_size} \coqdocvar{u\_eq\_u'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{size3\_lex3} \coqdocvar{u'} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size3\_lex3\_prec} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{u} \coqdocvar{f} \coqdocvar{g} \coqdocvar{h} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{s}, \coqdocvar{In} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{h} \ensuremath{\rightarrow} \coqdocvar{o\_size3} (\coqdocvar{s},(\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l'},\coqdocvar{u})) (\coqdocvar{s},(\coqdocvar{Term} \coqdocvar{h} \coqdocvar{l'},\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{f} \coqdocvar{g} \coqdocvar{h} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{s} \coqdocvar{u\_in\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size3}, \coqdocvar{size3}, \coqdocvar{size2}, \coqdocvar{lex};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); \coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); [\coqdoctac{intros} \coqdocvar{\_} \ensuremath{|} \coqdoctac{intro} \coqdocvar{s\_diff\_s}].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l'})) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{h} \coqdocvar{l'})));  \coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l'})) (\coqdocvar{size} (\coqdocvar{Term} \coqdocvar{h} \coqdocvar{l'}))); [\coqdoctac{intros} \coqdocvar{\_} \ensuremath{|} \coqdoctac{intro} \coqdocvar{t\_diff\_t}]. \coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{size\_direct\_subterm} \coqdocvar{u} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) \coqdocvar{u\_in\_l}). \coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{t\_diff\_t}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{s\_diff\_s}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size3\_lex3\_mem\_preceq} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{u} \coqdocvar{f} \coqdocvar{g} \coqdocvar{h} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{u} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{h} \ensuremath{\rightarrow} \coqdocvar{o\_size3} (\coqdocvar{s},(\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l'},\coqdocvar{u})) (\coqdocvar{s},(\coqdocvar{Term} \coqdocvar{h} \coqdocvar{l'},\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{f} \coqdocvar{g} \coqdocvar{h} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{s} \coqdocvar{u\_mem\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{u\_mem\_l}) \coqdockw{as} [\coqdocvar{u'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{u\_eq\_u'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{u\_eq\_u'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size3}, \coqdocvar{size3}, \coqdocvar{size2}; \coqdoctac{rewrite} (\coqdocvar{equiv\_same\_size} \coqdocvar{u\_eq\_u'}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{prec\_g\_h}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{size3\_lex3\_prec} \coqdocvar{u'} \coqdocvar{f} \coqdocvar{g} \coqdocvar{h} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mem\_mem} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{equiv\_list\_lex} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow}  (\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l1} \ensuremath{\leftrightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{t} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2}; \coqdoctac{clear} \coqdocvar{t} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2}; \coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2} \coqdocvar{t\_mem\_l1}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_eq\_l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{s1\_eq\_s2} \coqdocvar{l1\_eq\_l2'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t\_mem\_l1} \coqdockw{as} [ \coqdocvar{t\_eq\_t1} \ensuremath{|} \coqdocvar{t\_mem\_l1}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{transitivity} \coqdocvar{t1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{apply} \coqdocvar{IHl1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{t} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2}; \coqdoctac{clear} \coqdocvar{t} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2}; \coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{l2} \coqdocvar{l1\_eq\_l2} \coqdocvar{t\_mem\_l2};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_eq\_l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{s1\_eq\_s2} \coqdocvar{l1\_eq\_l2'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t\_mem\_l2} \coqdockw{as} [ \coqdocvar{t\_eq\_t2} \ensuremath{|} \coqdocvar{t\_mem\_l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{transitivity} \coqdocvar{s2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{apply} \coqdocvar{IHl1} \coqdockw{with} \coqdocvar{l2'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_rpo\_equiv\_1} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\leftrightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{bb}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \coqdockw{\ensuremath{\forall}} \coqdocvar{p}, \coqdockw{match} \coqdocvar{p} \coqdockw{with} (\coqdocvar{s},\coqdocvar{t}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{15.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t'}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{p}; \coqdoctac{pattern} \coqdocvar{p}; \coqdoctac{refine} (\coqdocvar{well\_founded\_ind} \coqdocvar{wf\_size2} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}); \coqdoctac{clear} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{s} \coqdocvar{t}] \coqdocvar{IH} \coqdocvar{t'} \coqdocvar{t\_eq\_t'} \coqdocvar{s\_lt\_t}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t\_eq\_t'} \coqdockw{as} [ \coqdocvar{t'{}'} \ensuremath{|} \coqdocvar{f} \coqdocvar{g'{}'} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Statf} \coqdocvar{Statg} \coqdocvar{eq\_f\_g} \coqdocvar{H} \ensuremath{|} \coqdocvar{f} \coqdocvar{g'{}'} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Statf} \coqdocvar{Statg} \coqdocvar{eq\_f\_g} \coqdocvar{P}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{s\_lt\_t} \coqdockw{as}  [\coqdocvar{g} \coqdocvar{l} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'\_mem\_l} \coqdocvar{t'{}'\_le\_t'}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{g} \coqdocvar{g'} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{g\_prec\_f} \coqdocvar{l'\_lt\_t}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{g} \coqdocvar{g'{}'{}'} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{Stat\_g} \coqdocvar{Statg'{}'{}'} \coqdocvar{eq\_g\_g'{}'{}'} \coqdocvar{L} \coqdocvar{l'\_lt\_ll1} \coqdocvar{l'\_lt\_t}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{g} \coqdocvar{g'{}'{}'} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{Stat\_g} \coqdocvar{Statg'{}'{}'} \coqdocvar{eq\_g\_g'{}'{}'} \coqdocvar{l'\_lt\_ll1} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t'{}'\_le\_t'} \coqdockw{as} [\coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'{}'\_eq\_t'} \ensuremath{|} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'{}'\_lt\_t'}];\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{t'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_mem} \coqdocvar{t'} \coqdocvar{H}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_mem} \coqdocvar{t'} \coqdocvar{H}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_gt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_prec1} \coqdockw{with} \coqdocvar{f}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} \coqdocvar{s'\_mem\_l'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{s'},(\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l1}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{l'\_lt\_t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_lex}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_transitive} \coqdockw{with} \coqdocvar{f}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_list\_lex\_same\_length} \coqdocvar{H}); \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{t\_eq\_t'} \coqdocvar{l'\_lt\_t} \coqdocvar{s\_lt\_t} \coqdocvar{L}. \coqdocvar{revert} \coqdocvar{l2} \coqdocvar{l'} \coqdocvar{l'\_lt\_ll1} \coqdocvar{IH} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros} \coqdocvar{l2} \coqdocvar{l'} \coqdocvar{l'\_lt\_l1} \coqdocvar{IH} \coqdocvar{l1\_eq\_l2};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l'\_lt\_l1} \coqdockw{as} [ \coqdocvar{s} \coqdocvar{t1'} \coqdocvar{l'{}'} \coqdocvar{l1'} \coqdocvar{s\_lt\_t1'} \coqdocvar{L\_eq} \coqdoceol
\coqdocindent{14.50em}
\ensuremath{|} \coqdocvar{t1'} \coqdocvar{t1'{}'} \coqdocvar{l'{}'} \coqdocvar{l1'} \coqdocvar{t1'\_eq\_t1'{}'} \coqdocvar{l'{}'\_lt\_l1'} \ensuremath{|} \coqdocvar{s} \coqdocvar{l'{}'}]; \coqdoctac{subst};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_eq\_l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1'{}'} \coqdocvar{t2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{t1'{}'\_eq\_t2} \coqdocvar{l1\_eq\_l2'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{List\_gt}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{s},\coqdocvar{t1})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{t1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{y} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{IH}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{o\_size2\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{H} \coqdocvar{\_}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_bis}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} \coqdocvar{s'\_mem\_l'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{s'}, \coqdocvar{Term} \coqdocvar{f} \coqdocvar{l1})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{l'\_lt\_t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Statf} \coqdoctac{in} \coqdocvar{Statg'{}'{}'}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{s\_lt\_t} \coqdockw{as}  [\coqdocvar{g} \coqdocvar{l} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'\_mem\_l} \coqdocvar{t'{}'\_le\_t'}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{g} \coqdocvar{g'} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{g\_prec\_f} \coqdocvar{l'\_lt\_t}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{g} \coqdocvar{g'{}'{}'} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{Stat\_g} \coqdocvar{Statg'{}'{}'} \coqdocvar{eq\_g\_g'{}'{}'} \coqdocvar{L} \coqdocvar{l'\_lt\_ll1} \coqdocvar{l'\_lt\_t}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{g} \coqdocvar{g'{}'{}'} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{Stat\_g} \coqdocvar{Statg'{}'{}'} \coqdocvar{eq\_g\_g'{}'{}'} \coqdocvar{l'\_lt\_ll1} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t'{}'\_le\_t'} \coqdockw{as} [\coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'{}'\_eq\_t'} \ensuremath{|} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'{}'\_lt\_t'}];\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{t'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv}  \coqdocvar{t'} \coqdocvar{P}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{t'} \coqdocvar{P}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_gt}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_prec1} \coqdockw{with} \coqdocvar{f}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} \coqdocvar{s'\_mem\_l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{s'}, \coqdocvar{Term} \coqdocvar{f} \coqdocvar{l1})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{l'\_lt\_t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Statf} \coqdoctac{in} \coqdocvar{Statg'{}'{}'}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_mul}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_transitive} \coqdockw{with} \coqdocvar{f}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l'\_lt\_ll1} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l'{}'} \coqdocvar{l'{}'{}'} \coqdocvar{Q1} \coqdocvar{Q2} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{permut0\_trans} \coqdocvar{equiv\_equiv}) \coqdockw{with} \coqdocvar{l1}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{permut0\_sym} \coqdocvar{equiv\_equiv}). \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Q2}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{t\_eq\_t'} \coqdocvar{s}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{H} (\coqdocvar{s},\coqdocvar{t})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{H} (\coqdocvar{s},\coqdocvar{t'})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_rpo\_equiv\_2} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\leftrightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t'} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{bb}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \coqdockw{\ensuremath{\forall}} \coqdocvar{p}, \coqdockw{match} \coqdocvar{p} \coqdockw{with} (\coqdocvar{s},\coqdocvar{t}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{15.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t'} \coqdocvar{s}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{p}; \coqdoctac{pattern} \coqdocvar{p}; \coqdoctac{refine} (\coqdocvar{well\_founded\_ind} \coqdocvar{wf\_size2} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}); \coqdoctac{clear} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{s} \coqdocvar{t}] \coqdocvar{IH} \coqdocvar{t'} \coqdocvar{t\_eq\_t'} \coqdocvar{t\_lt\_s}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t\_eq\_t'} \coqdockw{as} [ \coqdocvar{t'{}'} \ensuremath{|} \coqdocvar{g} \coqdocvar{g'} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Stat} \coqdocvar{Statg'} \coqdocvar{g\_eq\_g'} \coqdocvar{l1\_eq\_l2} \ensuremath{|} \coqdocvar{g} \coqdocvar{g'} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Stat} \coqdocvar{Statg'} \coqdocvar{g\_eq\_g'} \coqdocvar{P}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t\_lt\_s} \coqdockw{as}  [\coqdocvar{f} \coqdocvar{l} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'\_mem\_l} \coqdocvar{t'{}'\_le\_t'}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f} \coqdocvar{f'} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{g\_prec\_f} \coqdocvar{l'\_lt\_s}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{Stat\_g} \coqdocvar{Stat'} \coqdocvar{f\_stat\_g} \coqdocvar{L} \coqdocvar{ll1\_lt\_l} \coqdocvar{ll\_lt\_s}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{Stat\_g} \coqdocvar{Stat'} \coqdocvar{f\_stat\_g} \coqdocvar{ll1\_lt\_l} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t'{}'\_le\_t'} \coqdockw{as} [\coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'{}'\_eq\_t'} \ensuremath{|} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'{}'\_lt\_t'}];\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{t'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{t'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{t'},\coqdocvar{t'{}'})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_gt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_prec2} \coqdockw{with} \coqdocvar{g}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} \coqdocvar{s'\_mem\_l2}. \coqdoctac{apply} \coqdocvar{l'\_lt\_s}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{mem\_mem} \coqdocvar{s'} \coqdocvar{l1} \coqdocvar{l2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_lex}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_transitive} \coqdockw{with} \coqdocvar{g}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_list\_lex\_same\_length} \coqdocvar{l1\_eq\_l2}); \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{t\_eq\_t'} \coqdocvar{ll\_lt\_s} \coqdocvar{t\_lt\_s} \coqdocvar{L}; \coqdocvar{revert} \coqdocvar{l2} \coqdocvar{l} \coqdocvar{l1\_eq\_l2} \coqdocvar{ll1\_lt\_l} \coqdocvar{IH}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros} \coqdocvar{l2} \coqdocvar{l} \coqdocvar{l1\_eq\_l2} \coqdocvar{l1\_lt\_l} \coqdocvar{IH};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_lt\_l} \coqdockw{as} [ \coqdocvar{t1'} \coqdocvar{s} \coqdocvar{l1'} \coqdocvar{l'} \coqdocvar{t1'\_lt\_s} \coqdocvar{L\_eq} \coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{t1'} \coqdocvar{s} \coqdocvar{l1'} \coqdocvar{l'{}'} \coqdocvar{t1'\_eq\_s} \coqdocvar{l1'\_lt\_l'{}'} \coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{s} \coqdocvar{l'}]; \coqdoctac{subst};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_eq\_l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1'{}'} \coqdocvar{t2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{t1'{}'\_eq\_t2} \coqdocvar{l1\_eq\_l2'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{List\_gt}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{s},\coqdocvar{t1})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{List\_eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{t1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{y} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{IH}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{o\_size2\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{H} \coqdocvar{\_}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_bis}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} \coqdocvar{s'\_in\_l2}; \coqdoctac{apply} \coqdocvar{ll\_lt\_s}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{mem\_mem} \coqdocvar{s'} \coqdocvar{l1} \coqdocvar{l2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Stat} \coqdoctac{in} \coqdocvar{Stat\_g}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t\_lt\_s} \coqdockw{as}  [\coqdocvar{f} \coqdocvar{l} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'\_mem\_l} \coqdocvar{t'{}'\_le\_t'}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f} \coqdocvar{f'} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{g\_prec\_f} \coqdocvar{l'\_lt\_s}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{Stat\_g} \coqdocvar{Stat'} \coqdocvar{f\_stat\_g} \coqdocvar{L} \coqdocvar{ll1\_lt\_l} \coqdocvar{ll\_lt\_s}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{Stat\_g} \coqdocvar{Stat'} \coqdocvar{f\_stat\_g} \coqdocvar{ll1\_lt\_l} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t'{}'\_le\_t'} \coqdockw{as} [\coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'{}'\_eq\_t'} \ensuremath{|} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'{}'\_lt\_t'}];\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{t'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{t'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{t'},\coqdocvar{t'{}'})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_gt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_prec2} \coqdockw{with} \coqdocvar{g}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} \coqdocvar{s'\_mem\_l2}; \coqdoctac{apply} \coqdocvar{l'\_lt\_s}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{s'} \coqdocvar{P}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Stat} \coqdoctac{in} \coqdocvar{Stat\_g}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_mul}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_transitive} \coqdockw{with} \coqdocvar{g}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{ll1\_lt\_l} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{Q1} \coqdocvar{Q2} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} \coqdocvar{l1}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{permut0\_sym} \coqdocvar{equiv\_equiv}). \coqdoctac{assumption}. \coqdoctac{assumption}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{t\_eq\_t'} \coqdocvar{s}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{H} (\coqdocvar{s},\coqdocvar{t})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{H} (\coqdocvar{s},\coqdocvar{t'})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_rpo\_equiv\_3} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\leftrightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{bb}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H}: \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t'})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{t\_eq\_t'} \coqdocvar{s} \coqdocvar{s\_le\_t}; \coqdoctac{inversion} \coqdocvar{s\_le\_t}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} (\coqdocvar{equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{with} \coqdocvar{t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{t\_eq\_t'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{t\_eq\_t'} \coqdocvar{s}; \coqdoctac{split}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_rpo\_equiv\_4} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\leftrightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t'} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{bb}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H}: \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t'} \coqdocvar{s})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{t\_eq\_t'} \coqdocvar{s} \coqdocvar{t\_le\_s}; \coqdoctac{inversion} \coqdocvar{t\_le\_s}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} (\coqdocvar{equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{with} \coqdocvar{t}; \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{t\_eq\_t'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{t\_eq\_t'} \coqdocvar{s}; \coqdoctac{split}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{rpo is a preorder, and its reflexive closure is an ordering.}

\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_subterm\_equiv} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{tj}, \coqdocvar{direct\_subterm} \coqdocvar{tj} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{tj} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{s} [ \ensuremath{|} \coqdocvar{f} \coqdocvar{l}] \coqdocvar{fl\_eq\_s} \coqdocvar{tj}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{tj\_in\_l}; \coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_}  \coqdocvar{fl\_eq\_s}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{tj}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_subterm} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{tj}, \coqdocvar{direct\_subterm} \coqdocvar{tj} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{tj} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}; \coqdoceol
\coqdocnoindent
\coqdoctac{cut} (\coqdockw{\ensuremath{\forall}} \coqdocvar{p} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term},\coqdoceol
\coqdocindent{6.50em}
\coqdockw{match} \coqdocvar{p} \coqdockw{with}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} (\coqdocvar{s},\coqdocvar{t}) \ensuremath{\Rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{tj}, \coqdocvar{direct\_subterm} \coqdocvar{tj} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{tj} \coqdocvar{s}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}; \coqdoctac{apply} (\coqdocvar{H} (\coqdocvar{s},\coqdocvar{t})).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{s} \coqdocvar{t}; \coqdoctac{intro} \coqdocvar{p}; \coqdoctac{pattern} \coqdocvar{p}; \coqdoctac{refine} (\coqdocvar{well\_founded\_ind} \coqdocvar{wf\_size2} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}); \coqdoctac{clear} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{s} [ \coqdocvar{v} \ensuremath{|} \coqdocvar{f} \coqdocvar{l}]] \coqdocvar{IH} \coqdocvar{t\_lt\_s} \coqdocvar{tj} \coqdocvar{tj\_in\_l}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{tj\_in\_l}; [ \coqdocvar{contradiction} \ensuremath{|} \coqdoctac{idtac}].\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t\_lt\_s} \coqdockw{as} [ \coqdocvar{f'} \coqdocvar{l'} \coqdocvar{t'} \coqdocvar{s'} \coqdocvar{s'\_in\_l'} \coqdocvar{t'\_le\_s'}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{g'\_prec\_f'} \coqdocvar{H}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{Sf'} \coqdocvar{Sg} \coqdocvar{f\_eq\_g} \coqdocvar{L} \coqdocvar{k'\_lt\_k} \coqdocvar{H}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{Sf'} \coqdocvar{Sg} \coqdocvar{f\_eq\_g} \coqdocvar{k'\_lt\_k} ].\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{inversion} \coqdocvar{t'\_le\_s'} \coqdockw{as} [ \coqdocvar{t'{}'} \coqdocvar{s'{}'} \coqdocvar{t'\_eq\_s'} \ensuremath{|} \coqdocvar{t'{}'} \coqdocvar{s'{}'} \coqdocvar{t'\_lt\_s'}]; \coqdoctac{clear} \coqdocvar{t'\_le\_s'}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{Subterm} \coqdocvar{bb} \coqdocvar{f'} \coqdocvar{l'} \coqdocvar{tj} \coqdocvar{s'}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{apply} \coqdocvar{rpo\_subterm\_equiv} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{Subterm} \coqdocvar{bb} \coqdocvar{f'} \coqdocvar{l'} \coqdocvar{tj} \coqdocvar{s'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{s'}, \coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{k'\_lt\_k} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{P1} \coqdocvar{P2} \coqdocvar{H'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{tj\_mem\_l} := \coqdocvar{in\_impl\_mem} \coqdocvar{equiv} \coqdocvar{Eq} \coqdocvar{tj} \coqdocvar{l} \coqdocvar{tj\_in\_l}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{tj} \coqdocvar{P1}) \coqdoctac{in} \coqdocvar{tj\_mem\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{tj\_mem\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{tj\_mem\_l} \coqdockw{as} [\coqdocvar{tj\_mem\_ls} \ensuremath{|} \coqdocvar{tj\_mem\_llc}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H'} \coqdocvar{\_} \coqdocvar{tj\_mem\_ls}) \coqdockw{as} [\coqdocvar{a'} [\coqdocvar{a'\_mem\_a\_lg} \coqdocvar{tj\_lt\_a'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{Subterm} \coqdocvar{bb} \coqdocvar{g} \coqdocvar{k} \coqdocvar{tj} \coqdocvar{a'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{a'} \coqdocvar{P2}); \coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{Subterm} \coqdocvar{bb} \coqdocvar{g} \coqdocvar{k} \coqdocvar{tj} \coqdocvar{tj}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{tj} \coqdocvar{P2}).\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_subterm\_mem} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) \coqdocvar{s} \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{tj}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{tj} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{tj} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{f} \coqdocvar{l} \coqdocvar{fl\_lt\_s} \coqdocvar{tj} \coqdocvar{tj\_mem\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{tj\_mem\_l}) \coqdockw{as} [\coqdocvar{tj'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{tj\_eq\_tj'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{tj\_eq\_tj'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2}  \coqdocvar{\_} \coqdocvar{tj\_eq\_tj'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_subterm} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l}; \coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Add} \coqdocvar{Relation} \coqdocvar{term} \coqdocvar{equiv} \coqdoceol
\coqdocindent{1.00em}
\coqdoctac{reflexivity} \coqdocvar{proved} \coqdoctac{by} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{symmetry} \coqdocvar{proved} \coqdoctac{by} (\coqdocvar{Relation\_Definitions.equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{transitivity} \coqdocvar{proved} \coqdoctac{by} (\coqdocvar{Relation\_Definitions.equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{as} \coqdocvar{EQA}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Add} \coqdocvar{Relation} (\coqdocvar{list} \coqdocvar{term}) (\coqdocvar{permut0} \coqdocvar{equiv}) \coqdoceol
\coqdocindent{1.00em}
\coqdoctac{reflexivity} \coqdocvar{proved} \coqdoctac{by} (\coqdocvar{permut0\_refl} \coqdocvar{equiv\_equiv}) \coqdoceol
\coqdocindent{1.00em}
\coqdoctac{symmetry} \coqdocvar{proved} \coqdoctac{by} (\coqdocvar{permut0\_sym} \coqdocvar{equiv\_equiv}) \coqdoceol
\coqdocindent{2.00em}
\coqdoctac{transitivity} \coqdocvar{proved} \coqdoctac{by} (\coqdocvar{permut0\_trans} \coqdocvar{equiv\_equiv})\coqdoceol
\coqdocindent{1.00em}
\coqdockw{as} \coqdocvar{LP}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Add} \coqdocvar{Morphism} (\coqdocvar{mem} \coqdocvar{equiv})\coqdoceol
\coqdocindent{1.00em}
\coqdockw{with} \coqdocvar{signature} \coqdocvar{equiv} ==> \coqdocvar{permut0} \coqdocvar{equiv} ==> \coqdocvar{iff}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{as} \coqdocvar{mem\_morph2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{exact} (\coqdocvar{mem\_morph2} \coqdocvar{equiv\_equiv}).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocindent{0.50em}
\coqdockw{Add} \coqdocvar{Morphism} (\coqdocvar{List.app} (\coqdocvar{A}:=\coqdocvar{term})) \coqdoceol
\coqdocindent{4.00em}
\coqdockw{with} \coqdocvar{signature} \coqdocvar{permut0} \coqdocvar{equiv} ==> \coqdocvar{permut0} \coqdocvar{equiv} ==> \coqdocvar{permut0} \coqdocvar{equiv}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{as} \coqdocvar{app\_morph}.\coqdoceol
\coqdocindent{1.50em}
\coqdoctac{exact} (\coqdocvar{app\_morph} \coqdocvar{equiv\_equiv}).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocindent{0.50em}
\coqdockw{Add} \coqdocvar{Morphism} (\coqdocvar{List.cons} (\coqdocvar{A}:=\coqdocvar{term})) \coqdoceol
\coqdocindent{4.00em}
\coqdockw{with} \coqdocvar{signature} \coqdocvar{equiv} ==> \coqdocvar{permut0} \coqdocvar{equiv} ==> \coqdocvar{permut0} \coqdocvar{equiv}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{as} \coqdocvar{add\_A\_morph}.\coqdoceol
\coqdocindent{1.50em}
\coqdoctac{exact} (\coqdocvar{add\_A\_morph} \coqdocvar{equiv\_equiv}).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_trans} : \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{t} \coqdocvar{s}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow}  \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{t} \coqdocvar{s};\coqdoceol
\coqdocnoindent
\coqdoctac{cut} (\coqdockw{\ensuremath{\forall}} \coqdocvar{triple} : \coqdocvar{term} \ensuremath{\times} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term}),\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{triple} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} (\coqdocvar{s},(\coqdocvar{t},\coqdocvar{u})) \ensuremath{\Rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{s}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H} \coqdocvar{u\_lt\_t} \coqdocvar{t\_lt\_s}; \coqdoctac{apply} (\coqdocvar{H} (\coqdocvar{s},(\coqdocvar{t},\coqdocvar{u}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{s} \coqdocvar{t} \coqdocvar{u}; \coqdoctac{intro} \coqdocvar{triple}; \coqdoctac{pattern} \coqdocvar{triple}; \coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{well\_founded\_ind} \coqdocvar{wf\_size3} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{triple}); \coqdoctac{clear} \coqdocvar{triple}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [[\coqdocvar{v} \ensuremath{|} \coqdocvar{f} \coqdocvar{l}] [\coqdocvar{t} \coqdocvar{u}]] \coqdocvar{IH}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t\_lt\_v}; \coqdoctac{inversion} \coqdocvar{t\_lt\_v}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t\_lt\_fl} \coqdocvar{u\_lt\_t};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t\_lt\_fl} \coqdockw{as} [ \coqdocvar{f'{}'} \coqdocvar{l'} \coqdocvar{s'} \coqdocvar{t'} \coqdocvar{t'\_in\_l'} \coqdocvar{t\_le\_t'}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'{}'} \coqdocvar{f'} \coqdocvar{k'{}'} \coqdocvar{l'} \coqdocvar{f'\_prec\_f} \coqdocvar{H'{}'}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'{}'} \coqdocvar{g'{}'} \coqdocvar{k'{}'} \coqdocvar{l'} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f'{}'\_eq\_g'{}'} \coqdocvar{L} \coqdocvar{l'\_lt\_l} \coqdocvar{H} \coqdocvar{H1} \coqdocvar{H2} \coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'{}'} \coqdocvar{g'{}'} \coqdocvar{k'{}'} \coqdocvar{l'} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f'{}'\_eq\_g'{}'} \coqdocvar{l'\_lt\_l} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{t'}; \coqdoctac{trivial}; \coqdoctac{apply} \coqdocvar{Lt};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t\_le\_t'} \coqdockw{as} [\coqdocvar{t'{}'} \coqdocvar{t'{}'{}'} \coqdocvar{t\_eq\_t'} \ensuremath{|} \coqdocvar{t'{}'} \coqdocvar{t'{}'{}'} \coqdocvar{t\_lt\_t'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1}  \coqdocvar{\_} \coqdocvar{t\_eq\_t'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{t'},(\coqdocvar{t},\coqdocvar{u}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex1\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{u\_lt\_t} \coqdockw{as} [ \coqdocvar{f'{}'} \coqdocvar{l'{}'} \coqdocvar{s'} \coqdocvar{t'} \coqdocvar{t'\_in\_l'} \coqdocvar{u\_le\_t'}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{g'{}'} \coqdocvar{f'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{f'{}'\_prec\_f'{}'} \coqdocvar{H'{}'{}'}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{g'{}'} \coqdocvar{g'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sf'{}'} \coqdocvar{g'{}'\_eq\_g'} \coqdocvar{L} \coqdocvar{l'{}'\_lt\_l'} \coqdocvar{H} \coqdocvar{H1} \coqdocvar{H2} \coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{g'{}'} \coqdocvar{g'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sf'{}'} \coqdocvar{g'{}'\_eq\_g'} \coqdocvar{l'{}'\_lt\_l'} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{u\_le\_t'} \coqdockw{as} [\coqdocvar{t'{}'} \coqdocvar{t'{}'{}'} \coqdocvar{u\_eq\_t'} \ensuremath{|} \coqdocvar{t'{}'} \coqdocvar{t'{}'{}'} \coqdocvar{u\_lt\_t'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_t'}); \coqdoctac{trivial}; \coqdoctac{apply} \coqdocvar{H'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l},(\coqdocvar{t'},\coqdocvar{u}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex2\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_gt}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_transitive} \coqdockw{with} \coqdocvar{f'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l'{}'}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, (\coqdocvar{Term} \coqdocvar{f'} \coqdocvar{l'}, \coqdocvar{u}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex3\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'{}'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_gt}. \coqdoctac{apply} \coqdocvar{prec\_eq\_prec2} \coqdockw{with} \coqdocvar{f'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_sym}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l'{}'}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, (\coqdocvar{Term} \coqdocvar{f'} \coqdocvar{l'}, \coqdocvar{u}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex3\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_gt}. \coqdoctac{apply} \coqdocvar{prec\_eq\_prec2} \coqdockw{with} \coqdocvar{f'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_sym}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l'{}'}. \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, (\coqdocvar{Term} \coqdocvar{f'} \coqdocvar{l'}, \coqdocvar{u}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex3\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_subterm\_mem} \coqdockw{with} \coqdocvar{g'{}'} \coqdocvar{l'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{u\_lt\_t} \coqdockw{as} [ \coqdocvar{f'{}'{}'} \coqdocvar{l'{}'} \coqdocvar{s'} \coqdocvar{t'} \coqdocvar{t'\_in\_l'} \coqdocvar{u\_le\_t'}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{g'{}'} \coqdocvar{f'{}'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{f'{}'\_prec\_f'} \coqdocvar{H'{}'{}'}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{g'{}'} \coqdocvar{f'{}'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sg'} \coqdocvar{f\_eq\_g'} \coqdocvar{L'} \coqdocvar{l'{}'\_lt\_l'} \coqdocvar{H'} \coqdocvar{H1} \coqdocvar{H2} \coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{g'{}'} \coqdocvar{f'{}'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sg'} \coqdocvar{f\_eq\_g'} \coqdocvar{l'{}'\_lt\_l'} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{u\_le\_t'} \coqdockw{as} [\coqdocvar{t'{}'} \coqdocvar{t'{}'{}'} \coqdocvar{u\_eq\_t'} \ensuremath{|} \coqdocvar{t'{}'} \coqdocvar{t'{}'{}'} \coqdocvar{u\_lt\_t'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_subterm\_mem} \coqdockw{with} \coqdocvar{f'{}'} \coqdocvar{l'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, (\coqdocvar{t'}, \coqdocvar{u}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex2\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_gt}. \coqdoctac{apply} \coqdocvar{prec\_eq\_prec1} \coqdockw{with} \coqdocvar{f'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l'{}'}. \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, (\coqdocvar{Term} \coqdocvar{f'{}'} \coqdocvar{l'}, \coqdocvar{u}))).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex3\_mem}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'{}'{}'}. \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_lex}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_transitive} \coqdockw{with} \coqdocvar{f'{}'}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{L} \coqdockw{as} [\coqdocvar{L} \ensuremath{|} [\coqdocvar{L1} \coqdocvar{L2}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{L}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{L'} \coqdockw{as} [\coqdocvar{L'} \ensuremath{|} [\coqdocvar{L1'} \coqdocvar{L2'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{L'}; \coqdoctac{right}; \coqdoctac{split}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{split}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{l'\_lt\_l} \coqdocvar{l'{}'\_lt\_l'} \coqdocvar{IH}; \coqdoctac{clear} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{l'\_lt\_l} \coqdocvar{l'{}'\_lt\_l'} \coqdocvar{IH} \coqdocvar{H} \coqdocvar{H'} \coqdocvar{t\_lt\_fl} \coqdocvar{u\_lt\_t} \coqdocvar{L} \coqdocvar{L'};\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{l}]; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{l'\_lt\_l} \coqdocvar{l'{}'\_lt\_l'} \coqdocvar{IH}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l'\_lt\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l'\_lt\_l} \coqdockw{as} [ \coqdocvar{t} \coqdocvar{s'} \coqdocvar{k'} \coqdocvar{k} \coqdocvar{t\_lt\_s}  \ensuremath{|} \coqdocvar{t} \coqdocvar{s'} \coqdocvar{k'} \coqdocvar{k} \coqdocvar{t\_eq\_s} \coqdocvar{k'\_lt\_k} \ensuremath{|} \coqdocvar{t} \coqdocvar{k}];\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l'{}'\_lt\_l'} \coqdockw{as} [ \coqdocvar{u} \coqdocvar{t'} \coqdocvar{k'{}'} \coqdocvar{h'} \coqdocvar{u\_lt\_t} \ensuremath{|} \coqdocvar{u} \coqdocvar{t'} \coqdocvar{k'{}'} \coqdocvar{h'} \coqdocvar{u\_eq\_t} \coqdocvar{k'{}'\_lt\_k'} \ensuremath{|} \coqdocvar{u} \coqdocvar{k1}].\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{injection} \coqdocvar{H3}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{List\_gt}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{s},(\coqdocvar{t},\coqdocvar{u}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex1}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{injection} \coqdocvar{H3}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{List\_gt}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_t}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{injection} \coqdocvar{H3}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{List\_gt}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{t\_eq\_s}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{injection} \coqdocvar{H3}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{List\_eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl} \coqdockw{with} \coqdocvar{k'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IH};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{o\_size3\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{k'}, \coqdocvar{Term} \coqdocvar{f} \coqdocvar{k'{}'})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex1\_bis}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{discriminate} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{discriminate} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{discriminate} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l'{}'}. \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, (\coqdocvar{Term} \coqdocvar{f'{}'} \coqdocvar{l'}, \coqdocvar{u}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex3\_mem}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Sf} \coqdoctac{in} \coqdocvar{Sg'}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{u\_lt\_t} \coqdockw{as} [ \coqdocvar{f'{}'{}'} \coqdocvar{l'{}'} \coqdocvar{s'} \coqdocvar{t'} \coqdocvar{t'\_in\_l'} \coqdocvar{u\_le\_t'}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{g'{}'} \coqdocvar{f'{}'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{f'{}'\_prec\_f'} \coqdocvar{H'{}'{}'}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{g'{}'} \coqdocvar{f'{}'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sf'{}'{}'} \coqdocvar{Seq\_g'{}'\_f'{}'{}'} \coqdocvar{L} \coqdocvar{l'{}'\_lt\_l'} \coqdocvar{H} \coqdocvar{H1} \coqdocvar{H2} \coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{g'{}'} \coqdocvar{f'{}'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sf'{}'{}'} \coqdocvar{Seq\_g'{}'\_f'{}'{}'} \coqdocvar{l'{}'\_lt\_l'} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{u\_le\_t'} \coqdockw{as} [\coqdocvar{t'{}'} \coqdocvar{t'{}'{}'} \coqdocvar{u\_eq\_t'} \ensuremath{|} \coqdocvar{t'{}'} \coqdocvar{t'{}'{}'} \coqdocvar{u\_lt\_t'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_subterm\_mem} \coqdockw{with} \coqdocvar{f'{}'} \coqdocvar{l'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, (\coqdocvar{t'}, \coqdocvar{u}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex2\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_subterm\_mem} \coqdockw{with} \coqdocvar{f'{}'} \coqdocvar{l'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_gt}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_prec1} \coqdockw{with} \coqdocvar{f'{}'}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l'{}'}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, (\coqdocvar{Term} \coqdocvar{f'{}'} \coqdocvar{l'}, \coqdocvar{u}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex3\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'{}'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Sf} \coqdoctac{in} \coqdocvar{Sf'{}'{}'}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_mul}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_transitive} \coqdockw{with} \coqdocvar{f'{}'}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l'\_lt\_l} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{P'} \coqdocvar{P} \coqdocvar{ls\_lt\_alg}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l'{}'\_lt\_l'} \coqdockw{as} [\coqdocvar{a'} \coqdocvar{lg'} \coqdocvar{ls'} \coqdocvar{lc'} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{Q'} \coqdocvar{Q} \coqdocvar{ls'\_lt\_alg'}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P'} \coqdoctac{in} \coqdocvar{Q}; \coqdoctac{rewrite} \coqdocvar{app\_comm\_cons} \coqdoctac{in} \coqdocvar{Q}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (@\coqdocvar{ac\_syntactic} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{Q}) \coqdockw{as} [\coqdocvar{k1} [\coqdocvar{k2} [\coqdocvar{k3} [\coqdocvar{k4} [\coqdocvar{P1} [\coqdocvar{P2} [\coqdocvar{P3} \coqdocvar{P4}]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} \coqdocvar{a} (\coqdocvar{lg} ++ \coqdocvar{k2}) (\coqdocvar{ls'} ++ \coqdocvar{k3}) \coqdocvar{k1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Q'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ass\_app}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{list\_permut0\_app\_app}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons};[|\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ass\_app}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{list\_permut0\_app\_app}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b\_mem\_ls'\_k3}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{b\_mem\_ls'\_k3}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{b\_mem\_ls'\_k3} \coqdockw{as} [\coqdocvar{b\_mem\_ls'} \ensuremath{|} \coqdocvar{b\_mem\_k3}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls'\_lt\_alg'}  \coqdocvar{\_} \coqdocvar{b\_mem\_ls'}) \coqdockw{as} [\coqdocvar{a'{}'} [\coqdocvar{a'{}'\_in\_a'lg'} \coqdocvar{b\_lt\_a'{}'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{a'{}'} \coqdocvar{P4}) \coqdoctac{in} \coqdocvar{a'{}'\_in\_a'lg'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{a'{}'\_in\_a'lg'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{a'{}'\_in\_a'lg'} \coqdockw{as} [\coqdocvar{a'{}'\_mem\_k2} \ensuremath{|} \coqdocvar{a'{}'\_mem\_k4}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'{}'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{a'{}'}) \coqdockw{as} [\coqdocvar{a3} [\coqdocvar{a3\_in\_alg} \coqdocvar{a'{}'\_lt\_a3}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{a'{}'} \coqdocvar{P2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a3}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{a3},(\coqdocvar{a'{}'},\coqdocvar{b}))); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size3\_lex1\_mem}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{a3} \coqdocvar{P}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{b}) \coqdockw{as} [\coqdocvar{a'{}'} [\coqdocvar{a'{}'\_in\_alg} \coqdocvar{b\_lt\_a'{}'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{b} \coqdocvar{P2}); \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'{}'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_remove\_equiv\_aux} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{s} \coqdocvar{s'}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} (\coqdocvar{s} :: \coqdocvar{l}) \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{False}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{11.00em}
\coqdocvar{equiv} \coqdocvar{s} \coqdocvar{s'} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{bb} (\coqdocvar{s} :: \coqdocvar{l}) (\coqdocvar{s'} :: \coqdocvar{l'}) \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{l} \coqdocvar{l'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{s} \coqdocvar{s'} \coqdocvar{Antirefl} \coqdocvar{s\_eq\_s'} \coqdocvar{sl\_lt\_s'l'};  \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{sl\_lt\_s'l'} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{k'} \coqdocvar{k} \coqdocvar{P} \coqdocvar{P'} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{s\_mem\_ls\_lc} : \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} (\coqdocvar{ls} ++ \coqdocvar{lc})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{s} \coqdocvar{P}); \coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{s\_mem\_ls\_lc}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{s\_mem\_ls\_lc} \coqdockw{as} [\coqdocvar{s\_mem\_ls} \ensuremath{|} \coqdocvar{s\_mem\_lc}].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{s'\_mem\_alg\_lc} : \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s'} (\coqdocvar{a} :: \coqdocvar{lg} ++ \coqdocvar{lc})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{s'} \coqdocvar{P'}); \coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons} \coqdoctac{in} \coqdocvar{s'\_mem\_alg\_lc}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{s'\_mem\_alg\_lc}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{s'\_mem\_alg\_lc} \coqdockw{as} [\coqdocvar{s'\_mem\_alg} \ensuremath{|} \coqdocvar{s'\_mem\_lc}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{lg} \coqdockw{as} [ \ensuremath{|} \coqdocvar{g} \coqdocvar{lg}].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{s'\_eq\_a} : \coqdocvar{equiv} \coqdocvar{s'} \coqdocvar{a}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{s'\_mem\_alg}; \coqdoctac{trivial}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{\_} \coqdocvar{s\_mem\_ls}) \coqdockw{as} [\coqdocvar{a'} [[\coqdocvar{a\_eq\_a'} \ensuremath{|} \coqdocvar{a'\_mem\_nil}] \coqdocvar{b\_lt\_a'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Antirefl} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{s\_eq\_s'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{s'\_eq\_a}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a\_eq\_a'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{s'\_mem\_alg}) \coqdockw{as} [\coqdocvar{u'} [\coqdocvar{alg'} [\coqdocvar{alg'{}'} [\coqdocvar{s'\_eq\_u'} [\coqdocvar{H} \coqdocvar{\_}]]]]]; \coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{s'\_eq\_u'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{P'{}'} : \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l'} ((\coqdocvar{alg'} ++ \coqdocvar{alg'{}'}) ++ \coqdocvar{lc})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons} \coqdoctac{in} \coqdocvar{P'}; \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{P'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ass\_app} \coqdoctac{in} \coqdocvar{P'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{P'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ass\_app}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside} \coqdoctac{in} \coqdocvar{P'}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{s\_mem\_ls}) \coqdockw{as} [\coqdocvar{u} [\coqdocvar{ls'} [\coqdocvar{ls'{}'} [\coqdocvar{s\_eq\_u} [\coqdocvar{H'} \coqdocvar{\_}]]]]]; \coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{s\_eq\_u}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H'}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{ls'ls'{}'\_lt\_alg'alg'{}'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{b},\coqdoceol
\coqdocindent{6.00em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} (\coqdocvar{ls'} ++ \coqdocvar{ls'{}'}) \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a'} (\coqdocvar{alg'} ++ \coqdocvar{alg'{}'}) \ensuremath{\land} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{b} \coqdocvar{a'}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b\_in\_ls'ls'{}'}; \coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{b}) \coqdockw{as} [\coqdocvar{a'} [\coqdocvar{a'\_mem\_aglg} \coqdocvar{b\_lt\_a'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{mem\_insert}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{a'\_mem\_aglg}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{a'\_mem\_aglg}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{a'\_mem\_aglg} \coqdockw{as} [\coqdocvar{a'\_mem\_alg'} \ensuremath{|} [\coqdocvar{u'\_eq\_a'} \ensuremath{|} \coqdocvar{a'\_mem\_alg'{}'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{a'}) \coqdockw{as} [\coqdocvar{a'{}'} [\coqdocvar{a'{}'\_mem\_aglg} \coqdocvar{a'\_lt\_a'{}'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{left}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{u'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{s}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{s'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'{}'}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{diff\_mem\_remove} \coqdockw{with} \coqdocvar{u'}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{a'{}'\_eq\_u'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{u} (\coqdocvar{s} :: \coqdocvar{l})) \coqdockw{as} [\coqdocvar{u'{}'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{u\_eq\_u'{}'} [\coqdocvar{H'} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{u\_eq\_u'{}'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Antirefl} \coqdocvar{u'{}'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{u'{}'} \coqdocvar{P}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u'{}'\_eq\_u'} : \coqdocvar{equiv} \coqdocvar{u'{}'} \coqdocvar{u'}).\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{s'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{s}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{u}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u'{}'\_eq\_u'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u'\_eq\_a'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{u'{}'\_eq\_u'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a'{}'\_eq\_u'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} \coqdocvar{a'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{L} : \coqdocvar{length} (\coqdocvar{alg'} ++ \coqdocvar{alg'{}'}) = \coqdocvar{S} (\coqdocvar{length} \coqdocvar{lg})).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{L'} := \coqdoctac{f\_equal} (\coqdockw{fun} \coqdocvar{l} \ensuremath{\Rightarrow} \coqdocvar{length} \coqdocvar{l}) \coqdocvar{H}).\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{L'}; \coqdoctac{rewrite} \coqdocvar{length\_app} \coqdoctac{in} \coqdocvar{L'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{L'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm} \coqdoctac{in} \coqdocvar{L'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{L'}; \coqdoctac{rewrite} \coqdocvar{plus\_comm} \coqdoctac{in} \coqdocvar{L'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{length\_app} \coqdoctac{in} \coqdocvar{L'}; \coqdoctac{injection} \coqdocvar{L'}; \coqdoctac{intro} \coqdocvar{L'{}'}; \coqdoctac{symmetry}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{alg'} ++ \coqdocvar{alg'{}'}) \coqdockw{as} [ \ensuremath{|} \coqdocvar{a'} \coqdocvar{lg'}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} \coqdocvar{a'} \coqdocvar{lg'} (\coqdocvar{ls'} ++ \coqdocvar{ls'{}'}) \coqdocvar{lc}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ass\_app} \coqdoctac{in} \coqdocvar{P}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{P}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside} \coqdoctac{in} \coqdocvar{P}; \coqdoctac{trivial};[|\coqdoctac{apply} \coqdocvar{equiv\_equiv}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ass\_app}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{s'\_mem\_lc}) \coqdockw{as} [\coqdocvar{s'{}'} [\coqdocvar{lc'} [\coqdocvar{lc'{}'} [\coqdocvar{s\_eq\_s'{}'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{s\_eq\_s'{}'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} (\coqdocvar{lc'} ++ \coqdocvar{lc'{}'})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{P}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{ass\_app} \coqdoctac{in} \coqdocvar{P}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside} \coqdoctac{in} \coqdocvar{P}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{ass\_app}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{s'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{P'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons} \coqdoctac{in} \coqdocvar{P'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{ass\_app} \coqdoctac{in} \coqdocvar{P'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside} \coqdoctac{in} \coqdocvar{P'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \coqdocvar{ass\_app}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{s\_mem\_lc}) \coqdockw{as} [\coqdocvar{s'{}'} [\coqdocvar{lc'} [\coqdocvar{lc'{}'} [\coqdocvar{s\_eq\_s'{}'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{s\_eq\_s'{}'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} (\coqdocvar{lc'} ++ \coqdocvar{lc'{}'})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{P}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{ass\_app} \coqdoctac{in} \coqdocvar{P}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside} \coqdoctac{in} \coqdocvar{P}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{ass\_app}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{P'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons} \coqdoctac{in} \coqdocvar{P'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{ass\_app} \coqdoctac{in} \coqdocvar{P'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside} \coqdoctac{in} \coqdocvar{P'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \coqdocvar{ass\_app}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{s}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_antirefl} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{False}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{s}; \coqdoctac{pattern} \coqdocvar{s}; \coqdoctac{apply} \coqdocvar{term\_rec3\_mem}; \coqdoctac{clear} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v} \coqdocvar{v\_lt\_v}; \coqdoctac{inversion} \coqdocvar{v\_lt\_v}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{l} \coqdocvar{IHl} \coqdocvar{t\_lt\_t};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t\_lt\_t}  \coqdockw{as} [ \coqdocvar{f'} \coqdocvar{l'} \coqdocvar{s'{}'} \coqdocvar{s'} \coqdocvar{s'\_mem\_l} \coqdocvar{s\_le\_s'}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f'{}'} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{f\_prec\_f} \coqdocvar{H'} \coqdocvar{H1} \coqdocvar{H2}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f\_eq\_g} \coqdocvar{L} \coqdocvar{l\_lt\_l} \coqdocvar{H} \coqdocvar{H1} \coqdocvar{H2}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f\_eq\_g} \coqdocvar{l\_lt\_l} ]; \coqdoctac{clear} \coqdocvar{t\_lt\_t}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IHl} \coqdocvar{s'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{s\_le\_s'} \coqdockw{as} [\coqdocvar{u} \coqdocvar{u'} \coqdocvar{s\_eq\_s'} \ensuremath{|} \coqdocvar{u} \coqdocvar{u'} \coqdocvar{s\_lt\_s'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{s\_eq\_s'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{s'}; \coqdoctac{trivial}; \coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{s'}; \coqdoctac{trivial}; \coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec}) \coqdockw{with} \coqdocvar{f}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [| \coqdocvar{t} \coqdocvar{l}]. \coqdoctac{inversion} \coqdocvar{l\_lt\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l\_lt\_l} \coqdockw{as} [ \coqdocvar{s} \coqdocvar{t'} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{s\_lt\_t} \ensuremath{|} \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{s} \coqdocvar{t'} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{s\_eq\_t} \coqdocvar{l'\_lt\_l'{}'} \ensuremath{|} \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{s} \coqdocvar{l'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl} \coqdockw{with} \coqdocvar{t}; \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl0}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{s\_in\_l}; \coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{l}].\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l\_lt\_l} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{L} := \coqdocvar{permut\_length} \coqdocvar{H}); \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl0}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t\_mem\_l}; \coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_mul\_remove\_equiv\_aux} \coqdockw{with} \coqdocvar{s} \coqdocvar{s}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_closure} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \coqdocvar{u}, \coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo}\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{bb} \coqdocvar{u} \coqdocvar{s}) \ensuremath{\land}\coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{False}) \ensuremath{\land}\coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{False}) \ensuremath{\land}\coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \coqdocvar{u}; \coqdoctac{repeat} \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} (@\coqdocvar{rpo\_trans} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{t} \coqdocvar{s}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{bb} \coqdocvar{s}); \coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} \coqdocvar{t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_antirefl}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s\_le\_t} \coqdocvar{t\_le\_s};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{s\_le\_t} \coqdockw{as} [\coqdocvar{s} \coqdocvar{t} \coqdocvar{s\_eq\_t} \ensuremath{|} \coqdocvar{s} \coqdocvar{t} \coqdocvar{s\_lt\_t}]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t\_le\_s} \coqdockw{as} [\coqdocvar{t} \coqdocvar{s} \coqdocvar{t\_eq\_s} \ensuremath{|} \coqdocvar{t} \coqdocvar{s} \coqdocvar{t\_lt\_s}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} \coqdocvar{False}; [\coqdoctac{idtac} \ensuremath{|} \coqdocvar{contradiction}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{bb} \coqdocvar{s}); \coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} \coqdocvar{t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{Well-foundedness of rpo.}

\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_acc\_rpo} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{t'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{t\_eq\_t'} \coqdocvar{Acc\_t}; \coqdoctac{apply} \coqdocvar{Acc\_intro}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{s}; \coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{t\_eq\_t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{Acc\_t} \coqdockw{as} [\coqdocvar{H}]; \coqdoctac{apply} (\coqdocvar{H} \coqdocvar{s}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{rpo\_lex\_rest} (\coqdocvar{bb} \coqdocvar{bb'} : \coqdocvar{nat}) : \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Rpo\_lex\_rest} : \coqdoceol
\coqdocindent{2.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{l} \coqdocvar{l'}, (\coqdocvar{length} \coqdocvar{l} = \coqdocvar{length} \coqdocvar{l'} \ensuremath{\lor} (\coqdocvar{length} \coqdocvar{l'} \ensuremath{\le} \coqdocvar{bb} \ensuremath{\land} \coqdocvar{length} \coqdocvar{l} \ensuremath{\le} \coqdocvar{bb})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb'}) \coqdocvar{s}) \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb'}) \coqdocvar{s}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{rpo\_lex} \coqdocvar{bb'} \coqdocvar{l'} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{rpo\_lex\_rest} \coqdocvar{bb} \coqdocvar{bb'} \coqdocvar{l'} \coqdocvar{l}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{wf\_rpo\_lex\_rest} : \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{bb'}, \coqdocvar{well\_founded} (\coqdocvar{rpo\_lex\_rest} \coqdocvar{bb} \coqdocvar{bb'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{bb}; \coqdoctac{unfold} \coqdocvar{well\_founded}; \coqdoctac{induction} \coqdocvar{bb}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb'} \coqdocvar{l}; \coqdocvar{revert} \coqdocvar{bb'}; \coqdoctac{pattern} \coqdocvar{l}; \coqdoctac{apply} \coqdocvar{list\_rec2}; \coqdoctac{clear} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{n} \coqdockw{as} [ \ensuremath{|} \coqdocvar{n}]; \coqdoctac{intros} [ \ensuremath{|} \coqdocvar{a} \coqdocvar{l}] \coqdocvar{L} \coqdocvar{bb'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k'} \coqdocvar{k'{}'} \coqdocvar{L'} \coqdocvar{Acc\_k} \coqdocvar{Acc\_k'} \coqdocvar{H'} \coqdocvar{H1} \coqdocvar{H2}]; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{subst}; \coqdoctac{inversion} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k'} \coqdocvar{k'{}'} \coqdocvar{L'} \coqdocvar{Acc\_k} \coqdocvar{Acc\_k'} \coqdocvar{H'} \coqdocvar{H1} \coqdocvar{H2}]; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{subst}; \coqdoctac{inversion} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k'} \coqdocvar{k'{}'} \coqdocvar{L'} \coqdocvar{Acc\_k} \coqdocvar{Acc\_k'} \coqdocvar{H'} \coqdocvar{H1} \coqdocvar{H2}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Acc\_a} : \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb'}) \coqdocvar{a}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_k}; \coqdoctac{left}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Acc\_l'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} : \coqdocvar{term}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb'}) \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Acc\_k}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_inv} \coqdockw{with} (\coqdocvar{a} :: \coqdocvar{l}); [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{assumption}].\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{k} \coqdocvar{H} \coqdocvar{L'} \coqdocvar{Acc\_k'} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} -\coqdocvar{IHn} \coqdocvar{Acc\_a} \coqdocvar{L} \coqdocvar{Acc\_l'}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{L}; \coqdoctac{generalize} (\coqdocvar{le\_S\_n} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}); \coqdoctac{clear} \coqdocvar{L}; \coqdoctac{intro} \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{l} \coqdocvar{L} \coqdocvar{Acc\_l'}; \coqdoctac{induction} \coqdocvar{Acc\_a} \coqdockw{as} [\coqdocvar{a} \coqdocvar{Acc\_a} \coqdocvar{IHa}]; \coqdoctac{intros} \coqdocvar{l} \coqdocvar{L} \coqdocvar{Acc\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Acc\_l'} := \coqdocvar{IHn} \coqdocvar{\_} \coqdocvar{L} \coqdocvar{bb'}).\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{Acc\_l'} \coqdockw{as} [\coqdocvar{l} \coqdocvar{Acc\_l'} \coqdocvar{IHl}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [ \coqdocvar{k} \coqdocvar{k'} \coqdocvar{L'} \coqdocvar{Acc\_al} \coqdocvar{Acc\_l'{}'} \coqdocvar{H'} \coqdocvar{H1} \coqdocvar{H2}]; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{L'} \coqdockw{as} [\coqdocvar{L'} \ensuremath{|} [\coqdocvar{L1} \coqdocvar{L2}]]; [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{inversion} \coqdocvar{L2}].\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{u} \coqdocvar{s'} \coqdocvar{k'} \coqdocvar{k'{}'} \coqdocvar{u\_lt\_s} \ensuremath{|} \coqdocvar{s'} \coqdocvar{s'{}'} \coqdocvar{k'} \coqdocvar{k'{}'} \coqdocvar{s'\_eq\_s} \coqdocvar{k'\_lt\_l} \coqdocvar{H1} \coqdocvar{H2} \ensuremath{|} \coqdocvar{u} \coqdocvar{k'}]; \coqdoctac{clear} \coqdocvar{H'}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHa}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{injection} \coqdocvar{L'}; \coqdoctac{clear} \coqdocvar{L'}; \coqdoctac{intro} \coqdocvar{L'}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{L'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Acc\_l'{}'}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{k'{}'} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{Acc\_inv} \coqdockw{with} (\coqdocvar{a} :: \coqdocvar{k'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}.\coqdoceol
\coqdocnoindent
\coqdoctac{constructor}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{injection} \coqdocvar{L'}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Acc\_l'{}'}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{injection} \coqdocvar{L'}; \coqdoctac{clear} \coqdocvar{L'}; \coqdoctac{intro} \coqdocvar{L'}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{L'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Acc\_l'{}'}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion}  \coqdocvar{H'} \coqdockw{as} [\coqdocvar{k1} \coqdocvar{k1'} \coqdocvar{L'{}'} \coqdocvar{Acc\_l1} \coqdocvar{Acc\_l1'} \coqdocvar{H1'} \coqdocvar{H1} \coqdocvar{H2}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{constructor}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{s} [\coqdocvar{s\_eq\_a} \ensuremath{|} \coqdocvar{s\_in\_k'}]; [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Acc\_l1}; \coqdoctac{right}; \coqdoctac{assumption}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Acc\_inv} \coqdockw{with} \coqdocvar{a}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{apply} \coqdocvar{Acc\_a}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{s\_eq\_a}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H1'} \coqdockw{as} [\coqdocvar{u} \coqdocvar{s'{}'} \coqdocvar{k1'} \coqdocvar{k1'{}'} \coqdocvar{u\_lt\_s} \ensuremath{|} \coqdocvar{s1'} \coqdocvar{s'{}'} \coqdocvar{k1'} \coqdocvar{k1'{}'} \coqdocvar{s'\_eq\_s1} \coqdocvar{k'\_lt\_l1} \coqdocvar{H1} \coqdocvar{H2} \ensuremath{|} \coqdocvar{u} \coqdocvar{k1'}]; \coqdoctac{clear} \coqdocvar{H1'}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{constructor} 1; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{s'\_eq\_s}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{constructor} 2; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{with} \coqdocvar{s'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{constructor} 3.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [ \coqdocvar{k} \coqdocvar{k'} \coqdocvar{L'{}'} \coqdocvar{Acc\_l1} \coqdocvar{Acc\_l1'} \coqdocvar{H'} \coqdocvar{H1} \coqdocvar{H2}]; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb'} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k'} \coqdocvar{k'{}'} \coqdocvar{L'} \coqdocvar{Acc\_k} \coqdocvar{Acc\_k'} \coqdocvar{H'} \coqdocvar{H1} \coqdocvar{H2}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a} \coqdocvar{l}].\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_inv} \coqdockw{with} (\coqdocvar{a} :: \coqdocvar{l}); [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{assumption}].\coqdoceol
\coqdocnoindent
\coqdoctac{clear} -\coqdocvar{IHbb} \coqdocvar{Acc\_k}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Acc\_a} : \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb'}) \coqdocvar{a}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_k}; \coqdoctac{left}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Acc\_l} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} : \coqdocvar{term}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb'}) \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Acc\_k}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{Acc\_l}; \coqdoctac{clear} \coqdocvar{Acc\_k}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{l}; \coqdoctac{induction} \coqdocvar{Acc\_a} \coqdockw{as} [\coqdocvar{a} \coqdocvar{Acc\_a} \coqdocvar{IHa}]; \coqdoctac{intros} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{pattern} \coqdocvar{l}; \coqdoctac{apply} (\coqdocvar{well\_founded\_ind} (\coqdocvar{IHbb} \coqdocvar{bb'})); \coqdoctac{clear} \coqdocvar{l}; \coqdoctac{intros} \coqdocvar{l} \coqdocvar{IHl} \coqdocvar{Acc\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [ \coqdocvar{k} \coqdocvar{k'} \coqdocvar{L} \coqdocvar{Acc\_al} \coqdocvar{Acc\_l'} \coqdocvar{H'} \coqdocvar{H1} \coqdocvar{H2}]; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{u} \coqdocvar{s'} \coqdocvar{k'} \coqdocvar{k'{}'} \coqdocvar{u\_lt\_s} \ensuremath{|} \coqdocvar{s'} \coqdocvar{s'{}'} \coqdocvar{k'} \coqdocvar{k'{}'} \coqdocvar{s'\_eq\_s} \coqdocvar{k'\_lt\_l} \coqdocvar{H1} \coqdocvar{H2} \ensuremath{|} \coqdocvar{u} \coqdocvar{k'}]; \coqdoctac{clear} \coqdocvar{H'}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHa}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Acc\_l'}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{k'{}'} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{Acc\_inv} \coqdockw{with} (\coqdocvar{a} :: \coqdocvar{k'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{constructor}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{L} \coqdockw{as} [\coqdocvar{L} \ensuremath{|} [\coqdocvar{L1} \coqdocvar{L2}]].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{injection} \coqdocvar{L}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{split}; \coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Acc\_al}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Acc\_l'}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_inv}; \coqdoctac{apply} \coqdocvar{Acc\_l'}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion}  \coqdocvar{H'} \coqdockw{as} [ \coqdocvar{k1} \coqdocvar{k1'} \coqdocvar{L'} \coqdocvar{Acc\_l1} \coqdocvar{Acc\_l1'} \coqdocvar{H1'} \coqdocvar{H1} \coqdocvar{H2}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{constructor}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{s} [\coqdocvar{s\_eq\_a} \ensuremath{|} \coqdocvar{s\_in\_k'}]; [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Acc\_l1}; \coqdoctac{right}; \coqdoctac{assumption}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Acc\_inv} \coqdockw{with} \coqdocvar{a}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{apply} \coqdocvar{Acc\_a}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{s\_eq\_a}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H1'} \coqdockw{as} [\coqdocvar{u} \coqdocvar{s'{}'} \coqdocvar{k1'} \coqdocvar{k1'{}'} \coqdocvar{u\_lt\_s} \ensuremath{|} \coqdocvar{s1'} \coqdocvar{s'{}'} \coqdocvar{k1'} \coqdocvar{k1'{}'} \coqdocvar{s'\_eq\_s1} \coqdocvar{k'\_lt\_l1} \coqdocvar{H1} \coqdocvar{H2} \ensuremath{|} \coqdocvar{u} \coqdocvar{k1'}]; \coqdoctac{clear} \coqdocvar{H1'}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{constructor} 1; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{s'\_eq\_s}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{constructor} 2; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{with} \coqdocvar{s'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{constructor} 3.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [ \coqdocvar{k} \coqdocvar{k'} \coqdocvar{L'} \coqdocvar{Acc\_l1} \coqdocvar{Acc\_l1'} \coqdocvar{H'} \coqdocvar{H1} \coqdocvar{H2}]; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Definition of a finer grain for multiset extension. \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{rpo\_mul\_step} (\coqdocvar{bb} : \coqdocvar{nat}) : \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{List\_mul\_step} : \coqdoceol
\coqdocindent{3.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l} \coqdocvar{l'},  \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l'} (\coqdocvar{ls} ++ \coqdocvar{lc}) \ensuremath{\rightarrow} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l} (\coqdocvar{a} :: \coqdocvar{lc}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{b}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{b} \coqdocvar{a}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{rpo\_mul\_step} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
The plain multiset extension is in the transitive closure of
the finer grain extension. \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_trans\_clos} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb}, \coqdocvar{inclusion} \coqdocvar{\_} (\coqdocvar{rpo\_mul} \coqdocvar{bb}) (\coqdocvar{clos\_trans} \coqdocvar{\_} (\coqdocvar{rpo\_mul\_step} \coqdocvar{bb})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{bb}; \coqdoctac{unfold} \coqdocvar{inclusion}; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{l} \coqdocvar{H}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{P'} \coqdocvar{P} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l'} \coqdocvar{l} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{P} \coqdocvar{P'} \coqdocvar{ls\_lt\_alg};\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{l'} \coqdocvar{l} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{P} \coqdocvar{P'} \coqdocvar{ls\_lt\_alg} \coqdocvar{H};\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{lg} \coqdockw{as} [ \ensuremath{|} \coqdocvar{g} \coqdocvar{lg}]; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{l} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{P} \coqdocvar{P'} \coqdocvar{ls\_lt\_alg}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{t\_step}; \coqdoctac{apply} (@\coqdocvar{List\_mul\_step} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b\_in\_ls}; \coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{b} \coqdocvar{b\_in\_ls}) \coqdockw{as} [\coqdocvar{a'} [[\coqdocvar{a'\_eq\_a} \ensuremath{|} \coqdocvar{a'\_in\_nil}] \coqdocvar{b\_lt\_a'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a'\_eq\_a}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H}: \coqdoctac{\ensuremath{\exists}} \coqdocvar{ls1}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{ls2}, \coqdoceol
\coqdocindent{0.50em}
\coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{ls} (\coqdocvar{ls1} ++ \coqdocvar{ls2}) \ensuremath{\land}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{b}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} \coqdocvar{ls1} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{b} \coqdocvar{g}) \ensuremath{\land}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{b}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} \coqdocvar{ls2} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a'} (\coqdocvar{a} :: \coqdocvar{lg}) \ensuremath{\land} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{b} \coqdocvar{a'})).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{P'}; \coqdoctac{induction} \coqdocvar{ls} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{ls}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{nil} : \coqdocvar{list} \coqdocvar{term}); \coqdoctac{\ensuremath{\exists}} (\coqdocvar{nil} : \coqdocvar{list} \coqdocvar{term}); \coqdoctac{intuition}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{IHls} \coqdockw{as} [\coqdocvar{ls1} [\coqdocvar{ls2} [\coqdocvar{P'} [\coqdocvar{ls1\_lt\_g} \coqdocvar{ls2\_lt\_alg}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b\_in\_ls}; \coqdoctac{apply} \coqdocvar{ls\_lt\_alg}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{s}) \coqdockw{as} [\coqdocvar{a'} [[\coqdocvar{a'\_eq\_a} \ensuremath{|} [\coqdocvar{a'\_eq\_g} \ensuremath{|} \coqdocvar{a'\_in\_lg}]] \coqdocvar{b\_lt\_a'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{ls1}; \coqdoctac{\ensuremath{\exists}} (\coqdocvar{s} :: \coqdocvar{ls2}); \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} [\coqdocvar{b\_eq\_s} \ensuremath{|} \coqdocvar{b\_in\_ls2}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{b\_eq\_s}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a'\_eq\_a}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{ls2\_lt\_alg}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{s} :: \coqdocvar{ls1}); \coqdoctac{\ensuremath{\exists}} \coqdocvar{ls2}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} [\coqdocvar{b\_eq\_s} \ensuremath{|} \coqdocvar{b\_in\_ls1}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{b\_eq\_s}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a'\_eq\_g}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{ls1\_lt\_g}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{ls1}; \coqdoctac{\ensuremath{\exists}} (\coqdocvar{s} :: \coqdocvar{ls2}); \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} [\coqdocvar{b\_eq\_s} \ensuremath{|} \coqdocvar{b\_in\_ls2}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{b\_eq\_s}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{ls2\_lt\_alg}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{ls1} [\coqdocvar{ls2} [\coqdocvar{Pls} [\coqdocvar{ls1\_lt\_g} \coqdocvar{ls2\_lt\_alg}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{t\_trans} \coqdockw{with} (\coqdocvar{g} :: \coqdocvar{ls2} ++ \coqdocvar{lc}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{t\_step}; \coqdoctac{apply} (@\coqdocvar{List\_mul\_step} \coqdocvar{bb} \coqdocvar{g} \coqdocvar{ls1} (\coqdocvar{ls2} ++ \coqdocvar{lc})); \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{ass\_app}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app2}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IHlg} (\coqdocvar{g} :: \coqdocvar{ls2} ++ \coqdocvar{lc}) \coqdocvar{l} \coqdocvar{a} \coqdocvar{ls2} (\coqdocvar{g} :: \coqdocvar{lc})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons};[|\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside};[\coqdoctac{reflexivity}\ensuremath{|}\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside};[\coqdoctac{reflexivity}\ensuremath{|}\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})].\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{rpo\_mul\_rest} (\coqdocvar{bb} : \coqdocvar{nat}) : \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Rpo\_mul\_rest} : \coqdoceol
\coqdocindent{2.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{l} \coqdocvar{l'}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{9.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul\_rest} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{rpo\_mul\_step\_rest} (\coqdocvar{bb} : \coqdocvar{nat}) : \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{list} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Rpo\_mul\_step\_rest} : \coqdoceol
\coqdocindent{2.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{l} \coqdocvar{l'}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{9.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{rpo\_mul\_step} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul\_step\_rest} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_rest\_trans\_clos} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb}, \coqdocvar{inclusion} \coqdocvar{\_} (\coqdocvar{rpo\_mul\_rest} \coqdocvar{bb}) (\coqdocvar{clos\_trans} \coqdocvar{\_} (\coqdocvar{rpo\_mul\_step\_rest} \coqdocvar{bb})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{bb}; \coqdoctac{unfold} \coqdocvar{inclusion}; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{l} \coqdocvar{H}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{k'} \coqdocvar{Acc\_l} \coqdocvar{Acc\_l'} \coqdocvar{H'} \coqdocvar{H1} \coqdocvar{H2} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{P'} \coqdocvar{P} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l'} \coqdocvar{l} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{P'} \coqdocvar{P} \coqdocvar{ls\_lt\_alg} \coqdocvar{Acc\_l} \coqdocvar{Acc\_l'}; \coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{l'} \coqdocvar{l} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{P'} \coqdocvar{P} \coqdocvar{ls\_lt\_alg} \coqdocvar{H} \coqdocvar{Acc\_l} \coqdocvar{Acc\_l'} \coqdocvar{H'};\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{lg} \coqdockw{as} [ \ensuremath{|} \coqdocvar{g} \coqdocvar{lg}]; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{l} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{P'} \coqdocvar{P} \coqdocvar{ls\_lt\_alg} \coqdocvar{Acc\_l} \coqdocvar{Acc\_l'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{t\_step}; \coqdoctac{apply} \coqdocvar{Rpo\_mul\_step\_rest}; \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul\_step} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b\_in\_ls}; \coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{b} \coqdocvar{b\_in\_ls}) \coqdockw{as} [\coqdocvar{a'} [[\coqdocvar{a'\_eq\_a} \ensuremath{|} \coqdocvar{a'\_in\_nil}] \coqdocvar{b\_lt\_a'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a'\_eq\_a}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H}: \coqdoctac{\ensuremath{\exists}} \coqdocvar{ls1}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{ls2}, \coqdoceol
\coqdocindent{0.50em}
\coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{ls} (\coqdocvar{ls1} ++ \coqdocvar{ls2}) \ensuremath{\land}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{b}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} \coqdocvar{ls1} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{b} \coqdocvar{g}) \ensuremath{\land}\coqdoceol
\coqdocindent{0.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{b}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} \coqdocvar{ls2} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a'} (\coqdocvar{a} :: \coqdocvar{lg}) \ensuremath{\land} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{b} \coqdocvar{a'})).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{P'}; \coqdoctac{induction} \coqdocvar{ls} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{ls}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{nil} : \coqdocvar{list} \coqdocvar{term}); \coqdoctac{\ensuremath{\exists}} (\coqdocvar{nil} : \coqdocvar{list} \coqdocvar{term}); \coqdoctac{intuition}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{IHls} \coqdockw{as} [\coqdocvar{ls1} [\coqdocvar{ls2} [\coqdocvar{P'} [\coqdocvar{ls1\_lt\_g} \coqdocvar{ls2\_lt\_alg}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b\_in\_ls}; \coqdoctac{apply} \coqdocvar{ls\_lt\_alg}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{s}) \coqdockw{as} [\coqdocvar{a'} [[\coqdocvar{a'\_eq\_a} \ensuremath{|} [\coqdocvar{a'\_eq\_g} \ensuremath{|} \coqdocvar{a'\_in\_lg}]] \coqdocvar{b\_lt\_a'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{ls1}; \coqdoctac{\ensuremath{\exists}} (\coqdocvar{s} :: \coqdocvar{ls2}); \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} [\coqdocvar{b\_eq\_s} \ensuremath{|} \coqdocvar{b\_in\_ls2}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{b\_eq\_s}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a'\_eq\_a}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{ls2\_lt\_alg}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{s} :: \coqdocvar{ls1}); \coqdoctac{\ensuremath{\exists}} \coqdocvar{ls2}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} [\coqdocvar{b\_eq\_s} \ensuremath{|} \coqdocvar{b\_in\_ls1}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{b\_eq\_s}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a'\_eq\_g}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{ls1\_lt\_g}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{ls1}; \coqdoctac{\ensuremath{\exists}} (\coqdocvar{s} :: \coqdocvar{ls2}); \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} [\coqdocvar{b\_eq\_s} \ensuremath{|} \coqdocvar{b\_in\_ls2}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{b\_eq\_s}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{ls2\_lt\_alg}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{ls1} [\coqdocvar{ls2} [\coqdocvar{Pls} [\coqdocvar{ls1\_lt\_g} \coqdocvar{ls2\_lt\_alg}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{t\_trans} \coqdockw{with} (\coqdocvar{g} :: \coqdocvar{ls2} ++ \coqdocvar{lc}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{t\_step}; \coqdoctac{apply} \coqdocvar{Rpo\_mul\_step\_rest}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{s} [\coqdocvar{g\_eq\_s} \ensuremath{|} \coqdocvar{s\_mem\_ls2lc}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_l'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P'}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{s\_mem\_ls2lc}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{s\_mem\_ls2lc} \coqdockw{as} [\coqdocvar{s\_mem\_ls2} \ensuremath{|} \coqdocvar{s\_mem\_lc}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{rewrite} \coqdocvar{Pls}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul\_step} \coqdocvar{bb} \coqdocvar{g} \coqdocvar{ls1} (\coqdocvar{ls2} ++ \coqdocvar{lc})); \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P'}; \coqdoctac{rewrite} \coqdocvar{Pls}; \coqdoctac{rewrite} \coqdocvar{ass\_app}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IHlg} (\coqdocvar{g} :: \coqdocvar{ls2} ++ \coqdocvar{lc}) \coqdocvar{l} \coqdocvar{a} \coqdocvar{ls2} (\coqdocvar{g} :: \coqdocvar{lc})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside}; \coqdoctac{try} \coqdoctac{reflexivity}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons};[|\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside};[\coqdoctac{reflexivity}\ensuremath{|}\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{s} [\coqdocvar{g\_eq\_s} \ensuremath{|} \coqdocvar{s\_mem\_ls2lc}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_l'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P'}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{s\_mem\_ls2lc}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{s\_mem\_ls2lc} \coqdockw{as} [\coqdocvar{s\_mem\_ls2} \ensuremath{|} \coqdocvar{s\_mem\_lc}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{rewrite} \coqdocvar{Pls}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Splitting in two disjoint cases. \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{two\_cases\_rpo} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{m} \coqdocvar{n}, \coqdoceol
\coqdocindent{0.50em}
\coqdocvar{rpo\_mul\_step} \coqdocvar{bb} \coqdocvar{n} (\coqdocvar{a} :: \coqdocvar{m}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{n'}, \coqdocvar{equiv} \coqdocvar{a} \coqdocvar{a'} \ensuremath{\land} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{n} (\coqdocvar{a'} :: \coqdocvar{n'}) \ensuremath{\land} \coqdoceol
\coqdocindent{29.50em}
\coqdocvar{rpo\_mul\_step} \coqdocvar{bb} \coqdocvar{n'} \coqdocvar{m}) \ensuremath{\lor}\coqdoceol
\coqdocindent{0.50em}
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{ls}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{b}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{b} \coqdocvar{a}) \ensuremath{\land} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{n} (\coqdocvar{ls} ++ \coqdocvar{m})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{b} \coqdocvar{m} \coqdocvar{n} \coqdocvar{M}; \coqdoctac{inversion} \coqdocvar{M} \coqdockw{as} [\coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{P'} \coqdocvar{P} \coqdocvar{ls\_lt\_a}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{b\_mem\_a\_lc} : \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} (\coqdocvar{a} :: \coqdocvar{lc})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{b} \coqdocvar{P}); \coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{b\_mem\_a\_lc}; \coqdoctac{destruct} \coqdocvar{b\_mem\_a\_lc} \coqdockw{as} [\coqdocvar{b\_eq\_a} \ensuremath{|} \coqdocvar{b\_mem\_lc}].\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{ls}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{c} \coqdocvar{c\_mem\_ls}; \coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{b\_eq\_a}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{ls\_lt\_a}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P'}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons} \coqdoctac{in} \coqdocvar{P};  \coqdoctac{try} (\coqdoctac{symmetry}; \coqdoctac{trivial}). \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry};\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{b\_mem\_lc}) \coqdockw{as} [\coqdocvar{b'} [\coqdocvar{lc1} [\coqdocvar{lc2} [\coqdocvar{b\_eq\_b'} [\coqdocvar{H} \coqdocvar{\_}]]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{b\_eq\_b'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{b'}; \coqdoctac{\ensuremath{\exists}} (\coqdocvar{ls} ++ (\coqdocvar{lc1} ++ \coqdocvar{lc2})); \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P'}; \coqdoctac{subst} \coqdocvar{lc}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{ass\_app}; \coqdoctac{apply} \coqdocvar{permut0\_sym}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside};[|\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{ass\_app}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul\_step} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{ls} (\coqdocvar{lc1} ++ \coqdocvar{lc2})); \coqdoctac{try} \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{permut0\_cons\_inside} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{m} (\coqdocvar{a} :: \coqdocvar{lc1}) \coqdocvar{lc2} \coqdocvar{b\_eq\_b'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{subst} \coqdocvar{lc}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_permut\_map\_acc} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l} \coqdocvar{l'} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{Acc} (\coqdocvar{rpo\_mul\_step\_rest} \coqdocvar{bb}) \coqdocvar{l} \ensuremath{\rightarrow}  \coqdocvar{Acc} (\coqdocvar{rpo\_mul\_step\_rest} \coqdocvar{bb}) \coqdocvar{l'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{P} \coqdocvar{A1}; \coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{l'{}'} \coqdocvar{M2}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{A1} \coqdockw{as} [\coqdocvar{H}]; \coqdoctac{apply} \coqdocvar{H}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{M2} \coqdockw{as} [\coqdocvar{k'} \coqdocvar{k'{}'} \coqdocvar{Acc\_l'} \coqdocvar{Acc\_l'{}'} \coqdocvar{H'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{k'} \coqdocvar{k'{}'} \coqdocvar{P'{}'} \coqdocvar{P'} \coqdocvar{ls\_lt\_a}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Rpo\_mul\_step\_rest}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{s\_in\_l}; \coqdoctac{apply} \coqdocvar{Acc\_l'}; \coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{s} \coqdocvar{P}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul\_step} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} \coqdocvar{l'}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Multiset extension of rpo on accessible terms lists is well-founded. \begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{wf\_rpo\_mul\_rest} : \coqdockw{\ensuremath{\forall}} \coqdocvar{bb}, \coqdocvar{well\_founded} (\coqdocvar{rpo\_mul\_rest} \coqdocvar{bb}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{bb}; \coqdoctac{apply} \coqdocvar{wf\_incl} \coqdockw{with} (\coqdocvar{clos\_trans} \coqdocvar{\_} (\coqdocvar{rpo\_mul\_step\_rest} \coqdocvar{bb})).\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{inclusion}; \coqdoctac{apply} \coqdocvar{rpo\_mul\_rest\_trans\_clos}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{wf\_clos\_trans}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{well\_founded}; \coqdoctac{intro} \coqdocvar{l}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{l}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{m} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{l} \coqdocvar{l'} \coqdocvar{Acc\_l} \coqdocvar{Acc\_l'} \coqdocvar{H'}]; \coqdoctac{subst};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l} \coqdocvar{l'}  \coqdocvar{P} \coqdocvar{P'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{L} := \coqdocvar{permut\_length} \coqdocvar{P'}); \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo\_mul\_step\_rest} \coqdocvar{bb}) (\coqdocvar{s} :: \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{Acc\_s}; \coqdoctac{generalize} \coqdocvar{l} \coqdocvar{IHl}; \coqdoctac{clear} \coqdocvar{l} \coqdocvar{IHl}; \coqdoceol
\coqdocnoindent
\coqdoctac{pattern} \coqdocvar{s}; \coqdoctac{apply} \coqdocvar{Acc\_ind} \coqdockw{with} \coqdocvar{term} (\coqdocvar{rpo} \coqdocvar{bb}); \coqdoctac{trivial}; \coqdoctac{clear} \coqdocvar{s} \coqdocvar{Acc\_s}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{Acc\_s} \coqdocvar{IHs} \coqdocvar{l} \coqdocvar{Acc\_l}; \coqdoctac{pattern} \coqdocvar{l}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_ind} \coqdockw{with} (\coqdocvar{list} \coqdocvar{term}) (\coqdocvar{rpo\_mul\_step\_rest} \coqdocvar{bb}); \coqdoctac{trivial}; \coqdoctac{clear} \coqdocvar{l} \coqdocvar{Acc\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l} \coqdocvar{Acc\_l} \coqdocvar{IHl}; \coqdoctac{apply} \coqdocvar{Acc\_intro}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H}; \coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{s\_k} \coqdocvar{k'} \coqdocvar{Acc\_s\_l} \coqdocvar{Acc\_l'} \coqdocvar{H'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (@\coqdocvar{two\_cases\_rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{H'}) \coqdockw{as} [[\coqdocvar{s'} [\coqdocvar{n'} [\coqdocvar{s\_eq\_s'} [\coqdocvar{P} \coqdocvar{H'{}'}]]]] \ensuremath{|} [\coqdocvar{ls} [\coqdocvar{ls\_lt\_s} \coqdocvar{P}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{list\_permut\_map\_acc} \coqdocvar{bb} (\coqdocvar{s} :: \coqdocvar{n'})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}; \coqdoctac{reflexivity} || \coqdoctac{apply} \coqdocvar{equiv\_equiv} || \coqdoctac{auto}. \coqdoctac{symmetry};\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{l'{}'} \coqdocvar{l'{}'\_lt\_s'\_n}; \coqdoctac{apply} \coqdocvar{Acc\_inv} \coqdockw{with} (\coqdocvar{s} :: \coqdocvar{n'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{apply} \coqdocvar{Rpo\_mul\_step\_rest}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Acc\_s\_l}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'{}'} \coqdocvar{s'{}'\_in\_n'}; \coqdoctac{apply} \coqdocvar{Acc\_l'}; \coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{s'{}'} \coqdocvar{P}); \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{list\_permut\_map\_acc} \coqdocvar{bb} (\coqdocvar{ls} ++ \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_sym}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{P}; \coqdoctac{induction} \coqdocvar{ls} \coqdockw{as} [ \ensuremath{|} \coqdocvar{b} \coqdocvar{ls}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{IHs}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{ls\_lt\_s}; \coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHls}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{ls\_lt\_s}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l'} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_inv} \coqdockw{with} (\coqdocvar{s} :: \coqdocvar{l}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{k} \coqdocvar{k'} \coqdocvar{Acc\_s\_l} \coqdocvar{Acc\_l'}]; \coqdoctac{subst};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{Acc\_s\_l}; \coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{rpo\_rest} (\coqdocvar{bb} : \coqdocvar{nat}) : (\coqdocvar{symbol} \ensuremath{\times} \coqdocvar{list} \coqdocvar{term}) \ensuremath{\rightarrow} (\coqdocvar{symbol} \ensuremath{\times} \coqdocvar{list} \coqdocvar{term}) \ensuremath{\rightarrow} \coqdockw{Prop} :=\coqdoceol
\coqdocindent{0.50em}
\ensuremath{|} \coqdocvar{Top\_gt\_rest} : \coqdoceol
\coqdocindent{3.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{prec} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{f} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{3.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}) \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{rpo\_rest} \coqdocvar{bb} (\coqdocvar{g}, \coqdocvar{l'}) (\coqdocvar{f}, \coqdocvar{l})\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Top\_eq\_lex\_rest} : \coqdoceol
\coqdocindent{4.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f} = \coqdocvar{Lex} \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g} = \coqdocvar{Lex} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} (\coqdocvar{length} \coqdocvar{l} = \coqdocvar{length} \coqdocvar{l'} \ensuremath{\lor} \coqdocvar{length} \coqdocvar{l'} \ensuremath{\le} \coqdocvar{bb} \ensuremath{\land} \coqdocvar{length} \coqdocvar{l} \ensuremath{\le} \coqdocvar{bb}) \ensuremath{\rightarrow} \coqdocvar{rpo\_lex} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}) \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo\_rest} \coqdocvar{bb} (\coqdocvar{f}, \coqdocvar{l'}) (\coqdocvar{g}, \coqdocvar{l})\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Top\_eq\_mul\_rest} : \coqdoceol
\coqdocindent{4.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f} = \coqdocvar{Mul} \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g} = \coqdocvar{Mul} \ensuremath{\rightarrow} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{l'} \coqdocvar{l} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}) \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo\_rest} \coqdocvar{bb} (\coqdocvar{f}, \coqdocvar{l'}) (\coqdocvar{g}, \coqdocvar{l}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_rest\_prec\_eq} : \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l}, \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo\_rest} \coqdocvar{bb}) (\coqdocvar{f}, \coqdocvar{l}) \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo\_rest} \coqdocvar{bb}) (\coqdocvar{g}, \coqdocvar{l}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H0}. \coqdoctac{clear} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{y}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_gt\_rest}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_prec1} \coqdockw{with} \coqdocvar{g}. \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}. \coqdoctac{trivial}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_lex\_rest}; \coqdoctac{trivial}. \coqdoctac{assert} (\coqdocvar{H13}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g}). \coqdoctac{assert} (\coqdocvar{H14}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g}). \coqdoctac{apply} \coqdocvar{H13}. \coqdoctac{trivial}. \coqdoctac{rewrite}  \coqdocvar{H14}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_transitive} \coqdockw{with} \coqdocvar{g}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_mul\_rest}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{H13}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g}). \coqdoctac{assert} (\coqdocvar{H14}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g}). \coqdoctac{apply} \coqdocvar{H13}. \coqdoctac{trivial}. \coqdoctac{rewrite}  \coqdocvar{H14}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_transitive} \coqdockw{with} \coqdocvar{g}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{wf\_rpo\_rest} : \coqdocvar{well\_founded} (\coqdocvar{prec} \coqdocvar{Prec}) \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{bb}, \coqdocvar{well\_founded} (\coqdocvar{rpo\_rest} \coqdocvar{bb}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{wf\_prec} \coqdocvar{bb}; \coqdoctac{unfold} \coqdocvar{well\_founded}; \coqdoctac{intros} [\coqdocvar{f} \coqdocvar{l}]; \coqdoctac{generalize} \coqdocvar{l}; \coqdoctac{clear} \coqdocvar{l}; \coqdoceol
\coqdocnoindent
\coqdoctac{pattern} \coqdocvar{f}; \coqdoctac{apply} (\coqdocvar{well\_founded\_induction\_type} \coqdocvar{wf\_prec}); \coqdoctac{clear} \coqdocvar{f}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{IHf} \coqdocvar{l}; \coqdoctac{assert} (\coqdocvar{Sf} : \coqdockw{\ensuremath{\forall}} \coqdocvar{f'}, \coqdocvar{f'} = \coqdocvar{f} \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f'} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f}); \coqdoctac{generalize} (\coqdocvar{Sf} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})); \coqdoctac{clear} \coqdocvar{Sf}; \coqdoctac{intro} \coqdocvar{Sf}.\coqdoceol
\coqdocnoindent
\coqdoctac{pattern} \coqdocvar{l}; \coqdoctac{apply} (\coqdocvar{well\_founded\_induction\_type} (\coqdocvar{wf\_rpo\_lex\_rest} \coqdocvar{bb} \coqdocvar{bb})); \coqdoctac{clear} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l} \coqdocvar{IHl}; \coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} [\coqdocvar{g} \coqdocvar{l'}] \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [ \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{g\_prec\_f} \coqdocvar{Acc\_l} \coqdocvar{Acc\_l'} \coqdoceol
\coqdocindent{11.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{Sf'} \coqdocvar{Sg'} \coqdocvar{eq\_f'\_g'} \coqdocvar{L} \coqdocvar{H'} \coqdocvar{Acc\_l} \coqdocvar{Acc\_l'}\coqdoceol
\coqdocindent{11.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{Sf'} \coqdocvar{Sg'} \coqdocvar{eq\_f'\_g'} \coqdocvar{H'} \coqdocvar{Acc\_l} \coqdocvar{Acc\_l'} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHf}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_rest\_prec\_eq} \coqdockw{with} \coqdocvar{f}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_rest\_prec\_eq} \coqdockw{with} \coqdocvar{f}. \coqdoctac{apply} \coqdocvar{prec\_eq\_refl}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{apply} \coqdocvar{Rpo\_lex\_rest}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Sf} \coqdoctac{in} \coqdocvar{Sg'}; \coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{pattern} \coqdocvar{l}; \coqdoctac{apply} (\coqdocvar{well\_founded\_induction\_type} (\coqdocvar{wf\_rpo\_mul\_rest} \coqdocvar{bb})); \coqdoctac{clear} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l} \coqdocvar{IHl}; \coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} [\coqdocvar{g} \coqdocvar{l'}] \coqdocvar{H}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [ \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{g\_prec\_f} \coqdocvar{Acc\_l} \coqdocvar{Acc\_l'} \coqdoceol
\coqdocindent{12.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{Sf'} \coqdocvar{L} \coqdocvar{H'} \coqdocvar{Acc\_l} \coqdocvar{Acc\_l'}\coqdoceol
\coqdocindent{12.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{Sf'} \coqdocvar{H'} \coqdocvar{Acc\_l} \coqdocvar{Acc\_l'} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHf}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{Lex} = \coqdocvar{Mul}); [\coqdoctac{discriminate} \ensuremath{|} \coqdoctac{apply} \coqdocvar{trans\_eq} \coqdockw{with} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f}); \coqdoctac{auto}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_rest\_prec\_eq} \coqdockw{with} \coqdocvar{f}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{apply} \coqdocvar{Rpo\_mul\_rest}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{acc\_build} :\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{well\_founded} (\coqdocvar{prec} \coqdocvar{Prec}) \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{f\_l},\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvar{f\_l} \coqdockw{with} (\coqdocvar{f}, \coqdocvar{l}) \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{t}) \ensuremath{\rightarrow}  \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{wf\_prec} \coqdocvar{bb} \coqdocvar{f\_l}; \coqdoctac{pattern} \coqdocvar{f\_l};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{well\_founded\_induction\_type} (\coqdocvar{wf\_rpo\_rest} \coqdocvar{wf\_prec} \coqdocvar{bb})); \coqdoctac{clear} \coqdocvar{f\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{f} \coqdocvar{l}] \coqdocvar{IH} \coqdocvar{Acc\_l}; \coqdoctac{apply} \coqdocvar{Acc\_intro};\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s}; \coqdoctac{pattern} \coqdocvar{s}; \coqdoctac{apply} \coqdocvar{term\_rec3\_mem}; \coqdoctac{clear} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{Acc\_intro}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t\_lt\_v}; \coqdoctac{inversion} \coqdocvar{t\_lt\_v}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{g} \coqdocvar{k} \coqdocvar{IHl} \coqdocvar{gk\_lt\_fl};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{gk\_lt\_fl} \coqdockw{as} [ \coqdocvar{f'} \coqdocvar{l'} \coqdocvar{s'} \coqdocvar{t} \coqdocvar{t\_in\_l} \coqdocvar{H'} \coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{k'} \coqdocvar{l'} \coqdocvar{g\_prec\_f} \coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{k'} \coqdocvar{l'} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f\_eq\_g} \coqdocvar{L} \coqdocvar{H'} \coqdocvar{H'{}'}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{k'} \coqdocvar{l'} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f\_eq\_g} \coqdocvar{H'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Acc\_t} := \coqdocvar{Acc\_l} \coqdocvar{\_} \coqdocvar{t\_in\_l}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{inversion} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{s'} \coqdocvar{t'} \coqdocvar{s\_eq\_t} \ensuremath{|} \coqdocvar{s'} \coqdocvar{t'} \coqdocvar{s\_lt\_t} ]; \coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{s'} \coqdocvar{t'}; [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Acc\_inv} \coqdockw{with} \coqdocvar{t}; \coqdoctac{trivial} ].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intro} \coqdocvar{u}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{k}) \coqdocvar{t}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} \coqdocvar{Acc\_inv} \coqdockw{with} \coqdocvar{t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Acc\_k} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{k} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{s\_mem\_k}; \coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{g},\coqdocvar{k})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_gt\_rest}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Acc\_k} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{k} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{s\_mem\_k}; \coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{g},\coqdocvar{k})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_lex\_rest}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Acc\_k} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{k} \ensuremath{\rightarrow} \coqdocvar{Acc} (\coqdocvar{rpo} \coqdocvar{bb}) \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{s\_mem\_k}; \coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{k}); \coqdoctac{trivial}; \coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{s}; \coqdoctac{trivial}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{g},\coqdocvar{k})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_mul\_rest}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{Main theorem: when the precedence is well-founded, so is the rpo.}

\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{wf\_rpo} : \coqdocvar{well\_founded} (\coqdocvar{prec} \coqdocvar{Prec}) \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{bb}, \coqdocvar{well\_founded} (\coqdocvar{rpo} \coqdocvar{bb}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{wf\_prec} \coqdocvar{bb};\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{well\_founded}; \coqdoctac{intro} \coqdocvar{t}; \coqdoctac{pattern} \coqdocvar{t}; \coqdoctac{apply} \coqdocvar{term\_rec3\_mem}; \coqdoctac{clear} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{v}; \coqdoctac{apply} \coqdocvar{Acc\_intro}; \coqdoctac{intros} \coqdocvar{s} \coqdocvar{s\_lt\_t}; \coqdoctac{inversion} \coqdocvar{s\_lt\_t}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{l} \coqdocvar{Acc\_l}; \coqdoctac{apply} (\coqdocvar{acc\_build} \coqdocvar{wf\_prec} \coqdocvar{bb} (\coqdocvar{f},\coqdocvar{l})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{RPO is compatible with the instanciation by a substitution.}

\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_subst} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{sigma}, \coqdocvar{equiv} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{s}) (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{t}; \coqdoctac{generalize} \coqdocvar{s}; \coqdoctac{clear} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdoctac{pattern} \coqdocvar{t}; \coqdoctac{apply} \coqdocvar{term\_rec3\_mem}; \coqdoctac{clear} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v} \coqdocvar{s} \coqdocvar{v\_eq\_s}; \coqdoctac{inversion} \coqdocvar{v\_eq\_s}; \coqdoctac{subst}; \coqdoctac{intro} \coqdocvar{sigma}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{l} \coqdocvar{IHl} \coqdocvar{s} \coqdocvar{fl\_eq\_s} \coqdocvar{sigma}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{fl\_eq\_s} \coqdockw{as} [ \coqdocvar{s'} \coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f'\_eq\_g} \coqdocvar{l1\_eq\_l2}\coqdoceol
\coqdocindent{15.50em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f'\_eq\_g} \coqdocvar{P} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Eq\_lex}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l1} \coqdocvar{l1\_eq\_l2}; \coqdoctac{clear} \coqdocvar{fl\_eq\_s} \coqdocvar{l1} \coqdocvar{l1\_eq\_l2}; \coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{l}]; \coqdoctac{intros} \coqdocvar{l1} \coqdocvar{l1\_eq\_l2};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_eq\_l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s1} \coqdocvar{s'} \coqdocvar{l1'} \coqdocvar{l'} \coqdocvar{s1\_eq\_s'} \coqdocvar{l1'\_eq\_l'}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Eq\_list\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Eq\_list\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl0}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t\_in\_l}; \coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Eq\_mul}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{permut\_map} (\coqdocvar{A} := \coqdocvar{term}) (\coqdocvar{B} := \coqdocvar{term}) (\coqdocvar{A'} := \coqdocvar{term}) (\coqdocvar{B'} := \coqdocvar{term}) (\coqdocvar{R} := \coqdocvar{equiv})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a1} \coqdocvar{a2} \coqdocvar{a1\_in\_l1} \coqdocvar{\_} \coqdocvar{a1\_eq\_a2}; \coqdoctac{symmetry}; \coqdoctac{apply} \coqdocvar{IHl}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{a1} \coqdocvar{P}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_subst} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{sigma}, \coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{s}) (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{bb}.\coqdoceol
\coqdocnoindent
\coqdoctac{cut} (\coqdockw{\ensuremath{\forall}} \coqdocvar{p}, \coqdockw{match} \coqdocvar{p} \coqdockw{with} \coqdoceol
\coqdocindent{6.00em}
(\coqdocvar{s},\coqdocvar{t}) \ensuremath{\Rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{7.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{sigma}, \coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{s}) (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{t})\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H} \coqdocvar{s} \coqdocvar{t} \coqdocvar{s\_lt\_t} \coqdocvar{sigma}; \coqdoctac{apply} (\coqdocvar{H} (\coqdocvar{s},\coqdocvar{t})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{p}; \coqdoctac{pattern} \coqdocvar{p}; \coqdoctac{refine} (\coqdocvar{well\_founded\_ind} \coqdocvar{wf\_size2} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}); \coqdoctac{clear} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{s} \coqdocvar{t}] \coqdocvar{IH} \coqdocvar{s\_lt\_t} \coqdocvar{sigma}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{s\_lt\_t} \coqdockw{as} [ \coqdocvar{f} \coqdocvar{l} \coqdocvar{s'} \coqdocvar{t'} \coqdocvar{t'\_mem\_l} \coqdocvar{R'} \coqdoceol
\coqdocindent{11.50em}
\ensuremath{|} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{R'} \coqdocvar{R'{}'} \coqdoceol
\coqdocindent{11.50em}
\ensuremath{|} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{f\_lex} \coqdocvar{g\_lex} \coqdocvar{f\_eq\_g} \coqdocvar{L} \coqdocvar{Rlex} \coqdocvar{R'} \coqdocvar{H2} \coqdocvar{H3}\coqdoceol
\coqdocindent{11.50em}
\ensuremath{|} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{f\_mul} \coqdocvar{g\_mul} \coqdocvar{f\_eq\_g} \coqdocvar{Rmul} \coqdocvar{R'} \coqdocvar{H2} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{t'\_mem\_l}) \coqdockw{as} [\coqdocvar{t'{}'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{t'\_eq\_t'{}'} [\coqdocvar{H} \coqdocvar{\_}]]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{t'\_eq\_t'{}'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{subst} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{map\_app}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{left}; \coqdoctac{apply} \coqdocvar{equiv\_subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{R'} \coqdockw{as} [ \coqdocvar{s'} \coqdocvar{R'{}'} \ensuremath{|} \coqdocvar{s'} \coqdocvar{t'{}'} \coqdocvar{R'{}'} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{equiv\_subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{s},\coqdocvar{t'})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex2\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Top\_gt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} \coqdocvar{s'\_mem\_l'\_sigma}; \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{s'\_mem\_l'\_sigma}) \coqdockw{as} [\coqdocvar{s'{}'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{s'\_eq\_s'{}'} [\coqdocvar{H} \coqdocvar{\_}]]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{s'\_eq\_s'{}'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{s'\_eq\_s'{}'}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{s'{}'\_in\_l'\_sigma} : \coqdocvar{In} \coqdocvar{s'{}'} (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{l'})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{in\_map\_iff} \coqdoctac{in} \coqdocvar{s'{}'\_in\_l'\_sigma}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{s'{}'\_in\_l'\_sigma} \coqdockw{as} [\coqdocvar{u} [\coqdocvar{s\_eq\_u\_sigma} \coqdocvar{u\_in\_l'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{s'{}'}; \coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{Term} \coqdocvar{f} (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{l})) \coqdockw{with} \coqdoceol
\coqdocindent{7.00em}
(\coqdocvar{apply\_subst} \coqdocvar{sigma} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{u}, \coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{l'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{u}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Top\_eq\_lex}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{length\_map}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l} \coqdocvar{Rlex} \coqdocvar{IH}; \coqdoctac{clear} \coqdocvar{l} \coqdocvar{s\_lt\_t} \coqdocvar{Rlex} \coqdocvar{R'} \coqdocvar{IH} \coqdocvar{L};\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s'} \coqdocvar{l'} ]; \coqdoctac{intros} \coqdocvar{l} \coqdocvar{Rlex} \coqdocvar{IH}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{Rlex} \coqdockw{as} [\coqdocvar{s'{}'} \coqdocvar{t'} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{s'\_lt\_t'} \coqdocvar{L} \ensuremath{|} \coqdocvar{s'{}'} \coqdocvar{t'} \coqdocvar{k} \coqdocvar{k'} \coqdocvar{s'\_eq\_t'} \coqdocvar{k\_lt\_k'} \ensuremath{|} ]; \coqdoctac{subst}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_gt}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{s'},\coqdocvar{t'})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{s} \coqdocvar{t}] \coqdocvar{S} \coqdocvar{s\_lt\_t} \coqdocvar{tau}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{s},\coqdocvar{t})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{o\_size2\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l'}, \coqdocvar{Term} \coqdocvar{f} \coqdocvar{k'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_bis}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} \coqdocvar{s'\_mem\_l'\_sigma}; \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{s'\_mem\_l'\_sigma}) \coqdockw{as} [\coqdocvar{s'{}'} [\coqdocvar{l1} [\coqdocvar{l2} [\coqdocvar{s'\_eq\_s'{}'} [\coqdocvar{H} \coqdocvar{\_}]]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{s'\_eq\_s'{}'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{s'\_eq\_s'{}'}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{s'{}'\_in\_l'\_sigma} : \coqdocvar{In} \coqdocvar{s'{}'} (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{l'})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{in\_map\_iff} \coqdoctac{in} \coqdocvar{s'{}'\_in\_l'\_sigma}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{s'{}'\_in\_l'\_sigma} \coqdockw{as} [\coqdocvar{u} [\coqdocvar{s\_eq\_u\_sigma} \coqdocvar{u\_in\_l'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{s'{}'}; \coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{Term} \coqdocvar{f} (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{l})) \coqdockw{with} \coqdoceol
\coqdocindent{7.00em}
(\coqdocvar{apply\_subst} \coqdocvar{sigma} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{u}, \coqdocvar{Term} \coqdocvar{g} \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{u}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Top\_eq\_mul}; \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{Rmul} \coqdockw{as} [ \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l0} \coqdocvar{k0} \coqdocvar{Pk} \coqdocvar{Pl} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{a}) (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{lg})\coqdoceol
\coqdocnoindent
(\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{ls}) (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{lc})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{map\_app}; \coqdoctac{apply} \coqdocvar{permut\_map} \coqdockw{with} \coqdocvar{equiv}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b'} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{b\_eq\_b'}; \coqdoctac{apply} \coqdocvar{equiv\_subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{map\_app}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (@\coqdocvar{permut\_map} \coqdocvar{term} \coqdocvar{term} \coqdocvar{term} \coqdocvar{term} \coqdocvar{equiv} \coqdoceol
\coqdocindent{10.00em}
\coqdocvar{equiv} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{a} :: \coqdocvar{lg} ++ \coqdocvar{lc}) \coqdocvar{\_} \coqdocvar{\_}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b'} \coqdocvar{b\_in\_l} \coqdocvar{\_} \coqdocvar{b\_eq\_b'}; \coqdoctac{apply} \coqdocvar{equiv\_subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b\_mem\_ls\_sigma}; \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{b\_mem\_ls\_sigma}) \coqdockw{as} [\coqdocvar{b'} [\coqdocvar{ls1} [\coqdocvar{ls2} [\coqdocvar{b\_eq\_b'} [\coqdocvar{H} \coqdocvar{\_}]]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{b\_eq\_b'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{b'\_in\_ls\_sigma} : \coqdocvar{In} \coqdocvar{b'} (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{ls})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{in\_map\_iff} \coqdoctac{in} \coqdocvar{b'\_in\_ls\_sigma}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{b'\_in\_ls\_sigma} \coqdockw{as} [\coqdocvar{b'{}'} [\coqdocvar{b'{}'\_sigma\_eq\_b'} \coqdocvar{b'{}'\_in\_ls}]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{b'{}'}) \coqdockw{as} [\coqdocvar{a'} [\coqdocvar{a'\_mem\_alg} \coqdocvar{b'{}'\_lt\_a'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{a'\_mem\_alg}) \coqdockw{as} [\coqdocvar{a'{}'} [\coqdocvar{alg'} [\coqdocvar{alg'{}'} [\coqdocvar{a'\_eq\_a'{}'} [\coqdocvar{H'} \coqdocvar{\_}]]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{a'\_eq\_a'{}'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{a'{}'}); \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_map\_iff} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) (\coqdocvar{a} :: \coqdocvar{lg})).\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'{}'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{b\_eq\_b'}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{b'}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{b'{}'},\coqdocvar{a'{}'})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_mem}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Pk}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a'\_eq\_a'{}'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_eq\_subst} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{sigma}, \coqdocvar{rpo\_eq} \coqdocvar{bb} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{s}) (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \coqdocvar{H} \coqdocvar{sigma}; \coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{t1} \coqdocvar{t2} \coqdocvar{Heq} \ensuremath{|} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{Hlt}]; \coqdoctac{subst} \coqdocvar{t1} \coqdocvar{t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{equiv\_subst}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{apply} \coqdocvar{rpo\_subst}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\subsection{RPO is compatible with adding context.}

\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_add\_context} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{is\_a\_pos} \coqdocvar{ctx} \coqdocvar{p} = \coqdocvar{true} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{equiv} (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{p}) (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{t} \coqdocvar{p}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{p}; \coqdoctac{induction} \coqdocvar{p} \coqdockw{as} [ \ensuremath{|} \coqdocvar{i} \coqdocvar{p} ]; \coqdoctac{intros} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{t} \coqdocvar{R} \coqdocvar{H}; \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{ctx} \coqdockw{as} [ \coqdocvar{v} \ensuremath{|} \coqdocvar{f} \coqdocvar{l} ].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Status} : \coqdockw{\ensuremath{\forall}} \coqdocvar{g}, \coqdocvar{g} = \coqdocvar{f} \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 (\coqdoctac{rewrite} \coqdocvar{replace\_at\_pos\_unfold});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f}); \coqdoctac{generalize} (\coqdocvar{Status} \coqdocvar{f} (\coqdocvar{refl\_equal} \coqdocvar{\_})); \coqdoctac{clear} \coqdocvar{Status}; \coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{Status}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_lex}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_refl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{u} \coqdocvar{l}]; \coqdoctac{intros} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{i} \coqdockw{as} [ \ensuremath{|} \coqdocvar{i}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{IHp}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l}; \coqdoctac{intro} \coqdocvar{l'}; \coqdoctac{induction} \coqdocvar{l'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{u'} \coqdocvar{l'}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_cons}; \coqdoctac{trivial}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_mul}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_refl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{u} \coqdocvar{l}]; \coqdoctac{intros} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{simpl}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{i} \coqdockw{as} [ \ensuremath{|} \coqdocvar{i}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{IHp}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_add\_context} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{p} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{is\_a\_pos} \coqdocvar{ctx} \coqdocvar{p} = \coqdocvar{true} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{rpo} \coqdocvar{bb} (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{p}) (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{t} \coqdocvar{p}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{p}; \coqdoctac{induction} \coqdocvar{p} \coqdockw{as} [ \ensuremath{|} \coqdocvar{i} \coqdocvar{p} ]; \coqdoctac{intros} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{t} \coqdocvar{R} \coqdocvar{H}; \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{ctx} \coqdockw{as} [ \coqdocvar{v} \ensuremath{|} \coqdocvar{f} \coqdocvar{l} ].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Status} : \coqdockw{\ensuremath{\forall}} \coqdocvar{g}, \coqdocvar{g} = \coqdocvar{f} \ensuremath{\rightarrow} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 (\coqdoctac{rewrite} \coqdocvar{replace\_at\_pos\_unfold});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f}); \coqdoctac{generalize} (\coqdocvar{Status} \coqdocvar{f} (\coqdocvar{refl\_equal} \coqdocvar{\_})); \coqdoctac{clear} \coqdocvar{Status}; \coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{Status}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_lex}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_refl}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{clear}; \coqdocvar{revert} \coqdocvar{l}; \coqdoctac{induction} \coqdocvar{i} \coqdockw{as} [ \ensuremath{|} \coqdocvar{i}]; \coqdoctac{intros} [ \ensuremath{|} \coqdocvar{a} \coqdocvar{l}]; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{IHi}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{u} \coqdocvar{l}]; \coqdoctac{intros} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{destruct} \coqdocvar{i}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{i} \coqdockw{as} [ \ensuremath{|} \coqdocvar{i}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_gt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{IHp}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} \coqdocvar{s'\_mem\_ls};\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} : \coqdoctac{\ensuremath{\exists}} \coqdocvar{s'{}'}, \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s'} \coqdocvar{s'{}'} \ensuremath{\land} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s'{}'} (\coqdocvar{replace\_at\_pos\_list} \coqdocvar{l} \coqdocvar{t} \coqdocvar{i} \coqdocvar{p})).\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{i} \coqdocvar{H} \coqdocvar{s'} \coqdocvar{s'\_mem\_ls}; \coqdoctac{clear} \coqdocvar{i} \coqdocvar{H} \coqdocvar{s'} \coqdocvar{s'\_mem\_ls}; \coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{u} \coqdocvar{l}]; \coqdoctac{intros} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{i} \coqdockw{as} [ \ensuremath{|} \coqdocvar{i}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} [\coqdocvar{s'\_eq\_s'{}'} \ensuremath{|} \coqdocvar{s'\_mem\_l}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{replace\_at\_pos} \coqdocvar{u} \coqdocvar{t} \coqdocvar{p}); \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{s'\_eq\_s'{}'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHp}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{s'}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} [\coqdocvar{s'\_eq\_u} \ensuremath{|} \coqdocvar{s'\_mem\_l}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{u}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{IHl}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IHl} \coqdocvar{i} \coqdocvar{H} \coqdocvar{s'} \coqdocvar{s'\_mem\_l}) \coqdockw{as} [\coqdocvar{s'{}'} [\coqdocvar{s'\_le\_s'{}'} \coqdocvar{s'{}'\_mem\_l'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{s'{}'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{s'{}'} [\coqdocvar{s'\_le\_s'{}'} \coqdocvar{s'{}'\_mem\_l'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{s'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_mul}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_refl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{u} \coqdocvar{l}]; \coqdoctac{intros} \coqdocvar{i} \coqdocvar{H}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{destruct} \coqdocvar{i}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{i} \coqdockw{as} [ \ensuremath{|} \coqdocvar{i}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} (\coqdocvar{replace\_at\_pos} \coqdocvar{u} \coqdocvar{t} \coqdocvar{p}) \coqdocvar{nil} (\coqdocvar{replace\_at\_pos} \coqdocvar{u} \coqdocvar{s} \coqdocvar{p} :: \coqdocvar{nil}) \coqdocvar{l}); \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} [\coqdocvar{b\_eq\_s'} \ensuremath{|} \coqdocvar{b\_mem\_nil}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{replace\_at\_pos} \coqdocvar{u} \coqdocvar{t} \coqdocvar{p}); \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{b\_eq\_s'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHp}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{IHl}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{IHl} \coqdocvar{i} \coqdocvar{H}).\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{ls\_lt\_alg} \coqdocvar{P1} \coqdocvar{P2}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} (\coqdocvar{u} :: \coqdocvar{lc})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside}; \coqdoctac{trivial}; \coqdoctac{try} \coqdoctac{reflexivity}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside}; \coqdoctac{trivial}; \coqdoctac{try} \coqdoctac{reflexivity}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_eq\_add\_context} :\coqdoceol
\coqdocindent{0.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{p} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{t}, \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{is\_a\_pos} \coqdocvar{ctx} \coqdocvar{p} = \coqdocvar{true} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{rpo\_eq} \coqdocvar{bb} (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{p}) (\coqdocvar{replace\_at\_pos} \coqdocvar{ctx} \coqdocvar{t} \coqdocvar{p}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{p} \coqdocvar{ctx} \coqdocvar{s} \coqdocvar{t} \coqdocvar{H} \coqdocvar{P}; \coqdoctac{inversion} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{equiv\_add\_context}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{apply} \coqdocvar{rpo\_add\_context}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Function} \coqdocvar{remove\_equiv} (\coqdocvar{t} : \coqdocvar{term}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{term}) \{\coqdockw{struct} \coqdocvar{l}\} : \coqdocvar{option} (\coqdocvar{list} \coqdocvar{term}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvar{l} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{nil} \ensuremath{\Rightarrow} @\coqdocvar{None} \coqdocvar{\_}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{a} :: \coqdocvar{l} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{4.50em}
\coqdockw{if}  \coqdocvar{equiv\_dec} \coqdocvar{t} \coqdocvar{a}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{l}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{else}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{match} \coqdocvar{remove\_equiv} \coqdocvar{t} \coqdocvar{l} \coqdockw{with}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} @ \coqdocvar{None} \coqdocvar{\_}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{l'} \ensuremath{\Rightarrow} \coqdocvar{Some} (\coqdocvar{a} :: \coqdocvar{l'})\coqdoceol
\coqdocindent{6.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Function}  \coqdocvar{remove\_equiv\_list} (\coqdocvar{l1} \coqdocvar{l2} : \coqdocvar{list} \coqdocvar{term}) \{\coqdockw{struct} \coqdocvar{l1}\} : (\coqdocvar{list} \coqdocvar{term}) \ensuremath{\times} (\coqdocvar{list} \coqdocvar{term}) :=\coqdoceol
\coqdocindent{2.00em}
\coqdockw{match} \coqdocvar{l1}, \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{\_}, \coqdocvar{nil} \ensuremath{\Rightarrow} (\coqdocvar{l1},\coqdocvar{l2})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{nil}, \coqdocvar{\_} \ensuremath{\Rightarrow} (\coqdocvar{l1},\coqdocvar{l2})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{a1} :: \coqdocvar{l1}, \coqdocvar{l2} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{remove\_equiv} \coqdocvar{a1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{l2'} \ensuremath{\Rightarrow}  \coqdocvar{remove\_equiv\_list} \coqdocvar{l1} \coqdocvar{l2'} \coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{7.50em}
\coqdockw{match} \coqdocvar{remove\_equiv\_list} \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{11.00em}
\ensuremath{|} (\coqdocvar{l1'},\coqdocvar{l2'}) \ensuremath{\Rightarrow} (\coqdocvar{a1} :: \coqdocvar{l1'}, \coqdocvar{l2'})\coqdoceol
\coqdocindent{7.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{remove\_equiv\_is\_sound\_some} : \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{remove\_equiv} \coqdocvar{t} \coqdocvar{l} = \coqdocvar{Some} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.00em}
\{\coqdocvar{t'} \ensuremath{|} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\land} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l} (\coqdocvar{t'} :: \coqdocvar{l'})\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{l}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a} \coqdocvar{l}]; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{R}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{equiv\_dec} \coqdocvar{t} \coqdocvar{a}) \coqdockw{as} [\coqdocvar{t\_eq\_a} \ensuremath{|} \coqdocvar{t\_diff\_a}].\coqdoceol
\coqdocnoindent
\coqdoctac{injection} \coqdocvar{R}; \coqdoctac{intro}; \coqdoctac{subst} \coqdocvar{l'}; \coqdoctac{clear} \coqdocvar{R};\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a}; \coqdoctac{split}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{remove\_equiv} \coqdocvar{t} \coqdocvar{l}) \coqdockw{as} [ \coqdocvar{l'{}'} \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{injection} \coqdocvar{R}; \coqdoctac{intro}; \coqdoctac{subst} \coqdocvar{l'}; \coqdoctac{clear} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IHl} \coqdocvar{l'{}'} (\coqdocvar{refl\_equal} \coqdocvar{\_})) \coqdockw{as} [\coqdocvar{t'} [\coqdocvar{t\_eq\_t'} \coqdocvar{P}]].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{t'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (@\coqdocvar{permut0\_cons\_inside} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv} \coqdocvar{a} \coqdocvar{a} \coqdocvar{l} (\coqdocvar{t'} :: \coqdocvar{nil}) \coqdocvar{l'{}'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{remove\_equiv\_is\_sound\_none} : \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{l}, \coqdocvar{remove\_equiv} \coqdocvar{t} \coqdocvar{l} = \coqdocvar{None} \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{t'}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t'} \coqdocvar{l} \ensuremath{\rightarrow} \ensuremath{\lnot} (\coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{l}; \coqdoceol
\coqdocnoindent
\coqdocvar{functional} \coqdoctac{induction} (\coqdocvar{remove\_equiv} \coqdocvar{t} \coqdocvar{l}) \coqdockw{as} \coqdoceol
\coqdocindent{1.00em}
[ \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{t\_eq\_a} \coqdocvar{\_} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{t\_diff\_a} \coqdocvar{\_} \coqdocvar{IH} \coqdocvar{H} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{t\_diff\_a} \coqdocvar{\_} \coqdocvar{IH} \coqdocvar{l'} \coqdocvar{H} ].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{IH}; \coqdoctac{intros} \coqdocvar{t'} [\coqdocvar{a\_eq\_t'} \ensuremath{|} \coqdocvar{t'\_mem\_l}].\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{t\_eq\_t'}; \coqdoctac{apply} \coqdocvar{t\_diff\_a}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{t'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IH}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{size2\_lex2\_bis\_prec\_eq} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{s}, \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g} \ensuremath{\rightarrow} \coqdocvar{o\_size2} (\coqdocvar{s},\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) (\coqdocvar{s}, \coqdocvar{Term} \coqdocvar{g} (\coqdocvar{t} :: \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l} \coqdocvar{s} \coqdocvar{f\_eq\_g};\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{o\_size2}, \coqdocvar{size2}, \coqdocvar{lex};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{beq\_nat\_ok} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); \coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{size} \coqdocvar{s}) (\coqdocvar{size} \coqdocvar{s})); [\coqdoctac{intros} \coqdocvar{\_} \ensuremath{|} \coqdoctac{intro} \coqdocvar{s\_diff\_s}].\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{size\_unfold}; \coqdoctac{apply} \coqdocvar{plus\_lt\_compat\_l}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} (\coqdocvar{plus\_le\_compat\_r} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l}) (\coqdocvar{size\_ge\_one} \coqdocvar{a})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{s\_diff\_s}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{remove\_equiv\_list\_is\_sound} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{l1} \coqdocvar{l2}, \coqdoceol
\coqdocindent{2.00em}
\coqdockw{match} \coqdocvar{remove\_equiv\_list} \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} (\coqdocvar{l1'},\coqdocvar{l2'}) \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{6.50em}
\{\coqdocvar{lc} \ensuremath{|} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l1} (\coqdocvar{l1'} ++ \coqdocvar{lc}) \ensuremath{\land} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l2} (\coqdocvar{l2'} ++ \coqdocvar{lc}) \ensuremath{\land}\coqdoceol
\coqdocindent{13.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{l1'} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t2} \coqdocvar{l2'} \ensuremath{\rightarrow} \ensuremath{\lnot} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2})\}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l1} \coqdocvar{l2}; \coqdoceol
\coqdocnoindent
\coqdocvar{functional} \coqdoctac{induction} (\coqdocvar{remove\_equiv\_list} \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as}\coqdoceol
\coqdocnoindent
[ \coqdocvar{l1}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{\_} \coqdocvar{l2'} \coqdocvar{H} \coqdocvar{IH} \coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'} \coqdocvar{H} \coqdocvar{IH} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{R}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} \coqdocvar{term}); \coqdoctac{simpl}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t2} \coqdocvar{l2}].\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} \coqdocvar{term}); \coqdoctac{simpl}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (@\coqdocvar{remove\_equiv\_is\_sound\_some} \coqdocvar{t1} \coqdocvar{l2} \coqdocvar{l2'} \coqdocvar{H}) \coqdockw{as} [\coqdocvar{t2} [\coqdocvar{t1\_eq\_t2} \coqdocvar{P2}]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{remove\_equiv\_list} \coqdocvar{l1} \coqdocvar{l2'}) \coqdockw{as} [\coqdocvar{l1'{}'} \coqdocvar{l2'{}'}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{IH} \coqdockw{as} [\coqdocvar{lc} [\coqdocvar{P1} [\coqdocvar{P2'} \coqdocvar{D}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{t1} :: \coqdocvar{lc}); \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P2}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{R} \coqdoctac{in} \coqdocvar{IH}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{IH} \coqdockw{as} [\coqdocvar{lc} [\coqdocvar{P1} [\coqdocvar{P2} \coqdocvar{D}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{lc}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} [\coqdocvar{t1\_eq\_u1} \ensuremath{|} \coqdocvar{u1\_mem\_l1'}] \coqdocvar{u2\_mem\_u2'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'} := @\coqdocvar{remove\_equiv\_is\_sound\_none} \coqdocvar{t1} \coqdocvar{l2} \coqdocvar{H}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{u1\_eq\_u2}; \coqdoctac{apply} (\coqdocvar{H'{}'} \coqdocvar{u2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P2}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{u1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{D}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_dec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{t1} \coqdocvar{t2}, \{\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t1} \coqdocvar{t2}\}+\{\~{}\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t1} \coqdocvar{t2}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{bb}.\coqdoceol
\coqdocnoindent
\coqdoctac{cut} (\coqdockw{\ensuremath{\forall}} \coqdocvar{p}, \coqdockw{match} \coqdocvar{p} \coqdockw{with} (\coqdocvar{t2},\coqdocvar{t1}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{15.00em}
\{\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t1} \coqdocvar{t2}\}+\{\~{}\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t1} \coqdocvar{t2}\}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H} \coqdocvar{t1} \coqdocvar{t2}; \coqdoctac{apply} (\coqdocvar{H} (\coqdocvar{t2},\coqdocvar{t1})).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{p}; \coqdoctac{pattern} \coqdocvar{p}; \coqdoctac{refine} (\coqdocvar{well\_founded\_induction} \coqdocvar{wf\_size2} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}); \coqdoctac{clear} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [[\coqdocvar{v} \ensuremath{|} \coqdocvar{f} \coqdocvar{l}] \coqdocvar{t1}] \coqdocvar{IH}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{t1\_lt\_t2}; \coqdoctac{inversion} \coqdocvar{t1\_lt\_t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \{\coqdocvar{t} \ensuremath{|} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l} \ensuremath{\land} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t1} \coqdocvar{t}\}+\{\~{}\coqdoctac{\ensuremath{\exists}} \coqdocvar{t}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l} \ensuremath{\land} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t1} \coqdocvar{t}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{l}].\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intros} [\coqdocvar{t} [\coqdocvar{t\_mem\_nil} \coqdocvar{\_}]]; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{equiv\_dec} \coqdocvar{t1} \coqdocvar{s}) \coqdockw{as} [\coqdocvar{t1\_eq\_s} \ensuremath{|} \coqdocvar{t1\_diff\_s}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{s}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IH} (\coqdocvar{s},\coqdocvar{t1})) \coqdockw{as} [\coqdocvar{t1\_lt\_s} \ensuremath{|} \coqdocvar{not\_t1\_lt\_s}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{s}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{IHl} \coqdockw{as} [\coqdocvar{Ok} \ensuremath{|} \coqdocvar{Ko}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{t2} \coqdocvar{t1'}] \coqdocvar{H}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{t2},\coqdocvar{t1'})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{o\_size2\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{t1}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_bis}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{Ok} \coqdockw{as} [\coqdocvar{t} [\coqdocvar{t\_mem\_l} \coqdocvar{t1\_le\_t}]].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intros} [\coqdocvar{t} [[\coqdocvar{s\_eq\_t} \ensuremath{|} \coqdocvar{t\_mem\_l}] \coqdocvar{t1\_le\_t}]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t1\_le\_t}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{t1\_diff\_s}; \coqdoctac{transitivity} \coqdocvar{t'}; \coqdoctac{trivial}; \coqdoctac{symmetry}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{not\_t1\_lt\_s}; \coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{s\_eq\_t}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ko}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [[\coqdocvar{t} [\coqdocvar{t\_mem\_l} \coqdocvar{t1\_le\_t}]] \ensuremath{|} \coqdocvar{H}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{t}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t1} \coqdockw{as} [\coqdocvar{v} \ensuremath{|} \coqdocvar{g} \coqdocvar{k}].\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{v\_lt\_fl}; \coqdoctac{inversion} \coqdocvar{v\_lt\_fl}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{s}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdocvar{case\_eq} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{f}); [\coqdoctac{intro} \coqdocvar{g\_eq\_f} \ensuremath{|} \coqdoctac{intro} \coqdocvar{g\_diff\_f}].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{f\_eq\_g}: \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{g} \coqdocvar{f}). \coqdoctac{rewrite} \coqdocvar{g\_eq\_f} \coqdoctac{in} \coqdocvar{H1'}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Sf\_eq\_Sg}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{g} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f}). \coqdoctac{apply} \coqdocvar{prec\_eq\_status}; \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f}); \coqdoctac{intro} \coqdocvar{Sf}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} : \{\coqdocvar{rpo\_lex} \coqdocvar{bb} \coqdocvar{k} \coqdocvar{l}\}+\{\~{}\coqdocvar{rpo\_lex} \coqdocvar{bb} \coqdocvar{k} \coqdocvar{l}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{k} \coqdocvar{IH}; \coqdoctac{clear} \coqdocvar{k} \coqdocvar{IH} \coqdocvar{H}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t} \coqdocvar{l}]; \coqdoctac{intros} \coqdocvar{k} \coqdocvar{IH}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{k\_lt\_nil}; \coqdoctac{inversion} \coqdocvar{k\_lt\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{k} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{k}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{List\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IH} (\coqdocvar{t},\coqdocvar{s})) \coqdockw{as} [\coqdocvar{s\_lt\_t} \ensuremath{|} \coqdocvar{not\_s\_lt\_t}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{List\_gt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{equiv\_dec} \coqdocvar{s} \coqdocvar{t}) \coqdockw{as} [\coqdocvar{s\_eq\_t} \ensuremath{|} \coqdocvar{s\_diff\_t}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IHl} \coqdocvar{k}) \coqdockw{as} [\coqdocvar{k\_lt\_l} \ensuremath{|} \coqdocvar{not\_k\_lt\_l}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{t2} \coqdocvar{t1}] \coqdocvar{H}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{t2},\coqdocvar{t1})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{o\_size2\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{Term} \coqdocvar{g} \coqdocvar{k}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_bis}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{List\_eq}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{sk\_lt\_tl}; \coqdoctac{inversion} \coqdocvar{sk\_lt\_tl}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{rpo\_lex} \coqdocvar{bb} \coqdocvar{k} \coqdocvar{l}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{sk\_lt\_tl}; \coqdoctac{inversion} \coqdocvar{sk\_lt\_tl}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{equiv} \coqdocvar{s} \coqdocvar{t}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{k\_lt\_l} \ensuremath{|} \coqdocvar{not\_k\_lt\_l}].\coqdoceol
\coqdocnoindent
\coqdockw{let} \coqdocvar{P} := \coqdockw{constr}:(\coqdockw{\ensuremath{\forall}} (\coqdocvar{s}:\coqdocvar{term}), \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{k} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})) \coqdoctac{in} \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'} : \{ \coqdocvar{P} \}+\{\~{}\coqdocvar{P}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{k\_lt\_l} \coqdocvar{H}; \coqdoctac{induction} \coqdocvar{k} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{k}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{intros} \coqdocvar{s} \coqdocvar{s\_mem\_nil}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IH} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{s})) \coqdockw{as} [\coqdocvar{s\_lt\_fl} \ensuremath{|} \coqdocvar{not\_s\_lt\_fl}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex2}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{IHk} \coqdockw{as} [\coqdocvar{Ok} \ensuremath{|} \coqdocvar{Ko}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{t2} \coqdocvar{t1}] \coqdocvar{H'}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{t2},\coqdocvar{t1})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{o\_size2\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{Term} \coqdocvar{f} \coqdocvar{k}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex2\_bis\_prec\_eq}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{intros} \coqdocvar{s'} [\coqdocvar{s\_eq\_s'} \ensuremath{|} \coqdocvar{s'\_mem\_k}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{s\_eq\_s'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ok}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{Ko}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s'} \coqdocvar{s'\_mem\_k}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{not\_s\_lt\_fl}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'{}'} \coqdockw{as} [\coqdocvar{Ok} \ensuremath{|} \coqdocvar{Ko}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{eq\_nat\_dec} (\coqdocvar{length} \coqdocvar{l}) (\coqdocvar{length} \coqdocvar{k})).\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{Top\_eq\_lex}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{Sf\_eq\_Sg}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{le\_lt\_dec} (\coqdocvar{length} \coqdocvar{k}) \coqdocvar{bb}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{le\_lt\_dec} (\coqdocvar{length} \coqdocvar{l}) \coqdocvar{bb}).\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{Top\_eq\_lex}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{Sf\_eq\_Sg}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdoctac{right}; \coqdoctac{split};  \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{fk\_lt\_fl}; \coqdoctac{inversion} \coqdocvar{fk\_lt\_fl}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{s}; \coqdoctac{split}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{f}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H7} \coqdockw{as} [\coqdocvar{H7} \ensuremath{|} [\coqdocvar{H7} \coqdocvar{H7'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{n}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_irrefl} \coqdockw{with} \coqdocvar{bb}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_le\_trans} \coqdockw{with} (\coqdocvar{length} \coqdocvar{l}); \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{Sf}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{fk\_lt\_fl}; \coqdoctac{inversion} \coqdocvar{fk\_lt\_fl}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{s}; \coqdoctac{split}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6}: \coqdocvar{False}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{f}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H6}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H7} \coqdockw{as} [\coqdocvar{H7} \ensuremath{|} [\coqdocvar{H7} \coqdocvar{H7'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{n}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_irrefl} \coqdockw{with} \coqdocvar{bb}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_le\_trans} \coqdockw{with} (\coqdocvar{length} \coqdocvar{k}); \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{Sf}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{right};  \coqdoctac{intro} \coqdocvar{fk\_lt\_fl}; \coqdoctac{inversion} \coqdocvar{fk\_lt\_fl}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ko}; \coqdoctac{intros} \coqdocvar{s'} \coqdocvar{s'\_mem\_k}; \coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{k}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{s'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{Ko}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{Ko}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{Sf}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{right} ; \coqdoctac{intro} \coqdocvar{fk\_lt\_fl}; \coqdoctac{inversion} \coqdocvar{fk\_lt\_fl}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{s}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6}: \coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{f}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H6}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{not\_k\_lt\_l}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{Sf}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{remove\_equiv\_list\_is\_sound} \coqdocvar{k} \coqdocvar{l}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{remove\_equiv\_list} \coqdocvar{k} \coqdocvar{l}) \coqdockw{as} [\coqdocvar{k'} \coqdocvar{l'}];\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{lc} [\coqdocvar{Pk} [\coqdocvar{Pl} \coqdocvar{D}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Rem} : \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{k} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{k'} \coqdocvar{l'}).\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l} \coqdocvar{k} \coqdocvar{l'} \coqdocvar{k'} \coqdocvar{Pk} \coqdocvar{Pl}; \coqdoctac{clear} \coqdocvar{l} \coqdocvar{k} \coqdocvar{l'} \coqdocvar{k'} \coqdocvar{Pk} \coqdocvar{Pl} \coqdocvar{D} \coqdocvar{IH} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{lc} \coqdockw{as} [ \ensuremath{|} \coqdocvar{c} \coqdocvar{lc}]; \coqdoctac{intros} \coqdocvar{l} \coqdocvar{k} \coqdocvar{l'} \coqdocvar{k'} \coqdocvar{Pk} \coqdocvar{Pl} \coqdocvar{k\_lt\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{k\_lt\_l} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Rk} \coqdocvar{Rl} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{k}; \coqdoctac{trivial}; \coqdoctac{symmetry}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end} \coqdoctac{in} \coqdocvar{Pk}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{l}; \coqdoctac{trivial}; \coqdoctac{symmetry}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end} \coqdoctac{in} \coqdocvar{Pl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} := \coqdocvar{IHlc} \coqdocvar{l} \coqdocvar{k} (\coqdocvar{l'} ++ \coqdocvar{c} :: \coqdocvar{nil}) (\coqdocvar{k'} ++ \coqdocvar{c} :: \coqdocvar{nil})).\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ass\_app} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{H} \coqdocvar{Pk} \coqdocvar{Pl} \coqdocvar{k\_lt\_l}); \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{rpo\_mul\_remove\_equiv\_aux} \coqdocvar{bb} \coqdocvar{k'} \coqdocvar{l'} \coqdocvar{c} \coqdocvar{c}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{rpo\_antirefl}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Rk} \coqdocvar{Rl} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{Rk}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside};[|\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{reflexivity}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{Rl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside};[|\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{reflexivity}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{let} \coqdocvar{P} := \coqdockw{constr}:(\coqdockw{\ensuremath{\forall}} \coqdocvar{u}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{u} \coqdocvar{k'} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{v},  \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{v} \coqdocvar{l'} \ensuremath{\land} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{v}) \coqdoctac{in} \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} : \{\coqdocvar{P}\} + \{\~{} \coqdocvar{P}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IH'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{u} \coqdocvar{v}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{u} \coqdocvar{k'} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{v} \coqdocvar{l'} \ensuremath{\rightarrow} \{\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{v}\}+\{\~{}\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{v}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{v} \coqdocvar{u\_mem\_k'} \coqdocvar{v\_mem\_l'}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{v},\coqdocvar{u})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex1\_mem}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Pl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l'} \coqdocvar{IH'}; \coqdoctac{clear} \coqdocvar{l} \coqdocvar{k} \coqdocvar{IH} \coqdocvar{H} \coqdocvar{l'} \coqdocvar{lc} \coqdocvar{Pk} \coqdocvar{Pl} \coqdocvar{D} \coqdocvar{IH'} \coqdocvar{Rem}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{k'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{u'} \coqdocvar{k'}]; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{IH'}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{let} \coqdocvar{P}:=\coqdockw{constr}:(\coqdockw{\ensuremath{\forall}} \coqdocvar{v}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{v} \coqdocvar{l'} \ensuremath{\rightarrow} \ensuremath{\lnot}\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u'} \coqdocvar{v}) \coqdoctac{in} \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \{\coqdocvar{v} \ensuremath{|} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{v} \coqdocvar{l'} \ensuremath{\land} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u'} \coqdocvar{v}\}+\{\coqdocvar{P}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IH'{}'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{v}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{v} \coqdocvar{l'} \ensuremath{\rightarrow} \{\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u'} \coqdocvar{v}\}+\{\~{}\coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{u'} \coqdocvar{v}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v} \coqdocvar{v\_mem\_l'}; \coqdoctac{apply} (\coqdocvar{IH'} \coqdocvar{u'} \coqdocvar{v}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{IHk'} \coqdocvar{IH'}; \coqdoctac{induction} \coqdocvar{l'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{v'} \coqdocvar{l'}].\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{IHl'} \coqdockw{as} [\coqdocvar{Ok} \ensuremath{|} \coqdocvar{Ko}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IH'{}'}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{Ok} \coqdockw{as} [\coqdocvar{v} [\coqdocvar{v\_mem\_l'} \coqdocvar{u'\_lt\_v}]]; \coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{v}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IH'{}'} \coqdocvar{v'}) \coqdockw{as} [\coqdocvar{Ok'} \ensuremath{|} \coqdocvar{Ko'}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{v'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intros} \coqdocvar{v} [\coqdocvar{v'\_eq\_v} \ensuremath{|} \coqdocvar{v\_mem\_l'}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u'\_lt\_v}; \coqdoctac{apply} \coqdocvar{Ko'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{v'\_eq\_v}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ko}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [[\coqdocvar{v} [\coqdocvar{v\_mem\_l'} \coqdocvar{u'\_lt\_v}]] \ensuremath{|} \coqdocvar{Ko}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IHk'} \coqdocvar{l'}) \coqdockw{as} [\coqdocvar{Ok'} \ensuremath{|} \coqdocvar{Ko'}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{v'} \coqdocvar{u\_mem\_k'} \coqdocvar{v'\_mem\_l'}; \coqdoctac{apply} \coqdocvar{IH'}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{intros} \coqdocvar{u} [\coqdocvar{u'\_eq\_u} \ensuremath{|} \coqdocvar{u\_mem\_k'}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{v}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u'\_eq\_u}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ok'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{Ko'}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_mem\_k'}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H} \coqdocvar{u'}) \coqdockw{as} [\coqdocvar{v} [\coqdocvar{v\_mem\_l'} \coqdocvar{u'\_lt\_v}]].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Ko} \coqdocvar{v}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{v'} \coqdocvar{l'}].\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{fk\_lt\_fl}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{fk\_lt\_fl} \coqdockw{as} [\coqdocvar{f'} \coqdocvar{l'} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'\_mem\_l} \coqdocvar{fk\_le\_t'}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{f\_prec\_f} \coqdocvar{k'{}'\_lt\_fl}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sg'} \coqdocvar{f'\_eq\_g'} \coqdocvar{L} \coqdocvar{k'{}'\_lt\_l'{}'} \coqdocvar{l'\_lt\_t}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{g'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sg'} \coqdocvar{f'\_eq\_g'} \coqdocvar{k\_lt\_l} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5}:\coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{f}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H5}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Sf} \coqdoctac{in} \coqdocvar{Sg'}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{k'\_lt\_nil} := \coqdocvar{Rem} \coqdocvar{k\_lt\_l}).\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{k'\_lt\_nil} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Rk} \coqdocvar{Rl} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{L} := \coqdocvar{permut\_length} \coqdocvar{Rl}); \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{Ok} \ensuremath{|} \coqdocvar{Ko}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{Top\_eq\_mul}; \coqdoctac{trivial}. \coqdoctac{rewrite} \coqdocvar{Sf\_eq\_Sg}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} \coqdocvar{v'} \coqdocvar{l'} \coqdocvar{k'} \coqdocvar{lc}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{fk\_lt\_fl}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{fk\_lt\_fl} \coqdockw{as} [\coqdocvar{f'} \coqdocvar{l'{}'} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'\_mem\_l} \coqdocvar{fk\_le\_t'}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{f\_prec\_f} \coqdocvar{k'{}'\_lt\_fl}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sf'{}'} \coqdocvar{f'\_eq\_f'{}'} \coqdocvar{L} \coqdocvar{k'{}'\_lt\_l'{}'} \coqdocvar{l'\_lt\_t}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sf'{}'} \coqdocvar{f'\_eq\_f'{}'} \coqdocvar{k\_lt\_l} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Pl} \coqdoctac{in} \coqdocvar{t'\_mem\_l}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{t'\_mem\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t'\_mem\_l} \coqdockw{as} [\coqdocvar{t'\_mem\_vl'} \ensuremath{|} \coqdocvar{t'\_mem\_lc}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ko}; \coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_mem\_k'}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{fk\_le\_t'}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (@\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{k}) \coqdocvar{t'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{u}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Pk}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{k}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{u}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Pk}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{bb} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{k})).\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{fk\_le\_t'}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} (\coqdocvar{Term} \coqdocvar{g} \coqdocvar{k}) \coqdocvar{t'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{t'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Pk}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} \coqdocvar{t'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{t'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Pk}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5}:\coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{f}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H5}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Sf} \coqdoctac{in} \coqdocvar{Sf'{}'}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{k'\_lt\_vl'} := \coqdocvar{Rem} \coqdocvar{k\_lt\_l}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ko}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{k'\_lt\_vl'} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Rk} \coqdocvar{Rl} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{u}; \coqdoctac{rewrite} \coqdocvar{Rk}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{u\_mem\_ls} \ensuremath{|} \coqdocvar{u\_mem\_lc'}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{\_} \coqdocvar{u\_mem\_ls}) \coqdockw{as} [\coqdocvar{a'} [\coqdocvar{a'\_mem\_alg} \coqdocvar{u\_lt\_a'}]];\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Rl}; \coqdoctac{rewrite} \coqdocvar{app\_comm\_cons};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} \coqdocvar{False}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{D} \coqdocvar{u} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Rk}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Rl}; \coqdoctac{rewrite} \coqdocvar{app\_comm\_cons};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{prec\_bool\_ok} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{f}); \coqdoctac{case} (\coqdocvar{prec\_bool} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{f}); [\coqdoctac{intro} \coqdocvar{g\_prec\_f} \ensuremath{|} \coqdoctac{intro} \coqdocvar{not\_g\_prec\_f}].\coqdoceol
\coqdocnoindent
\coqdockw{let} \coqdocvar{P}:=\coqdockw{constr}:(\coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{k} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})) \coqdoctac{in} \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} : \{\coqdocvar{P}\}+\{\~{}\coqdocvar{P}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H}; \coqdoctac{induction} \coqdocvar{k} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{k}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IH} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l},\coqdocvar{s})) \coqdockw{as} [\coqdocvar{s\_lt\_fl} \ensuremath{|} \coqdocvar{not\_s\_lt\_fl}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex2}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{IHk} \coqdockw{as} [\coqdocvar{Ok} \ensuremath{|} \coqdocvar{Ko}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{t2} \coqdocvar{t1}] \coqdocvar{St}; \coqdoctac{apply} (\coqdocvar{IH} (\coqdocvar{t2},\coqdocvar{t1})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{o\_size2\_trans} \coqdockw{with} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{Term} \coqdocvar{g} \coqdocvar{k}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size2\_lex2\_bis}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{intros} \coqdocvar{t} [\coqdocvar{t\_eq\_s} \ensuremath{|} \coqdocvar{t\_mem\_k}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{t\_eq\_s}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ok}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{sk\_lt\_fl}; \coqdoctac{apply} \coqdocvar{Ko}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{sk\_lt\_fl}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{sk\_lt\_fl}; \coqdoctac{apply} \coqdocvar{not\_s\_lt\_fl}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{sk\_lt\_fl}; \coqdoctac{left}; \coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{Ok} \ensuremath{|} \coqdocvar{Ko}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{Top\_gt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{gk\_lt\_fl};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{gk\_lt\_fl} \coqdockw{as} [\coqdocvar{f'} \coqdocvar{l'{}'} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'\_mem\_l} \coqdocvar{fk\_le\_t'}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{f\_prec\_f} \coqdocvar{k'{}'\_lt\_fl}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sf'{}'} \coqdocvar{f'\_eq\_f'{}'} \coqdocvar{L} \coqdocvar{k'{}'\_lt\_l'{}'} \coqdocvar{l'\_lt\_t}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sf'{}'} \coqdocvar{f'\_eq\_f'{}'} \coqdocvar{k\_lt\_l} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ko}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f}); \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_prec2} \coqdockw{with} \coqdocvar{g}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{prec\_eq\_prec2} \coqdockw{with} \coqdocvar{g}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{gk\_lt\_fl};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{gk\_lt\_fl} \coqdockw{as} [\coqdocvar{f'} \coqdocvar{l'{}'} \coqdocvar{t'{}'} \coqdocvar{t'} \coqdocvar{t'\_mem\_l} \coqdocvar{fk\_le\_t'}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{f\_prec\_f} \coqdocvar{k'{}'\_lt\_fl}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sf'{}'} \coqdocvar{f'\_eq\_f'{}'} \coqdocvar{L} \coqdocvar{k'{}'\_lt\_l'{}'} \coqdocvar{l'\_lt\_t}\coqdoceol
\coqdocindent{14.00em}
\ensuremath{|} \coqdocvar{f'} \coqdocvar{f'{}'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Sf'} \coqdocvar{Sf'{}'} \coqdocvar{f'\_eq\_f'{}'} \coqdocvar{k\_lt\_l} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{prec} \coqdocvar{Prec} \coqdocvar{g} \coqdocvar{f}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5}:=\coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H5'}:= \coqdocvar{H5} \coqdocvar{g} \coqdocvar{f}). \coqdoctac{rewrite} \coqdocvar{g\_diff\_f} \coqdoctac{in} \coqdocvar{H5'}. \coqdocvar{contradict} \coqdocvar{H5'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5}:=\coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H5'}:= \coqdocvar{H5} \coqdocvar{g} \coqdocvar{f}). \coqdoctac{rewrite} \coqdocvar{g\_diff\_f} \coqdoctac{in} \coqdocvar{H5'}. \coqdocvar{contradict} \coqdocvar{H5'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{trans\_clos\_subterm\_rpo}:\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t},  (\coqdocvar{trans\_clos} \coqdocvar{direct\_subterm}) \coqdocvar{s} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{bb} \coqdocvar{s} \coqdocvar{t} \coqdocvar{H}; \coqdoctac{induction} \coqdocvar{H} \coqdockw{as} [ \coqdocvar{s} [ \coqdocvar{v} \ensuremath{|} \coqdocvar{f} \coqdocvar{l} ] \coqdocvar{H} \ensuremath{|} \coqdocvar{s} \coqdocvar{t} \coqdocvar{u} \coqdocvar{H1} \coqdocvar{H2}].\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{Subterm} \coqdocvar{bb} \coqdocvar{f} \coqdocvar{l} \coqdocvar{s} \coqdocvar{s}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{rpo\_subterm} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{t}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{prec\_eval} \coqdocvar{f1} \coqdocvar{f2} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{if} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}) \coqdoceol
\coqdocindent{1.00em}
\coqdockw{then} \coqdocvar{Equivalent}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{else} \coqdoceol
\coqdocindent{2.50em}
\coqdockw{if} \coqdocvar{prec\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2} \coqdockw{then} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{else} \coqdoceol
\coqdocindent{4.00em}
\coqdockw{if} \coqdocvar{prec\_bool} \coqdocvar{Prec} \coqdocvar{f2} \coqdocvar{f1} \coqdockw{then} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{else} \coqdocvar{Uncomparable}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{prec\_eval\_is\_sound} :  \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{f1} \coqdocvar{f2}, \coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvar{prec\_eval} \coqdocvar{f1} \coqdocvar{f2} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f1}  \coqdocvar{f2}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{prec} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{prec} \coqdocvar{Prec} \coqdocvar{f2} \coqdocvar{f1} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \ensuremath{\lnot} \coqdocvar{prec\_eq} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2} \ensuremath{\land} \ensuremath{\lnot}\coqdocvar{prec} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2} \ensuremath{\land} \ensuremath{\lnot}\coqdocvar{prec} \coqdocvar{Prec} \coqdocvar{f2} \coqdocvar{f1}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{f1} \coqdocvar{f2}; \coqdoctac{unfold} \coqdocvar{prec\_eval}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H1'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{prec\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{prec\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H1'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{prec\_bool} \coqdocvar{Prec} \coqdocvar{f2} \coqdocvar{f1}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{prec'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{prec\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{f2} \coqdocvar{f1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{prec'} \coqdoctac{in} \coqdocvar{H1'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H3'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H3'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f2} \coqdocvar{f1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} \coqdocvar{H3'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{result} (\coqdocvar{A} : \coqdockw{Set}) : \coqdockw{Set} := \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Not\_found} : \coqdocvar{result} \coqdocvar{A}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Not\_finished} : \coqdocvar{result} \coqdocvar{A}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Found} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{result} \coqdocvar{A}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Record} \coqdocvar{rpo\_inf} : \coqdockw{Set} := \coqdoceol
\coqdocindent{1.00em}
\{ \coqdocvar{bb} : \coqdocvar{nat};\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{rpo\_l} : \coqdocvar{list} (\coqdocvar{term}\ensuremath{\times}\coqdocvar{term});\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{rpo\_eq\_l} : \coqdocvar{list} (\coqdocvar{term}\ensuremath{\times}\coqdocvar{term});\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{equiv\_l} : \coqdocvar{list} (\coqdocvar{term}\ensuremath{\times}\coqdocvar{term});\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{rpo\_l\_valid} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{In} (\coqdocvar{t},\coqdocvar{t'}) \coqdocvar{rpo\_l} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'};\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{rpo\_eq\_valid} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{In} (\coqdocvar{t},\coqdocvar{t'}) \coqdocvar{rpo\_eq\_l} \ensuremath{\rightarrow} \coqdocvar{rpo\_eq} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{t'};\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{equiv\_l\_valid} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{In} (\coqdocvar{t},\coqdocvar{t'}) \coqdocvar{equiv\_l} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{t'}\coqdoceol
\coqdocindent{1.00em}
\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Function} \coqdocvar{remove\_equiv\_eval} (\coqdocvar{p} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{bool}) \coqdoceol
\coqdocindent{2.00em}
(\coqdocvar{t} : \coqdocvar{term}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{term}) \{\coqdockw{struct} \coqdocvar{l}\} : \coqdocvar{result} (\coqdocvar{list} \coqdocvar{term}) :=\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{l} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{nil} \ensuremath{\Rightarrow} @\coqdocvar{Not\_found} \coqdocvar{\_}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{a} :: \coqdocvar{l} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{6.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{t} \coqdocvar{a} \coqdockw{with}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} (\coqdocvar{Found} \coqdocvar{l})\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{7.50em}
\coqdockw{match} \coqdocvar{remove\_equiv\_eval} \coqdocvar{p} \coqdocvar{t} \coqdocvar{l}  \coqdockw{with}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqdocvar{Found} \coqdocvar{l'} \ensuremath{\Rightarrow} \coqdocvar{Found}  (\coqdocvar{a} :: \coqdocvar{l'})\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqdocvar{Not\_found} \coqdocvar{\_} \ensuremath{\Rightarrow} @\coqdocvar{Not\_found} \coqdocvar{\_}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqdocvar{Not\_finished} \coqdocvar{\_} \ensuremath{\Rightarrow} @\coqdocvar{Not\_finished} \coqdocvar{\_}\coqdoceol
\coqdocindent{7.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} @\coqdocvar{Not\_finished} \coqdocvar{\_}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{end} \coqdoceol
\coqdocindent{6.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Function}  \coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{p} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{bool}) (\coqdocvar{l1} \coqdocvar{l2} : \coqdocvar{list} \coqdocvar{term}) \coqdoceol
\coqdocindent{1.00em}
\{\coqdockw{struct} \coqdocvar{l1}\} : \coqdocvar{option} ((\coqdocvar{list} \coqdocvar{term}) \ensuremath{\times} (\coqdocvar{list} \coqdocvar{term})):=\coqdoceol
\coqdocindent{2.00em}
\coqdockw{match} \coqdocvar{l1}, \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{\_}, \coqdocvar{nil} \ensuremath{\Rightarrow} \coqdocvar{Some} (\coqdocvar{l1},\coqdocvar{l2})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{nil}, \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} (\coqdocvar{l1},\coqdocvar{l2})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{a1} :: \coqdocvar{l1}, \coqdocvar{l2} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{remove\_equiv\_eval} \coqdocvar{p} \coqdocvar{a1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Found} \coqdocvar{l2'} \ensuremath{\Rightarrow}  \coqdocvar{remove\_equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2'} \coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Not\_found} \coqdocvar{\_} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{11.00em}
\coqdockw{match} \coqdocvar{remove\_equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{11.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{l1'},\coqdocvar{l2'}) \ensuremath{\Rightarrow} \coqdocvar{Some} (\coqdocvar{a1} :: \coqdocvar{l1'}, \coqdocvar{l2'})\coqdoceol
\coqdocindent{11.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{11.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Not\_finished} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Function} \coqdocvar{equiv\_eval\_list} (\coqdocvar{p} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{bool}) (\coqdocvar{l1} \coqdocvar{l2} : \coqdocvar{list} \coqdocvar{term}) \coqdoceol
\coqdocnoindent
\{\coqdockw{struct} \coqdocvar{l1}\} : \coqdocvar{option} \coqdocvar{bool} := \coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{l1}, \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{nil}, \coqdocvar{nil} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} (\coqdocvar{a} :: \coqdocvar{l}), (\coqdocvar{b} :: \coqdocvar{l'}) \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{7.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{a} \coqdocvar{b} \coqdockw{with}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l} \coqdocvar{l'}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{\_}, \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{eq\_tt\_bool} \coqdocvar{t12} \coqdocvar{t12'} := \coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{t12}, \coqdocvar{t12'} \coqdockw{with} \coqdoceol
\coqdocnoindent
(\coqdocvar{t1},\coqdocvar{t2}), (\coqdocvar{t1'},\coqdocvar{t2'}) \ensuremath{\Rightarrow} \coqdocvar{andb} (\coqdocvar{eq\_bool} \coqdocvar{t1} \coqdocvar{t1'}) (\coqdocvar{eq\_bool} \coqdocvar{t2} \coqdocvar{t2'})\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{eq\_tt\_bool\_ok} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t12} \coqdocvar{t12'}, \coqdockw{match} \coqdocvar{eq\_tt\_bool} \coqdocvar{t12} \coqdocvar{t12'} \coqdockw{with} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{t12} = \coqdocvar{t12'} \ensuremath{|} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{t12} \ensuremath{\not=} \coqdocvar{t12'} \coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{eq\_tt\_bool}; \coqdoctac{intros} [\coqdocvar{t1} \coqdocvar{t2}] [\coqdocvar{t1'} \coqdocvar{t2'}]; \coqdoctac{generalize} (\coqdocvar{eq\_bool\_ok} \coqdocvar{t1} \coqdocvar{t1'}); \coqdoctac{case} (\coqdocvar{eq\_bool} \coqdocvar{t1} \coqdocvar{t1'}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{t1\_eq\_t1'}; \coqdoctac{generalize} (\coqdocvar{eq\_bool\_ok} \coqdocvar{t2} \coqdocvar{t2'}); \coqdoctac{case} (\coqdocvar{eq\_bool} \coqdocvar{t2} \coqdocvar{t2'}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{t2\_eq\_t2'}; \coqdoctac{simpl}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{t2\_diff\_t2'}; \coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{t2\_diff\_t2'}; \coqdoctac{injection} \coqdocvar{H}; \coqdoctac{intros}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{t1\_diff\_t1'}; \coqdoctac{simpl}; \coqdoctac{intro} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{t1\_diff\_t1'}; \coqdoctac{injection} \coqdocvar{H}; \coqdoctac{intros}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} (\coqdocvar{n} : \coqdocvar{nat}) (\coqdocvar{t1} \coqdocvar{t2} : \coqdocvar{term}) \{\coqdockw{struct} \coqdocvar{n}\} : \coqdocvar{option} \coqdocvar{bool} := \coqdoceol
\coqdocindent{1.50em}
\coqdockw{match} \coqdocvar{n} \coqdockw{with}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} 0 \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{S} \coqdocvar{m} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{t1}, \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Var} \coqdocvar{v1}, \coqdocvar{Var} \coqdocvar{v2} \ensuremath{\Rightarrow} \coqdocvar{Some} (\coqdocvar{X.eq\_bool} \coqdocvar{v1} \coqdocvar{v2})\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}, \coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{if} \coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool}  (\coqdocvar{t1}, \coqdocvar{t2}) \coqdocvar{rpo\_infos}.(\coqdocvar{equiv\_l})\coqdoceol
\coqdocindent{4.50em}
\coqdockw{then}  \coqdocvar{Some} \coqdocvar{true} \coqdoceol
\coqdocindent{4.50em}
\coqdockw{else}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{if} \coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2} \coqdoceol
\coqdocindent{6.50em}
\coqdockw{then} \coqdoceol
\coqdocindent{7.50em}
\coqdockw{match} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} \coqdockw{with}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqdocvar{Lex} \ensuremath{\Rightarrow}  \coqdocvar{equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m}) \coqdocvar{l1} \coqdocvar{l2}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqdocvar{Mul} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{9.50em}
\coqdockw{match} \coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m}) \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{nil},\coqdocvar{nil}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{9.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{7.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{else} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{\_}, \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_eval\_equation} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} =\coqdoceol
\coqdocindent{1.50em}
\coqdockw{match} \coqdocvar{n} \coqdockw{with}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} 0 \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{S} \coqdocvar{m} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{t1}, \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Var} \coqdocvar{v1}, \coqdocvar{Var} \coqdocvar{v2} \ensuremath{\Rightarrow} \coqdocvar{Some} (\coqdocvar{X.eq\_bool} \coqdocvar{v1} \coqdocvar{v2})\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}, \coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{if} \coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{rpo\_infos}.(\coqdocvar{equiv\_l})\coqdoceol
\coqdocindent{4.50em}
\coqdockw{then}  \coqdocvar{Some} \coqdocvar{true} \coqdoceol
\coqdocindent{4.50em}
\coqdockw{else}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{if} \coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2} \coqdoceol
\coqdocindent{6.50em}
\coqdockw{then} \coqdoceol
\coqdocindent{7.50em}
\coqdockw{match} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} \coqdockw{with}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqdocvar{Lex} \ensuremath{\Rightarrow}  \coqdocvar{equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m}) \coqdocvar{l1} \coqdocvar{l2}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqdocvar{Mul} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{9.50em}
\coqdockw{match} \coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m}) \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{nil},\coqdocvar{nil}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{9.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{7.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{else} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{\_}, \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} [ \ensuremath{|} \coqdocvar{n}] [\coqdocvar{v1} \ensuremath{|} \coqdocvar{f1} \coqdocvar{l1}] [\coqdocvar{v2} \ensuremath{|} \coqdocvar{f2} \coqdocvar{l2}];\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{equiv\_eval}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_eval\_list\_is\_sound} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}, \coqdockw{match} \coqdocvar{equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{length} \coqdocvar{l1} = \coqdocvar{length} \coqdocvar{l2} \ensuremath{\land} \coqdoceol
\coqdocindent{15.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) (\coqdocvar{combine} \coqdocvar{l1} \coqdocvar{l2}) \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{true})\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{length} \coqdocvar{l1} \ensuremath{\not=} \coqdocvar{length} \coqdocvar{l2} \ensuremath{\lor}\coqdoceol
\coqdocindent{15.50em}
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}, \coqdoceol
\coqdocindent{16.50em}
\coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) (\coqdocvar{combine} \coqdocvar{l1} \coqdocvar{l2}) \ensuremath{\land} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{false})\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) (\coqdocvar{combine} \coqdocvar{l1} \coqdocvar{l2}) \ensuremath{\land}\coqdoceol
\coqdocindent{14.00em}
\coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{None}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{l1}; \coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros} [ \ensuremath{|} \coqdocvar{t2} \coqdocvar{l2}]; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \coqdockw{\ensuremath{\forall}} \coqdocvar{u2}, \coqdocvar{u2} = \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{u2} = \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{generalize} (\coqdocvar{H} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})); \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHl1} \coqdocvar{l2}); \coqdoctac{destruct} (\coqdocvar{equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{L} \coqdocvar{H'}]; \coqdoctac{repeat} \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{L}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t3} \coqdocvar{t4} [\coqdocvar{t3t4\_eq\_t1t2} \ensuremath{|} \coqdocvar{t3t4\_in\_ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{injection} \coqdocvar{t3t4\_eq\_t1t2}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{L} \ensuremath{|} [\coqdocvar{t3} [\coqdocvar{t4} [\coqdocvar{H'} \coqdocvar{H'{}'}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{intros} \coqdocvar{H'{}'}; \coqdoctac{apply} \coqdocvar{L}; \coqdoctac{injection} \coqdocvar{H'{}'}; \coqdoctac{intros}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t3}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t4}; \coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{t3} [\coqdocvar{t4} [\coqdocvar{H'} \coqdocvar{H'{}'}]]]; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t3}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t4}; \coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{remove\_equiv\_eval\_is\_sound} : \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{t} \coqdocvar{l}, \coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{remove\_equiv\_eval} \coqdocvar{p} \coqdocvar{t} \coqdocvar{l} \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Found} \coqdocvar{l'} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{8.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{t'}, \coqdocvar{p} \coqdocvar{t} \coqdocvar{t'} = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\land} \coqdoceol
\coqdocindent{9.50em}
\coqdocvar{list\_permut.permut0} (@\coqdocvar{eq} \coqdocvar{term}) \coqdocvar{l} (\coqdocvar{t'} :: \coqdocvar{l'})\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Not\_found} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{t'}, \coqdocvar{In} \coqdocvar{t'} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t} \coqdocvar{t'} = \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Not\_finished} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{t'}, \coqdocvar{In} \coqdocvar{t'} \coqdocvar{l} \ensuremath{\land} \coqdocvar{p} \coqdocvar{t} \coqdocvar{t'} = \coqdocvar{None}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{t} \coqdocvar{l}; \coqdoceol
\coqdocnoindent
\coqdocvar{functional} \coqdoctac{induction} (\coqdocvar{remove\_equiv\_eval} \coqdocvar{p} \coqdocvar{t} \coqdocvar{l}) \coqdockw{as} \coqdoceol
\coqdocindent{1.00em}
[ \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{H} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{H} \coqdocvar{IH} \coqdocvar{l'} \coqdocvar{H'} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{H} \coqdocvar{IH} \coqdocvar{H'} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{H} \coqdocvar{IH} \coqdocvar{H'} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{H}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a}; \coqdoctac{split}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_permut.permut\_refl}; \coqdoctac{intro}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'} \coqdoctac{in} \coqdocvar{IH}; \coqdoctac{destruct} \coqdocvar{IH} \coqdockw{as} [\coqdocvar{t'} [\coqdocvar{H'{}'} \coqdocvar{P}]]; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Pcons} (\coqdocvar{R} := @\coqdocvar{eq} \coqdocvar{term}) \coqdocvar{a} \coqdocvar{a} (\coqdocvar{l} := \coqdocvar{l}) (\coqdocvar{t'} :: \coqdocvar{nil}) \coqdocvar{l'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'} \coqdoctac{in} \coqdocvar{IH}; \coqdoctac{intros} \coqdocvar{t'} [\coqdocvar{a\_eq\_t'} \ensuremath{|} \coqdocvar{t'\_in\_l}]; [\coqdoctac{subst} \ensuremath{|} \coqdoctac{apply} \coqdocvar{IH}]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'} \coqdoctac{in} \coqdocvar{IH}; \coqdoctac{destruct} \coqdocvar{IH} \coqdockw{as} [\coqdocvar{t'} [\coqdocvar{t'\_in\_l} \coqdocvar{ptt'\_eq\_none}]]; \coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{t'}; \coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a}; \coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{remove\_equiv\_eval\_list\_is\_sound} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}, \coqdoceol
\coqdocindent{2.00em}
\coqdockw{match} \coqdocvar{remove\_equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{l1'},\coqdocvar{l2'}) \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{7.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{ll}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{true}) \ensuremath{\land}\coqdoceol
\coqdocindent{8.00em}
\coqdocvar{list\_permut.permut0} (@\coqdocvar{eq} \coqdocvar{term}) \coqdocvar{l1} (\coqdocvar{l1'} ++ (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll})) \ensuremath{\land}\coqdoceol
\coqdocindent{8.00em}
\coqdocvar{list\_permut.permut0} (@\coqdocvar{eq} \coqdocvar{term}) \coqdocvar{l2} (\coqdocvar{l2'} ++ (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll})) \ensuremath{\land}\coqdoceol
\coqdocindent{8.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1'} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2'} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{false})\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\land} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\land} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{None}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}; \coqdoceol
\coqdocnoindent
\coqdocvar{functional} \coqdoctac{induction} (\coqdocvar{remove\_equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as}\coqdoceol
\coqdocnoindent
[ \coqdocvar{l1}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'} \coqdocvar{l2'} \coqdocvar{H} \coqdocvar{IH} \coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'} \coqdocvar{H} \coqdocvar{IH} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{R}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'} \coqdocvar{H} \coqdocvar{IH} \coqdocvar{R}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'} \coqdocvar{H}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{simpl}; \coqdoctac{intuition}; \coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end}; \coqdoctac{apply} \coqdocvar{list\_permut.permut\_refl}; \coqdoctac{intro}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_permut.permut\_refl}; \coqdoctac{intro}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t2} \coqdocvar{l2}].\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{simpl}; \coqdoctac{intuition}; \coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_permut.permut\_refl}; \coqdoctac{intro}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end}; \coqdoctac{apply} \coqdocvar{list\_permut.permut\_refl}; \coqdoctac{intro}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{K} := \coqdocvar{remove\_equiv\_eval\_is\_sound} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{l2}); \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{K}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{K} \coqdockw{as} [\coqdocvar{t2'} [\coqdocvar{pt1t2\_eq\_true} \coqdocvar{P}]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{remove\_equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2'}) \coqdockw{as} [ [\coqdocvar{l1'{}'} \coqdocvar{l2'{}'}] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{IH} \coqdockw{as} [\coqdocvar{ll} [\coqdocvar{E\_ll} [\coqdocvar{P1} [\coqdocvar{P2} \coqdocvar{F}]]]]; \coqdoctac{\ensuremath{\exists}} ((\coqdocvar{t1},\coqdocvar{t2'}) :: \coqdocvar{ll}); \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} [\coqdocvar{u1u2\_eq\_t1t2'} \ensuremath{|} \coqdocvar{u1u2\_in\_ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{injection} \coqdocvar{u1u2\_eq\_t1t2'}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{pt1t2\_eq\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{E\_ll}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Pcons}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_permut.permut\_trans} \coqdockw{with} (\coqdocvar{t2'} :: \coqdocvar{l2'}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a} \coqdocvar{b} \coqdocvar{c} \coqdocvar{\_} \coqdocvar{a\_eq\_b} \coqdocvar{b\_eq\_c}; \coqdoctac{transitivity} \coqdocvar{b}; \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{Pcons}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{IH} \coqdockw{as} [\coqdocvar{t1'} [\coqdocvar{t2} [\coqdocvar{t1\_in\_l1} [\coqdocvar{t2\_in\_l2} \coqdocvar{p1p2\_eq\_none}]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{t1'}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_permut.permut\_inv\_right} \coqdocvar{P}) \coqdockw{as} [\coqdocvar{t2'{}'} [\coqdocvar{k2} [\coqdocvar{k2'} [\coqdocvar{t2'{}'\_eq\_t2'} [\coqdocvar{H'{}'} \coqdocvar{P'}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l2}; \coqdoctac{apply} \coqdocvar{in\_insert}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{k2} ++ \coqdocvar{k2'}) \coqdocvar{l2'} \coqdocvar{t2\_in\_l2} \coqdocvar{P'}; \coqdoctac{intro} \coqdocvar{k}; \coqdoctac{induction} \coqdocvar{k} \coqdockw{as} [ \ensuremath{|} \coqdocvar{u} \coqdocvar{k}];\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l} \coqdocvar{t2\_in\_l} \coqdocvar{Q}; \coqdoctac{inversion} \coqdocvar{Q} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a} \coqdocvar{b} \coqdocvar{k'} \coqdocvar{l1'} \coqdocvar{l2}]; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{in\_app\_or} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{t2\_in\_l}) \coqdockw{as} [\coqdocvar{t2\_in\_l1'} \ensuremath{|} [\coqdocvar{t2\_eq\_b} \ensuremath{|} \coqdocvar{t2\_in\_l2'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{apply} (\coqdocvar{IHk} (\coqdocvar{l1'} ++ \coqdocvar{l2})); \coqdoctac{trivial}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{apply} (\coqdocvar{IHk} (\coqdocvar{l1'} ++ \coqdocvar{l2})); \coqdoctac{trivial}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{K} := \coqdocvar{remove\_equiv\_eval\_is\_sound} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{l2}); \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{K}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{R} \coqdoctac{in} \coqdocvar{IH}; \coqdoctac{destruct} \coqdocvar{IH} \coqdockw{as} [\coqdocvar{ll} [\coqdocvar{E\_ll} [\coqdocvar{P1} [\coqdocvar{P2} \coqdocvar{F}]]]]; \coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{ll}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}. \coqdoctac{apply} (\coqdocvar{Pcons} (\coqdocvar{R} := @\coqdocvar{eq} \coqdocvar{term}) \coqdocvar{t1} \coqdocvar{t1} (\coqdocvar{l} := \coqdocvar{l1}) \coqdocvar{nil}\coqdoceol
\coqdocindent{11.50em}
(\coqdocvar{l1'} ++ \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} [\coqdocvar{u1\_eq\_t1} \ensuremath{|} \coqdocvar{u1\_in\_l1'}] \coqdocvar{u2\_in\_l2'}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{u1}; \coqdoctac{apply} \coqdocvar{K}; \coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P2});\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{F}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{R} \coqdoctac{in} \coqdocvar{IH}; \coqdoctac{destruct} \coqdocvar{IH} \coqdockw{as} [\coqdocvar{u1} [\coqdocvar{u2} [\coqdocvar{u1\_in\_l1} [\coqdocvar{u2\_in\_l2} \coqdocvar{pu1u2\_eq\_none}]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{u1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{u2}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{K} := \coqdocvar{remove\_equiv\_eval\_is\_sound} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{l2}); \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{K}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{K} \coqdockw{as} [\coqdocvar{t2} [\coqdocvar{t2\_in\_l2} \coqdocvar{pt1t2\_eq\_none}]];\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{find\_is\_sound} : \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} (\coqdocvar{I}: \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdockw{Prop}) \coqdocvar{l} (\coqdocvar{l\_sound}: \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'}, \coqdocvar{In} (\coqdocvar{t},\coqdocvar{t'}) \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{I} \coqdocvar{t} \coqdocvar{t'}) \coqdocvar{t1} \coqdocvar{t2},  \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{l} = \coqdocvar{true} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.00em}
\coqdocvar{I} \coqdocvar{t1} \coqdocvar{t2}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{I} \coqdocvar{l} \coqdocvar{l\_sound} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{l\_sound}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{mem\_impl\_in} (@\coqdocvar{eq} (\coqdocvar{term}\ensuremath{\times}\coqdocvar{term}))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}; \coqdoctac{assumption}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} (\coqdocvar{mem\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{eq\_tt\_bool\_ok} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{l}); \coqdoctac{rewrite} \coqdocvar{H}; \coqdoctac{intros}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_eval\_is\_sound\_weak} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n}; \coqdoctac{induction} \coqdocvar{n} \coqdockw{as} [ \ensuremath{|} \coqdocvar{n}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t1} \coqdockw{as} [\coqdocvar{v1} \ensuremath{|} \coqdocvar{f1} \coqdocvar{l1}]; \coqdoctac{destruct} \coqdocvar{t2} \coqdockw{as} [\coqdocvar{v2} \ensuremath{|} \coqdocvar{f2} \coqdocvar{l2}]; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{X.eq\_bool\_ok} \coqdocvar{v1} \coqdocvar{v2}); \coqdoctac{case} (\coqdocvar{X.eq\_bool} \coqdocvar{v1} \coqdocvar{v2}); [\coqdoctac{intro} \coqdocvar{v1\_eq\_v2} \ensuremath{|} \coqdoctac{intro} \coqdocvar{v1\_diff\_v2}].\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{intuition}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} ((\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}), (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos}));\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H} \coqdocvar{\_} ;\coqdoctac{eapply} \coqdocvar{find\_is\_sound} \coqdockw{with} (1:=\coqdocvar{equiv\_l\_valid} \coqdocvar{rpo\_infos});\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}); [\coqdoctac{intro} \coqdocvar{f1\_eq\_f2} \ensuremath{|} \coqdoctac{intro} \coqdocvar{f1\_diff\_f2}].\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1}). \coqdoctac{intros} \coqdocvar{Status}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{Eq\_lex}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}). \coqdoctac{apply} \coqdocvar{H1'}; \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{f1\_eq\_f2} \coqdoctac{in} \coqdocvar{H3'}. \coqdoctac{trivial}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H0}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{f1\_eq\_f2} \coqdoctac{in} \coqdocvar{H3'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{H};\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{l}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t} \coqdocvar{l}]; \coqdoctac{intros} [ \ensuremath{|} \coqdocvar{t'} \coqdocvar{l'}] \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{Eq\_list\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHn}; \coqdoctac{destruct} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{t'}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ]; \coqdoceol
\coqdocnoindent
\coqdoctac{trivial}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}; \coqdoctac{destruct} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{t'}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ]; \coqdoceol
\coqdocnoindent
\coqdoctac{trivial}; \coqdoctac{discriminate}. \coqdoctac{intro} \coqdocvar{Status}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}; \coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{remove\_equiv\_eval\_list\_is\_sound} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as} [ [\coqdocvar{l1'} \coqdocvar{l2'}] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [\coqdocvar{E\_ll} [\coqdocvar{P1} [\coqdocvar{P2} \coqdocvar{H'}]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_mul}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}). \coqdoctac{apply} \coqdocvar{H1'}; \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{f1\_eq\_f2} \coqdoctac{in} \coqdocvar{H3'}. \coqdoctac{trivial}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H0}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{f1\_eq\_f2} \coqdoctac{in} \coqdocvar{H3'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l1'}; \coqdoctac{destruct} \coqdocvar{l2'}; \coqdoctac{try} \coqdoctac{discriminate}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{P1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{P1} \coqdocvar{P2}; \coqdoctac{clear} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{P1} \coqdocvar{P2}; \coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{t1} \coqdocvar{t2}] \coqdocvar{ll}]; \coqdoctac{intros} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{P1} \coqdocvar{P2}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{permut\_nil} \coqdocvar{P1}); \coqdoctac{rewrite} (\coqdocvar{permut\_nil} \coqdocvar{P2}); \coqdoctac{apply} \coqdocvar{Pnil}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{permut\_inv\_right} \coqdocvar{P1}) \coqdockw{as} [\coqdocvar{t1'} [\coqdocvar{l1'} [\coqdocvar{l1'{}'} [\coqdocvar{t1\_eq\_t1'} [\coqdocvar{H'{}'} \coqdocvar{Q1}]]]]]; \coqdoctac{subst} \coqdocvar{l1} \coqdocvar{t1'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{permut\_inv\_right} \coqdocvar{P2}) \coqdockw{as} [\coqdocvar{t2'} [\coqdocvar{l2'} [\coqdocvar{l2'{}'} [\coqdocvar{t2\_eq\_t2'} [\coqdocvar{H'{}'} \coqdocvar{Q2}]]]]]; \coqdoctac{subst} \coqdocvar{l2} \coqdocvar{t2'}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{permut\_strong}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHn}; \coqdoctac{apply} \coqdocvar{E\_ll}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{E\_ll}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_eval\_list\_fully\_evaluates} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\not=} \coqdocvar{None}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\not=} \coqdocvar{None}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{E};\coqdoceol
\coqdocnoindent
\coqdocvar{functional} \coqdoctac{induction} (\coqdocvar{equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as} \coqdoceol
\coqdocnoindent
[ \coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{H2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H3} \coqdocvar{t2} \coqdocvar{l2} \coqdocvar{H4} \coqdocvar{H} \coqdocvar{IH}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{H2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H3} \coqdocvar{t2} \coqdocvar{l2} \coqdocvar{H4} \coqdocvar{H} \coqdocvar{IH}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{H2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H3} \coqdocvar{t2} \coqdocvar{l2} \coqdocvar{H4} \coqdocvar{H} \coqdocvar{IH}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{H1} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IH}; \coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} \coqdocvar{u1\_in\_l1} \coqdocvar{u2\_in\_l2}; \coqdoctac{apply} \coqdocvar{E}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{E'} := \coqdocvar{E} \coqdocvar{t1} \coqdocvar{t2}); \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{E'}; \coqdoctac{apply} \coqdocvar{E'}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{remove\_equiv\_eval\_fully\_evaluates} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{t} \coqdocvar{l}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{t'}, \coqdocvar{In} \coqdocvar{t'} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t} \coqdocvar{t'} \ensuremath{\not=} \coqdocvar{None}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdocvar{remove\_equiv\_eval} \coqdocvar{p} \coqdocvar{t} \coqdocvar{l} \ensuremath{\not=} @\coqdocvar{Not\_finished} \coqdocvar{\_}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{t} \coqdocvar{l} \coqdocvar{E};\coqdoceol
\coqdocnoindent
\coqdocvar{functional} \coqdoctac{induction} (\coqdocvar{remove\_equiv\_eval} \coqdocvar{p} \coqdocvar{t} \coqdocvar{l}) \coqdockw{as} \coqdoceol
\coqdocindent{1.00em}
[ \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{H} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{H} \coqdocvar{IH} \coqdocvar{l'} \coqdocvar{H'} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{H} \coqdocvar{IH} \coqdocvar{H'} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{H} \coqdocvar{IH} \coqdocvar{H'} \coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{H1} \coqdocvar{a} \coqdocvar{l} \coqdocvar{t'} \coqdocvar{H}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'} \coqdoctac{in} \coqdocvar{IH}; \coqdoctac{apply} \coqdocvar{IH}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{E}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{E} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})) \coqdocvar{H}); \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{remove\_equiv\_eval\_list\_fully\_evaluates} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\not=} \coqdocvar{None}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{remove\_equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\not=} \coqdocvar{None}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{E}; \coqdoceol
\coqdocnoindent
\coqdocvar{functional} \coqdoctac{induction} (\coqdocvar{remove\_equiv\_eval\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as}\coqdoceol
\coqdocnoindent
[ \coqdocvar{l1}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'} \coqdocvar{l2'} \coqdocvar{H} \coqdocvar{IH} \coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'} \coqdocvar{H} \coqdocvar{IH} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{R}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'} \coqdocvar{H} \coqdocvar{IH} \coqdocvar{R}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{H1} \coqdocvar{l2} \coqdocvar{t1} \coqdocvar{l1} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4} \coqdocvar{H'} \coqdocvar{H}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{K} := \coqdocvar{remove\_equiv\_eval\_is\_sound} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{H3}). \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{K}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{K} \coqdockw{as} [\coqdocvar{t2} [\coqdocvar{t2\_in\_l2} \coqdocvar{P2}]];\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IH}; \coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} \coqdocvar{u1\_in\_l1} \coqdocvar{u2\_in\_l2'}; \coqdoctac{apply} \coqdocvar{E}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P2}); \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{R} \coqdoctac{in} \coqdocvar{IH}; \coqdoctac{apply} \coqdocvar{IH}; \coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} \coqdocvar{u1\_in\_l1} \coqdocvar{u2\_in\_l2}; \coqdoctac{apply} \coqdocvar{E}; \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{K} := \coqdocvar{remove\_equiv\_eval\_fully\_evaluates} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{H3});\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{K}; \coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{K}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t2} \coqdocvar{t2\_in\_l2}; \coqdoctac{apply} \coqdocvar{E}; \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_eval\_terminates} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\not=} \coqdocvar{None}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n}; \coqdoctac{induction} \coqdocvar{n} \coqdockw{as} [ \ensuremath{|} \coqdocvar{n}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St1}; \coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (1 \ensuremath{\le} 0); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (1 + \coqdocvar{size} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
[\coqdoctac{apply} \coqdocvar{le\_plus\_l} \ensuremath{|} \coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}; \coqdoctac{apply} \coqdocvar{size\_ge\_one}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St}; \coqdoctac{rewrite} \coqdocvar{equiv\_eval\_equation}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t1} \coqdockw{as} [ \coqdocvar{v1} \ensuremath{|} \coqdocvar{f1} \coqdocvar{l1}]; \coqdoctac{destruct} \coqdocvar{t2} \coqdockw{as} [ \coqdocvar{v2} \ensuremath{|} \coqdocvar{f2} \coqdocvar{l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} ((\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}), (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos}));\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{intro} \coqdocvar{f1\_eq\_f2}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2} : \coqdocvar{term}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\not=} \coqdocvar{None}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1\_in\_l1} \coqdocvar{t2\_in\_l2}; \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{size\_unfold} \coqdoctac{in} \coqdocvar{St}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{plus\_assoc} \coqdoctac{in} \coqdocvar{St}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{size\_unfold} \coqdoctac{in} \coqdocvar{St}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{St}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{le\_S\_n} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St})); \coqdoctac{apply} \coqdocvar{plus\_le\_compat}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{size\_direct\_subterm} \coqdocvar{t1} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t1\_in\_l1});\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{size\_unfold} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1})); \coqdoctac{simpl}; \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{size\_direct\_subterm} \coqdocvar{t2} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l2}) \coqdocvar{t2\_in\_l2});\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{size\_unfold} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l2})); \coqdoctac{simpl}; \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_eval\_list\_fully\_evaluates}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= \coqdocvar{remove\_equiv\_eval\_list\_fully\_evaluates} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{H});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as} [ [[ \ensuremath{|} \coqdocvar{t1'} \coqdocvar{l1'}] [ \ensuremath{|} \coqdocvar{t2'} \coqdocvar{l2'}]] \ensuremath{|} ];\coqdoceol
\coqdocnoindent
\coqdoctac{try} \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_eval\_is\_complete\_true} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{2.50em}
\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n}; \coqdoctac{induction} \coqdocvar{n} \coqdockw{as} [ \ensuremath{|} \coqdocvar{n} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St}; \coqdocvar{absurd} (1 \ensuremath{\le} 0); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St}); \coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
[ \coqdoctac{apply} \coqdocvar{size\_ge\_one} \ensuremath{|} \coqdoctac{apply} \coqdocvar{le\_plus\_l}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St} \coqdocvar{t1\_eq\_t2}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t1\_eq\_t2} \coqdockw{as} \coqdoceol
\coqdocnoindent
[ \coqdocvar{t}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f\_eq\_g}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f\_eq\_g} \coqdocvar{P1} \coqdocvar{P2}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t2} \coqdockw{as} [\coqdocvar{v2} \ensuremath{|} \coqdocvar{f2} \coqdocvar{l2}]; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{X.eq\_bool\_ok} \coqdocvar{v2} \coqdocvar{v2}); \coqdoctac{case} (\coqdocvar{X.eq\_bool} \coqdocvar{v2} \coqdocvar{v2}); [\coqdoctac{intros} \coqdocvar{\_} \ensuremath{|} \coqdoctac{intro} \coqdocvar{v2\_diff\_v2}; \coqdocvar{absurd} (\coqdocvar{v2} = \coqdocvar{v2})]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}, \coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})); [\coqdoctac{reflexivity} \ensuremath{|} \coqdoctac{idtac}].\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f2} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{clear} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t2} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t2} \coqdocvar{t2\_in\_l2}; \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t2} + \coqdocvar{size} \coqdocvar{t2})) \coqdockw{with} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t2}) + \coqdocvar{size} \coqdocvar{t2}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat}; [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{apply} \coqdocvar{lt\_le\_weak}];\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{St} \coqdocvar{t1\_eq\_t2}; \coqdoctac{induction} \coqdocvar{l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t2} \coqdocvar{l2}]; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{H} \coqdocvar{t2}); [\coqdoctac{rewrite} \coqdocvar{IHl2} \ensuremath{|} \coqdoctac{left}]; \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} : \coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l2} \coqdocvar{l2} = \coqdocvar{Some} (\coqdocvar{nil},\coqdocvar{nil})).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{St} \coqdocvar{t1\_eq\_t2}; \coqdoctac{induction} \coqdocvar{l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t2} \coqdocvar{l2}]; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{H} \coqdocvar{t2}); [\coqdoctac{rewrite} \coqdocvar{IHl2} \ensuremath{|} \coqdoctac{left}]; \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H}. \coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H2} \coqdocvar{f2} \coqdocvar{f2}). \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H2'}. \coqdocvar{contradict} \coqdocvar{H2'}. \coqdoctac{apply} \coqdocvar{prec\_eq\_refl}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{equiv\_eval\_equation}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l1}, \coqdocvar{Term} \coqdocvar{g} \coqdocvar{l2}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})); [\coqdoctac{reflexivity} \ensuremath{|} \coqdoctac{idtac}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Sf}; \coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{f}); \coqdoctac{case} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{f}); [\coqdoctac{intros} \coqdocvar{\_} \ensuremath{|} \coqdoctac{intro} \coqdocvar{f\_diff\_f}; \coqdocvar{absurd} (\coqdocvar{f} = \coqdocvar{f}); \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Size} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1\_in\_l1} \coqdocvar{t2\_in\_l2};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2})) \coqdockw{with} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1}) + \coqdocvar{size} \coqdocvar{t2}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat}; [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{apply} \coqdocvar{lt\_le\_weak}];\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l2} \coqdocvar{H} \coqdocvar{Size}; \coqdoctac{clear} \coqdocvar{l2} \coqdocvar{H} \coqdocvar{Size} \coqdocvar{St} \coqdocvar{t1\_eq\_t2}; \coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros} \coqdocvar{l2} \coqdocvar{H} \coqdocvar{Size};\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{t2} \coqdocvar{l} \coqdocvar{l2'} \coqdocvar{t1\_eq\_t2} \coqdocvar{l1\_eq\_l2'}]; \coqdoctac{subst}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{eq\_f\_g}. \coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{f} \coqdocvar{g} ). \coqdoctac{rewrite} \coqdocvar{eq\_f\_g} \coqdoctac{in} \coqdocvar{H1'}. \coqdocvar{contradict} \coqdocvar{H1'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{IHn} \coqdocvar{t1} \coqdocvar{t2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Size}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Size}; \coqdoctac{left}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{f\_diff\_f}. \coqdoctac{apply} \coqdocvar{prec\_eq\_refl}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{St'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1\_in\_l1} \coqdocvar{t2\_in\_l2}; \coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2})) \coqdockw{with} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1}) + \coqdocvar{size} \coqdocvar{t2}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat}; [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{apply} \coqdocvar{lt\_le\_weak}];\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{T} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\not=} \coqdocvar{None}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1\_in\_l1} \coqdocvar{t2\_in\_l2}; \coqdoctac{apply} \coqdocvar{equiv\_eval\_terminates}; \coqdoctac{apply} \coqdocvar{St'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} : \coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2} = \coqdocvar{Some} (\coqdocvar{nil},\coqdocvar{nil})).\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l2} \coqdocvar{P1} \coqdocvar{St'} \coqdocvar{T}; \coqdoctac{clear} \coqdocvar{l2} \coqdocvar{P1} \coqdocvar{St} \coqdocvar{t1\_eq\_t2} \coqdocvar{St'} \coqdocvar{T};\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros} \coqdocvar{l2} \coqdocvar{P1} \coqdocvar{St'} \coqdocvar{T}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{P1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1'} \coqdocvar{t2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{l2'{}'} \coqdocvar{t1\_eq\_t2} \coqdocvar{l1\_eq\_l2}]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{remove\_equiv\_eval\_is\_sound} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{t1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{remove\_equiv\_eval} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{t1} (\coqdocvar{l2'} ++ \coqdocvar{t2} :: \coqdocvar{l2'{}'})) \coqdoceol
\coqdocindent{1.00em}
\coqdockw{as} [ \ensuremath{|} \ensuremath{|} \coqdocvar{l'}].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'} := \coqdocvar{H'} \coqdocvar{t2}); \coqdoctac{rewrite} (\coqdocvar{IHn} \coqdocvar{t1} \coqdocvar{t2}) \coqdoctac{in} \coqdocvar{H'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'{}'} : \coqdocvar{Some} \coqdocvar{true} = \coqdocvar{Some} \coqdocvar{false}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'{}'}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{St'}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} \coqdocvar{False}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{t'} [\coqdocvar{t'\_in\_l2} \coqdocvar{H'{}'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{T} \coqdocvar{t1} \coqdocvar{t'}); \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{t'} [\coqdocvar{t1\_eq\_t'} \coqdocvar{P2}]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \coqdocvar{l2'} ++ \coqdocvar{t2} :: \coqdocvar{l2'{}'} \ensuremath{\not=} \coqdocvar{nil}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l2'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t2'} \coqdocvar{l2'}]; \coqdoctac{simpl}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Q} : \coqdocvar{list\_permut.permut0} (\coqdocvar{eq} (\coqdocvar{A}:=\coqdocvar{term})) (\coqdocvar{t2} :: \coqdocvar{l2'} ++ \coqdocvar{l2'{}'}) (\coqdocvar{l2'} ++ \coqdocvar{t2} :: \coqdocvar{l2'{}'})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Pcons}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_permut.permut\_refl}; \coqdoctac{intro}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{l2'} ++ \coqdocvar{t2} :: \coqdocvar{l2'{}'}) \coqdockw{as} [ \ensuremath{|} \coqdocvar{t2'} \coqdocvar{k2}].\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (@\coqdocvar{nil} \coqdocvar{term} = \coqdocvar{nil}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} (\coqdocvar{l2'} ++ \coqdocvar{l2'{}'}); \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{t1\_eq\_t'{}'} : \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{t1\_eq\_t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{t2\_eq\_t'} : \coqdocvar{equiv} \coqdocvar{t2} \coqdocvar{t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{t1}; \coqdoctac{trivial}; \coqdoctac{symmetry}; \coqdoctac{reflexivity} || \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{permut0\_cons} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv} \coqdocvar{\_} \coqdocvar{\_}  (\coqdocvar{l2'} ++ \coqdocvar{l2'{}'}) \coqdocvar{l'}  \coqdocvar{t2\_eq\_t'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_permut.permut\_trans} \coqdockw{with} (\coqdocvar{t2'} :: \coqdocvar{k2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a} \coqdocvar{b} \coqdocvar{c} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{a\_eq\_b} \coqdocvar{b\_eq\_c}; \coqdoctac{subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{St'}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P2}); \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{T}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P2}); \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{equiv\_eval\_equation}; \coqdoctac{rewrite} \coqdocvar{Sf}; \coqdoctac{rewrite} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l1}, \coqdocvar{Term} \coqdocvar{g} \coqdocvar{l2}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})); [\coqdoctac{reflexivity} \ensuremath{|} \coqdoctac{idtac}].\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{prec\_eq\_bool} \coqdocvar{Prec} \coqdocvar{f} \coqdocvar{g}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{f\_eq'\_g}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{prec\_eq\_bool\_ok} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{f} \coqdocvar{g}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{f\_eq'\_g} \coqdoctac{in} \coqdocvar{H1'}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{H1'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_eval\_is\_sound} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \ensuremath{\lnot}\coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St};\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} := \coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{T} := @\coqdocvar{equiv\_eval\_terminates} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := @\coqdocvar{equiv\_eval\_is\_complete\_true} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{t1\_eq\_t2}; \coqdoctac{assert} (\coqdocvar{H'{}'} := \coqdocvar{H'} \coqdocvar{t1\_eq\_t2}); \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{T}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{term\_gt\_list} (\coqdocvar{p} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{comp}) \coqdocvar{s} \coqdocvar{l} :=\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{list\_forall\_option} \coqdoceol
\coqdocindent{3.00em}
(\coqdockw{fun} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{s} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{l}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{lexico\_eval} (\coqdocvar{p} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{comp}) (\coqdocvar{s1} \coqdocvar{s2} : \coqdocvar{term})\coqdoceol
\coqdocindent{1.50em}
(\coqdocvar{l1} \coqdocvar{l2} : \coqdocvar{list} \coqdocvar{term}) \{\coqdockw{struct} \coqdocvar{l1}\} : \coqdocvar{option} \coqdocvar{comp} :=\coqdoceol
\coqdocindent{2.00em}
\coqdockw{match} \coqdocvar{l1}, \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{nil}, \coqdocvar{nil} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Equivalent}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{nil}, (\coqdocvar{\_} :: \coqdocvar{\_}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} (\coqdocvar{\_} :: \coqdocvar{\_}), \coqdocvar{nil} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} (\coqdocvar{t1} :: \coqdocvar{l1'}), (\coqdocvar{t2} :: \coqdocvar{l2'}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{lexico\_eval} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1'} \coqdocvar{l2'}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{7.00em}
\coqdockw{match} \coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{match} \coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s2} \coqdocvar{l1} \coqdockw{with}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lexico\_eval\_equation} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{lexico\_eval} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1} \coqdocvar{l2} =\coqdoceol
\coqdocindent{2.00em}
\coqdockw{match} \coqdocvar{l1}, \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{nil}, \coqdocvar{nil} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Equivalent}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{nil}, (\coqdocvar{\_} :: \coqdocvar{\_}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} (\coqdocvar{\_} :: \coqdocvar{\_}), \coqdocvar{nil} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} (\coqdocvar{t1} :: \coqdocvar{l1'}), (\coqdocvar{t2} :: \coqdocvar{l2'}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{lexico\_eval} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1'} \coqdocvar{l2'}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{7.00em}
\coqdockw{match} \coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{match} \coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s2} \coqdocvar{l1} \coqdockw{with}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}] [ \ensuremath{|} \coqdocvar{t2} \coqdocvar{l2}]; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{list\_gt\_list}  (\coqdocvar{p} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{comp}) \coqdocvar{lg} \coqdocvar{ls} :=\coqdoceol
\coqdocindent{5.50em}
\coqdocvar{list\_forall\_option} \coqdoceol
\coqdocindent{7.00em}
(\coqdockw{fun} \coqdocvar{s} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{8.50em}
\coqdocvar{list\_exists\_option} \coqdoceol
\coqdocindent{9.50em}
(\coqdockw{fun} \coqdocvar{g} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{11.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{12.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{12.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{12.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{11.00em}
\coqdockw{end}) \coqdocvar{lg}) \coqdocvar{ls}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{mult\_eval} (\coqdocvar{p} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{comp}) (\coqdocvar{l1} \coqdocvar{l2} : \coqdocvar{list} \coqdocvar{term})  : \coqdocvar{option} \coqdocvar{comp} :=\coqdoceol
\coqdocindent{4.50em}
\coqdockw{match} \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{l2} \coqdocvar{l1} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} (\coqdocvar{n} : \coqdocvar{nat}) (\coqdocvar{t1} \coqdocvar{t2} : \coqdocvar{term}) \{\coqdockw{struct} \coqdocvar{n}\} : \coqdocvar{option} \coqdocvar{comp} :=\coqdoceol
\coqdocindent{2.00em}
\coqdockw{if} \coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos}) \coqdoceol
\coqdocindent{3.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{else} \coqdockw{if} \coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos}) \coqdoceol
\coqdocindent{4.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Greater\_than} \coqdoceol
\coqdocindent{4.00em}
\coqdockw{else} \coqdockw{if} \coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos}) \coqdoceol
\coqdocindent{5.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Equivalent} \coqdoceol
\coqdocindent{5.00em}
\coqdockw{else} \coqdockw{if} \coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos}) \coqdoceol
\coqdocindent{6.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Equivalent} \coqdoceol
\coqdocindent{6.00em}
\coqdockw{else}\coqdoceol
\coqdocindent{5.00em}
\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{1.00em}
(\coqdockw{match} \coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Equivalent}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
(\coqdockw{match} \coqdocvar{t1}, \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Var} \coqdocvar{\_}, \coqdocvar{Var} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Var} \coqdocvar{x}, (\coqdocvar{Term} \coqdocvar{\_} \coqdocvar{l}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{if} \coqdocvar{var\_in\_term\_list} \coqdocvar{x} \coqdocvar{l}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{else} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} (\coqdocvar{Term} \coqdocvar{\_} \coqdocvar{l}), \coqdocvar{Var} \coqdocvar{x} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{if} \coqdocvar{var\_in\_term\_list} \coqdocvar{x} \coqdocvar{l}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{else} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}), (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{match} \coqdocvar{n} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} 0 \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{S} \coqdocvar{m} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{4.50em}
\coqdockw{let} \coqdocvar{check\_l1\_gt\_t2} :=\coqdoceol
\coqdocindent{10.50em}
\coqdocvar{list\_exists\_option} \coqdoceol
\coqdocindent{13.00em}
(\coqdockw{fun} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m} \coqdocvar{t} \coqdocvar{t2} \coqdockw{with} \coqdoceol
\coqdocindent{18.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \coqdoceol
\coqdocindent{18.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{18.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{18.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{17.50em}
\coqdockw{end}) \coqdocvar{l1} \coqdoctac{in}\coqdoceol
\coqdocindent{5.00em}
(\coqdockw{match} \coqdocvar{check\_l1\_gt\_t2} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{let} \coqdocvar{check\_l2\_gt\_t1} :=\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{list\_exists\_option} \coqdoceol
\coqdocindent{12.00em}
(\coqdockw{fun} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m} \coqdocvar{t1} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{19.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \coqdoceol
\coqdocindent{19.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{19.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{19.50em}
\ensuremath{|} \coqdocvar{None}  \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{18.50em}
\coqdockw{end}) \coqdocvar{l2} \coqdoctac{in}\coqdoceol
\coqdocindent{5.00em}
(\coqdockw{match} \coqdocvar{check\_l2\_gt\_t1} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.50em}
(\coqdockw{match} \coqdocvar{prec\_eval} \coqdocvar{f1} \coqdocvar{f2} \coqdockw{with}\coqdoceol
\coqdocindent{9.00em}
\ensuremath{|} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{9.00em}
\ensuremath{|} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{11.50em}
\coqdockw{let} \coqdocvar{check\_l2\_lt\_t1} :=\coqdoceol
\coqdocindent{13.00em}
\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{15.00em}
(\coqdockw{fun} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m} \coqdocvar{t1} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{23.50em}
\coqdockw{end}) \coqdocvar{l2} \coqdoctac{in}\coqdoceol
\coqdocindent{10.50em}
(\coqdockw{match} \coqdocvar{check\_l2\_lt\_t1} \coqdockw{with}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{10.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{9.00em}
\ensuremath{|} \coqdocvar{Less\_than} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{11.00em}
\coqdockw{let} \coqdocvar{check\_l1\_lt\_t2} :=\coqdoceol
\coqdocindent{13.00em}
\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{14.00em}
(\coqdockw{fun} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m} \coqdocvar{t} \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{23.50em}
\coqdockw{end}) \coqdocvar{l1} \coqdoctac{in}\coqdoceol
\coqdocindent{11.00em}
(\coqdockw{match} \coqdocvar{check\_l1\_lt\_t2} \coqdockw{with}\coqdoceol
\coqdocindent{11.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{11.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{11.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{10.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{9.00em}
\ensuremath{|} \coqdocvar{Equivalent} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{12.00em}
(\coqdockw{match} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} \coqdockw{with}\coqdoceol
\coqdocindent{13.00em}
\ensuremath{|} \coqdocvar{Mul} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{16.00em}
\coqdockw{match} \coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m}) \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{nil}, \coqdocvar{nil}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Equivalent}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{nil}, \coqdocvar{\_} :: \coqdocvar{\_}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{\_} :: \coqdocvar{\_},\coqdocvar{nil}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{l1}, \coqdocvar{l2}) \ensuremath{\Rightarrow} \coqdocvar{mult\_eval} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m}) \coqdocvar{l1} \coqdocvar{l2}\coqdoceol
\coqdocindent{16.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{13.00em}
\ensuremath{|} \coqdocvar{Lex} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{15.50em}
\coqdockw{if} (\coqdocvar{beq\_nat} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{length} \coqdocvar{l2})) || \coqdoceol
\coqdocindent{17.00em}
(\coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l1}) \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \&\& \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l2}) \coqdocvar{rpo\_infos}.(\coqdocvar{bb}))\coqdoceol
\coqdocindent{15.50em}
\coqdockw{then} \coqdocvar{lexico\_eval} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m}) \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{l1} \coqdocvar{l2}\coqdoceol
\coqdocindent{15.50em}
\coqdockw{else} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{11.50em}
\coqdockw{end}) \coqdoceol
\coqdocindent{5.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{2.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end})\coqdoceol
\coqdocnoindent
\coqdockw{end}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_eval\_equation} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} =\coqdoceol
\coqdocindent{2.00em}
\coqdockw{if} \coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos}) \coqdoceol
\coqdocindent{3.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{else} \coqdockw{if} \coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos}) \coqdoceol
\coqdocindent{4.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Greater\_than} \coqdoceol
\coqdocindent{4.00em}
\coqdockw{else} \coqdockw{if} \coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos}) \coqdoceol
\coqdocindent{5.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Equivalent} \coqdoceol
\coqdocindent{5.00em}
\coqdockw{else} \coqdockw{if} \coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos}) \coqdoceol
\coqdocindent{6.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Equivalent} \coqdoceol
\coqdocindent{6.00em}
\coqdockw{else}\coqdoceol
\coqdocindent{5.00em}
\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{1.00em}
(\coqdockw{match} \coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Equivalent}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
(\coqdockw{match} \coqdocvar{t1}, \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Var} \coqdocvar{\_}, \coqdocvar{Var} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Var} \coqdocvar{x}, (\coqdocvar{Term} \coqdocvar{\_} \coqdocvar{l}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{if} \coqdocvar{var\_in\_term\_list} \coqdocvar{x} \coqdocvar{l}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{else} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} (\coqdocvar{Term} \coqdocvar{\_} \coqdocvar{l}), \coqdocvar{Var} \coqdocvar{x} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{if} \coqdocvar{var\_in\_term\_list} \coqdocvar{x} \coqdocvar{l}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{then} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{else} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}), (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{match} \coqdocvar{n} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} 0 \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{S} \coqdocvar{m} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{4.50em}
\coqdockw{let} \coqdocvar{check\_l1\_gt\_t2} :=\coqdoceol
\coqdocindent{10.50em}
\coqdocvar{list\_exists\_option} \coqdoceol
\coqdocindent{13.00em}
(\coqdockw{fun} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m} \coqdocvar{t} \coqdocvar{t2} \coqdockw{with} \coqdoceol
\coqdocindent{18.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \coqdoceol
\coqdocindent{18.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{18.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{18.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{17.50em}
\coqdockw{end}) \coqdocvar{l1} \coqdoctac{in}\coqdoceol
\coqdocindent{5.00em}
(\coqdockw{match} \coqdocvar{check\_l1\_gt\_t2} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{let} \coqdocvar{check\_l2\_gt\_t1} :=\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{list\_exists\_option} \coqdoceol
\coqdocindent{12.00em}
(\coqdockw{fun} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m} \coqdocvar{t1} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{19.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \coqdoceol
\coqdocindent{19.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{19.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{19.50em}
\ensuremath{|} \coqdocvar{None}  \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{18.50em}
\coqdockw{end}) \coqdocvar{l2} \coqdoctac{in}\coqdoceol
\coqdocindent{5.00em}
(\coqdockw{match} \coqdocvar{check\_l2\_gt\_t1} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.50em}
(\coqdockw{match} \coqdocvar{prec\_eval} \coqdocvar{f1} \coqdocvar{f2} \coqdockw{with}\coqdoceol
\coqdocindent{9.00em}
\ensuremath{|} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{9.00em}
\ensuremath{|} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{11.50em}
\coqdockw{let} \coqdocvar{check\_l2\_lt\_t1} :=\coqdoceol
\coqdocindent{13.00em}
\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{15.00em}
(\coqdockw{fun} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m} \coqdocvar{t1} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{23.50em}
\coqdockw{end}) \coqdocvar{l2} \coqdoctac{in}\coqdoceol
\coqdocindent{10.50em}
(\coqdockw{match} \coqdocvar{check\_l2\_lt\_t1} \coqdockw{with}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{10.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{9.00em}
\ensuremath{|} \coqdocvar{Less\_than} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{11.00em}
\coqdockw{let} \coqdocvar{check\_l1\_lt\_t2} :=\coqdoceol
\coqdocindent{13.00em}
\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{14.00em}
(\coqdockw{fun} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m} \coqdocvar{t} \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{23.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{23.50em}
\coqdockw{end}) \coqdocvar{l1} \coqdoctac{in}\coqdoceol
\coqdocindent{11.00em}
(\coqdockw{match} \coqdocvar{check\_l1\_lt\_t2} \coqdockw{with}\coqdoceol
\coqdocindent{11.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{11.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{11.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{10.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{9.00em}
\ensuremath{|} \coqdocvar{Equivalent} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{12.00em}
(\coqdockw{match} \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} \coqdockw{with}\coqdoceol
\coqdocindent{13.00em}
\ensuremath{|} \coqdocvar{Mul} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{16.00em}
\coqdockw{match} \coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m}) \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{nil}, \coqdocvar{nil}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Equivalent}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{nil}, \coqdocvar{\_} :: \coqdocvar{\_}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{\_} :: \coqdocvar{\_},\coqdocvar{nil}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{l1}, \coqdocvar{l2}) \ensuremath{\Rightarrow} \coqdocvar{mult\_eval} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m}) \coqdocvar{l1} \coqdocvar{l2}\coqdoceol
\coqdocindent{16.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{13.00em}
\ensuremath{|} \coqdocvar{Lex} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{15.50em}
\coqdockw{if} (\coqdocvar{beq\_nat} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{length} \coqdocvar{l2})) || \coqdoceol
\coqdocindent{17.00em}
(\coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l1}) \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \&\& \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l2}) \coqdocvar{rpo\_infos}.(\coqdocvar{bb}))\coqdoceol
\coqdocindent{15.50em}
\coqdockw{then} \coqdocvar{lexico\_eval} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{m}) \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{l1} \coqdocvar{l2}\coqdoceol
\coqdocindent{15.50em}
\coqdockw{else} \coqdocvar{Some} \coqdocvar{Uncomparable}\coqdoceol
\coqdocindent{11.50em}
\coqdockw{end}) \coqdoceol
\coqdocindent{5.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{2.00em}
\coqdockw{end})\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end})\coqdoceol
\coqdocnoindent
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} [ \ensuremath{|} \coqdocvar{n}] [\coqdocvar{v1} \ensuremath{|} \coqdocvar{f1} \coqdocvar{l1}] [\coqdocvar{v2} \ensuremath{|} \coqdocvar{f2} \coqdocvar{l2}];\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{rpo\_eval}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{term\_gt\_list\_is\_sound} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{s} \coqdocvar{l},\coqdoceol
\coqdocindent{1.50em}
\coqdockw{match} \coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s} \coqdocvar{l} \coqdockw{with}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{t}, \coqdocvar{In} \coqdocvar{t} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{s} \coqdocvar{t} = \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{s} \coqdocvar{l}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t} \coqdocvar{l}]; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s} (\coqdocvar{t} :: \coqdocvar{l})) \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
(\coqdockw{match} \coqdocvar{p} \coqdocvar{s} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s} \coqdocvar{l}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s} \coqdocvar{l} \coqdockw{with} \coqdocvar{Some} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false} \ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} \coqdockw{end}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{2.00em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{s} \coqdocvar{t}); [\coqdoctac{intros} [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \coqdocvar{H} \ensuremath{|} \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s} \coqdocvar{l}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s} \coqdocvar{l}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s} \coqdocvar{l}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} [\coqdocvar{u\_eq\_t} \ensuremath{|} \coqdocvar{u\_in\_l}]; [\coqdoctac{subst} \ensuremath{|} \coqdoctac{apply} \coqdocvar{IHl}]; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s} \coqdocvar{l}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{term\_gt\_list}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{s} \coqdocvar{t}) \coqdockw{as} [[ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lexico\_eval\_is\_sound} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} (\coqdocvar{p} : \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{term} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{comp}) \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1} \coqdocvar{l2},\coqdoceol
\coqdocindent{5.50em}
\coqdockw{match} \coqdocvar{lexico\_eval} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{6.50em}
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{ll}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Equivalent}) \ensuremath{\land}\coqdoceol
\coqdocindent{14.00em}
\coqdocvar{l1} = \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll} \ensuremath{\land}\coqdoceol
\coqdocindent{14.00em}
\coqdocvar{l2} = \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll}) \coqdoceol
\coqdocindent{6.50em}
\ensuremath{|}  \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{8.50em}
(\coqdocvar{l1} = \coqdocvar{nil} \ensuremath{\land} \coqdocvar{l2} \ensuremath{\not=} \coqdocvar{nil}) \ensuremath{\lor}\coqdoceol
\coqdocindent{8.50em}
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{ll}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2'},\coqdoceol
\coqdocindent{9.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Equivalent}) \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{l1} = \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll} \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{l2} = \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll} ++ \coqdocvar{t2} :: \coqdocvar{l2'}) \ensuremath{\lor}\coqdoceol
\coqdocindent{8.50em}
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{ll}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1'}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2'},\coqdoceol
\coqdocindent{9.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Equivalent}) \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{9.50em}
((\coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\land} (\coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\lor}\coqdoceol
\coqdocindent{26.50em}
\coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Less\_than})) \ensuremath{\lor} \coqdoceol
\coqdocindent{25.00em}
\coqdocvar{p} \coqdocvar{s2} \coqdocvar{t1} = \coqdocvar{Some} \coqdocvar{Greater\_than})) \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{l1} = \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll} ++ \coqdocvar{t1} :: \coqdocvar{l1'} \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{l2} = \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll} ++ \coqdocvar{t2} :: \coqdocvar{l2'})\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|}  \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdoceol
\coqdocindent{8.50em}
(\coqdocvar{l1} \ensuremath{\not=} \coqdocvar{nil} \ensuremath{\land} \coqdocvar{l2} = \coqdocvar{nil}) \ensuremath{\lor}\coqdoceol
\coqdocindent{8.50em}
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{ll}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1'},\coqdoceol
\coqdocindent{9.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Equivalent}) \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{l1} = \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll} ++ \coqdocvar{t1} :: \coqdocvar{l1'} \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{l2} = \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll}) \ensuremath{\lor}\coqdoceol
\coqdocindent{8.00em}
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{ll}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1'}, \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2'},\coqdoceol
\coqdocindent{9.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Equivalent}) \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{9.50em}
((\coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\land} (\coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\lor}\coqdoceol
\coqdocindent{26.50em}
\coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Greater\_than})) \ensuremath{\lor} \coqdoceol
\coqdocindent{25.00em}
\coqdocvar{p} \coqdocvar{s1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Greater\_than})) \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{l1} = \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll} ++ \coqdocvar{t1} :: \coqdocvar{l1'} \ensuremath{\land}\coqdoceol
\coqdocindent{9.50em}
\coqdocvar{l2} = \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll} ++ \coqdocvar{t2} :: \coqdocvar{l2'})\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1}; \coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros} [ \ensuremath{|} \coqdocvar{t2} \coqdocvar{l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{simpl}; \coqdoctac{intuition}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{left}; \coqdoctac{split}; [\coqdoctac{apply} \coqdocvar{refl\_equal} \ensuremath{|} \coqdoctac{discriminate}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{left}; \coqdoctac{split}; [\coqdoctac{discriminate} \ensuremath{|} \coqdoctac{apply} \coqdocvar{refl\_equal}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2}); [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \coqdocvar{Ht}; \coqdoctac{generalize} (\coqdocvar{IHl1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{lexico\_eval} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1} \coqdocvar{l2}); [\coqdoctac{intros} [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \coqdocvar{Hl} \ensuremath{|} \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{ll} [\coqdocvar{Hll} [\coqdocvar{H1} \coqdocvar{H2}]]]; \coqdoctac{\ensuremath{\exists}} ((\coqdocvar{t1},\coqdocvar{t2}) :: \coqdocvar{ll}); \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} [\coqdocvar{u1u2\_eq\_t1t2} \ensuremath{|} \coqdocvar{u1u2\_in\_ll}]; [\coqdoctac{injection} \coqdocvar{u1u2\_eq\_t1t2}; \coqdoctac{intros}; \coqdoctac{subst} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Hll}]; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{split}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{a2} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{a1} [\coqdocvar{a2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ha} [\coqdocvar{H} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{left}; \coqdoctac{subst}; \coqdoctac{destruct} \coqdocvar{l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a2} \coqdocvar{l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} ((\coqdocvar{t1},\coqdocvar{t2}) :: \coqdocvar{nil}); \coqdoctac{\ensuremath{\exists}} \coqdocvar{a2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} [\coqdocvar{u1u2\_eq\_t1t2} \ensuremath{|} \coqdocvar{u1u2\_in\_nil}]; [\coqdoctac{injection} \coqdocvar{u1u2\_eq\_t1t2}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{assumption} \ensuremath{|} \coqdocvar{contradiction}].\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} ((\coqdocvar{t1},\coqdocvar{t2}) :: \coqdocvar{ll}); \coqdoctac{\ensuremath{\exists}} \coqdocvar{a2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2'}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} [\coqdocvar{u1u2\_eq\_t1t2} \ensuremath{|} \coqdocvar{u1u2\_in\_ll}]; [\coqdoctac{injection} \coqdocvar{u1u2\_eq\_t1t2}; \coqdoctac{intros}; \coqdoctac{subst} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Hll}]; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} ((\coqdocvar{t1},\coqdocvar{t2}) :: \coqdocvar{ll}); \coqdoctac{\ensuremath{\exists}} \coqdocvar{a1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{a2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1'}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2'}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} [\coqdocvar{u1u2\_eq\_t1t2} \ensuremath{|} \coqdocvar{u1u2\_in\_ll}]; [\coqdoctac{injection} \coqdocvar{u1u2\_eq\_t1t2}; \coqdoctac{intros}; \coqdoctac{subst} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Hll}]; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} [\coqdocvar{t1\_eq\_u} \ensuremath{|} \coqdocvar{u\_in\_l1}].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{u}; \coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{split}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H} \coqdocvar{\_} \coqdocvar{u\_in\_l1}) \coqdockw{as} [[\coqdocvar{u2} [\coqdocvar{u2\_in\_l2} \coqdocvar{H'}]] \ensuremath{|} \coqdocvar{H'}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{u2}; \coqdoctac{split}; [\coqdoctac{right} \ensuremath{|} \coqdoctac{idtac}]; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{a1} [\coqdocvar{l1'} [\coqdocvar{Hll} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{a1} [\coqdocvar{a2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ha} [\coqdocvar{H} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{left}; \coqdoctac{subst}; \coqdoctac{destruct} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a1} \coqdocvar{l1}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} ((\coqdocvar{t1},\coqdocvar{t2}) :: \coqdocvar{nil}); \coqdoctac{\ensuremath{\exists}} \coqdocvar{a1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} [\coqdocvar{u1u2\_eq\_t1t2} \ensuremath{|} \coqdocvar{u1u2\_in\_nil}]; [\coqdoctac{injection} \coqdocvar{u1u2\_eq\_t1t2}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{assumption} \ensuremath{|} \coqdocvar{contradiction}].\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} ((\coqdocvar{t1},\coqdocvar{t2}) :: \coqdocvar{ll}); \coqdoctac{\ensuremath{\exists}} \coqdocvar{a1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1'}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} [\coqdocvar{u1u2\_eq\_t1t2} \ensuremath{|} \coqdocvar{u1u2\_in\_ll}]; [\coqdoctac{injection} \coqdocvar{u1u2\_eq\_t1t2}; \coqdoctac{intros}; \coqdoctac{subst} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Hll}]; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} ((\coqdocvar{t1},\coqdocvar{t2}) :: \coqdocvar{ll}); \coqdoctac{\ensuremath{\exists}} \coqdocvar{a1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{a2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1'}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2'}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u2} [\coqdocvar{u1u2\_eq\_t1t2} \ensuremath{|} \coqdocvar{u1u2\_in\_ll}]; [\coqdoctac{injection} \coqdocvar{u1u2\_eq\_t1t2}; \coqdoctac{intros}; \coqdoctac{subst} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Hll}]; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} [\coqdocvar{t2\_eq\_u} \ensuremath{|} \coqdocvar{u\_in\_l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{u}; \coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{split}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H} \coqdocvar{\_} \coqdocvar{u\_in\_l2}) \coqdockw{as} [[\coqdocvar{u1} [\coqdocvar{u1\_in\_l1} \coqdocvar{H'}]] \ensuremath{|} \coqdocvar{H'}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{u1}; \coqdoctac{split}; [\coqdoctac{right} \ensuremath{|} \coqdoctac{idtac}]; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{lexico\_eval} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \coqdocvar{Hl}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{ll} [\coqdocvar{Hll} [\coqdocvar{H1} \coqdocvar{H2}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{term\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{s2} (\coqdocvar{t1} :: \coqdocvar{l1})).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s2} (\coqdocvar{t1} :: \coqdocvar{l1})) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}; \coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t1l1}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{split}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{a2} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{a1} [\coqdocvar{a2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ha} [\coqdocvar{H} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{term\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{s2} (\coqdocvar{t1} :: \coqdocvar{l1})); \coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s2} (\coqdocvar{t1} :: \coqdocvar{l1})) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t1l1}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t1l1}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t1l1}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{term\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{s2} (\coqdocvar{t1} :: \coqdocvar{l1})); \coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s2} (\coqdocvar{t1} :: \coqdocvar{l1})) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t1l1}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{term\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{s2} (\coqdocvar{t1} :: \coqdocvar{l1})); \coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s2} (\coqdocvar{t1} :: \coqdocvar{l1})) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t1l1}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{term\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{s2} (\coqdocvar{t1} :: \coqdocvar{l1})); \coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s2} (\coqdocvar{t1} :: \coqdocvar{l1})) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t1l1}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{lexico\_eval} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \coqdocvar{Hl}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{ll} [\coqdocvar{Hll} [\coqdocvar{H1} \coqdocvar{H2}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{term\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{s1} (\coqdocvar{t2} :: \coqdocvar{l2})).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s1} (\coqdocvar{t2} :: \coqdocvar{l2})) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}; \coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t1l2}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{split}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{a2} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{a1} [\coqdocvar{a2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ha} [\coqdocvar{H} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{term\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{s1} (\coqdocvar{t2} :: \coqdocvar{l2})); \coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s1} (\coqdocvar{t2} :: \coqdocvar{l2})) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t2l2}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t2l2}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t2l2}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{term\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{s1} (\coqdocvar{t2} :: \coqdocvar{l2})); \coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s1} (\coqdocvar{t2} :: \coqdocvar{l2})) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t2l2}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{term\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{s1} (\coqdocvar{t2} :: \coqdocvar{l2})); \coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s1} (\coqdocvar{t2} :: \coqdocvar{l2})) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t2l2}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{term\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{s1} (\coqdocvar{t2} :: \coqdocvar{l2})); \coqdoctac{destruct} (\coqdocvar{term\_gt\_list} \coqdocvar{p} \coqdocvar{s1} (\coqdocvar{t2} :: \coqdocvar{l2})) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (@\coqdocvar{nil} (\coqdocvar{term} \ensuremath{\times} \coqdocvar{term})); \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l1}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{l2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_t2l2}; \coqdoctac{right}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_is\_sound} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls},\coqdoceol
\coqdocindent{1.50em}
\coqdockw{match} \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} \coqdockw{with}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{In} \coqdocvar{s} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{g}, \coqdocvar{In} \coqdocvar{g} \coqdocvar{lg} \ensuremath{\land} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}; \coqdocvar{revert} \coqdocvar{lg}; \coqdoctac{induction} \coqdocvar{ls} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{ls}]; \coqdoctac{intro} \coqdocvar{lg}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_exists\_option\_is\_sound} \coqdoceol
\coqdocindent{1.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) \coqdocvar{lg}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdoceol
\coqdocnoindent
(\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}) \coqdocvar{lg}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{g} [\coqdocvar{g\_in\_ls} \coqdocvar{H}]].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHls} \coqdocvar{lg}); \coqdoctac{unfold} \coqdocvar{list\_gt\_list};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdoceol
\coqdocnoindent
(\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{s0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{g0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g0} \coqdocvar{s0} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) \coqdocvar{lg}) \coqdocvar{ls}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H'} \coqdocvar{u} [\coqdocvar{s\_eq\_u} \ensuremath{|} \coqdocvar{u\_in\_ls}].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{u}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{g}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{g} \coqdocvar{s}) \coqdockw{as} [[ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; (\coqdoctac{apply} \coqdocvar{refl\_equal} || \coqdoctac{discriminate}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdoceol
\coqdocnoindent
(\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{s0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{g0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g0} \coqdocvar{s0} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) \coqdocvar{lg}) \coqdocvar{ls}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{in\_mem} : \coqdockw{\ensuremath{\forall}} \coqdocvar{s} \coqdocvar{l}, \coqdocvar{In} \coqdocvar{s} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{In} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{In} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}).\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}.\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_eval\_is\_sound\_weak} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}, \coqdoceol
\coqdocindent{1.50em}
\coqdockw{match} \coqdocvar{mult\_eval} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow}  \coqdoceol
\coqdocindent{3.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\land} \coqdocvar{p} \coqdocvar{t2} \coqdocvar{t1} = \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow}  \coqdoceol
\coqdocindent{3.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\land} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{unfold} \coqdocvar{mult\_eval}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}); \coqdoctac{destruct} (\coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{generalize} (\coqdocvar{list\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{l2} \coqdocvar{l1}); \coqdoctac{destruct} (\coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{l2} \coqdocvar{l1}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_eval\_is\_sound\_weak} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}, \coqdoceol
\coqdocindent{8.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t2} \coqdocvar{t1}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t2}\coqdoceol
\coqdocindent{10.50em}
\ensuremath{|} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{10.50em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n}; \coqdoctac{induction} \coqdocvar{n} \coqdockw{as} [ \ensuremath{|} \coqdocvar{n}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2}. \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{Hfind};\coqdoctac{apply} (\coqdocvar{find\_is\_sound} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb})) \coqdocvar{\_} (\coqdocvar{rpo\_l\_valid} \coqdocvar{rpo\_infos}) \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{Hfind})).\coqdoceol
\coqdocnoindent
\coqdoctac{intro};\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{Hfind};\coqdoctac{apply} (\coqdocvar{find\_is\_sound} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb})) \coqdocvar{\_} (\coqdocvar{rpo\_l\_valid} \coqdocvar{rpo\_infos}) \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{Hfind})).\coqdoceol
\coqdocnoindent
\coqdoctac{intro}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{Hfind};\coqdoctac{apply} (\coqdocvar{find\_is\_sound} \coqdocvar{equiv} \coqdocvar{\_} (\coqdocvar{equiv\_l\_valid} \coqdocvar{rpo\_infos}) \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{Hfind})).\coqdoceol
\coqdocnoindent
\coqdoctac{intro};\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{Hfind}; \coqdoctac{apply} \coqdocvar{equiv\_sym}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{find\_is\_sound} \coqdocvar{equiv} \coqdocvar{\_} (\coqdocvar{equiv\_l\_valid} \coqdocvar{rpo\_infos}) \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{Hfind})).\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2}; \coqdoctac{rewrite} \coqdocvar{rpo\_eval\_equation}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{Hfind};\coqdoctac{apply} (\coqdocvar{find\_is\_sound} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb})) \coqdocvar{\_} (\coqdocvar{rpo\_l\_valid} \coqdocvar{rpo\_infos}) \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{Hfind})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_};\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{Hfind};\coqdoctac{apply} (\coqdocvar{find\_is\_sound} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb})) \coqdocvar{\_} (\coqdocvar{rpo\_l\_valid} \coqdocvar{rpo\_infos}) \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{Hfind})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{Hfind};\coqdoctac{apply} (\coqdocvar{find\_is\_sound} \coqdocvar{equiv} \coqdocvar{\_} (\coqdocvar{equiv\_l\_valid} \coqdocvar{rpo\_infos}) \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{Hfind})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_};\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{Hfind}; \coqdoctac{apply} \coqdocvar{equiv\_sym}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{find\_is\_sound} \coqdocvar{equiv} \coqdocvar{\_} (\coqdocvar{equiv\_l\_valid} \coqdocvar{rpo\_infos}) \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{Hfind})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{E1} := \coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t1} \coqdocvar{t2}); \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t1} \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{E1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{E1}; \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \coqdockw{\ensuremath{\forall}} \coqdocvar{v} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{var\_in\_term\_list} \coqdocvar{v} \coqdocvar{l} = \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) (\coqdocvar{Var} \coqdocvar{v}) (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v} \coqdocvar{f} \coqdocvar{l} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{trans\_clos\_subterm\_rpo}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} : (\coqdocvar{In} (\coqdocvar{Var} \coqdocvar{v}) \coqdocvar{l} \ensuremath{\lor} \coqdoceol
\coqdocindent{9.00em}
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{t}, \coqdocvar{In} \coqdocvar{t} \coqdocvar{l} \ensuremath{\land} \coqdocvar{trans\_clos} \coqdocvar{direct\_subterm} (\coqdocvar{Var} \coqdocvar{v}) \coqdocvar{t})) \ensuremath{\rightarrow} \coqdocvar{trans\_clos} \coqdocvar{direct\_subterm} (\coqdocvar{Var} \coqdocvar{v}) (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{v\_in\_l} \ensuremath{|} [\coqdocvar{t} [\coqdocvar{t\_in\_l} \coqdocvar{H'}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{trans\_clos\_is\_trans} \coqdockw{with} \coqdocvar{t}; \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{clear} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{H}; \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{pattern} \coqdocvar{l}; \coqdoctac{refine} (\coqdocvar{list\_rec3} \coqdocvar{size} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}); \coqdoctac{clear} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{m}; \coqdoctac{induction} \coqdocvar{m} \coqdockw{as} [ \ensuremath{|} \coqdocvar{m}]; \coqdoctac{intros} [ \ensuremath{|} \coqdocvar{t} \coqdocvar{l}] \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{L}; \coqdocvar{absurd} (1 \ensuremath{\le} 0); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith};\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}); \coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} \coqdocvar{t}); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_ge\_one}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{L}; \coqdoctac{assert} (\coqdocvar{Sl} : \coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l} \ensuremath{\le} \coqdocvar{m}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}); \coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{plus\_le\_compat\_r} 1 (\coqdocvar{size} \coqdocvar{t}) (\coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l}));\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_ge\_one}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t} \coqdockw{as} [\coqdocvar{v'} \ensuremath{|} \coqdocvar{f'} \coqdocvar{l'}]; \coqdoctac{rewrite} \coqdocvar{var\_in\_term\_list\_equation}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{X.eq\_bool\_ok} \coqdocvar{v} \coqdocvar{v'}); \coqdoctac{case} (\coqdocvar{X.eq\_bool} \coqdocvar{v} \coqdocvar{v'}); [\coqdoctac{intros} \coqdocvar{v\_eq\_v'} \coqdocvar{\_} \ensuremath{|} \coqdoctac{intro} \coqdocvar{v\_diff\_v'}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{subst}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}; \coqdoctac{destruct} (\coqdocvar{IHm} \coqdocvar{\_} \coqdocvar{Sl} \coqdocvar{H}) \coqdockw{as} [\coqdocvar{v\_in\_l} \ensuremath{|} [\coqdocvar{t} [\coqdocvar{t\_in\_l} \coqdocvar{H'}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t}; \coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Sl'} : \coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l'} \ensuremath{\le} \coqdocvar{m}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}); \coqdoctac{rewrite} \coqdocvar{size\_unfold}; \coqdoctac{simpl};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_n\_S}; \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHm} \coqdocvar{\_} \coqdocvar{Sl'}); \coqdoctac{destruct} (\coqdocvar{var\_in\_term\_list} \coqdocvar{v} \coqdocvar{l'}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}; \coqdoctac{destruct} (\coqdocvar{H} (\coqdocvar{refl\_equal} \coqdocvar{\_})) \coqdockw{as} [\coqdocvar{v\_in\_l'} \ensuremath{|} [\coqdocvar{t} [\coqdocvar{t\_in\_l'} \coqdocvar{H'}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (\coqdocvar{Term} \coqdocvar{f'} \coqdocvar{l'}); \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} (\coqdocvar{Term} \coqdocvar{f'} \coqdocvar{l'}); \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{trans\_clos\_is\_trans} \coqdockw{with} \coqdocvar{t}; \coqdoctac{trivial}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{generalize} (\coqdocvar{IHm} \coqdocvar{\_} \coqdocvar{Sl}); \coqdoctac{destruct} (\coqdocvar{var\_in\_term\_list} \coqdocvar{v} \coqdocvar{l}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}; \coqdoctac{destruct} (\coqdocvar{H} (\coqdocvar{refl\_equal} \coqdocvar{\_})) \coqdockw{as} [\coqdocvar{v\_in\_l'} \ensuremath{|} [\coqdocvar{t} [\coqdocvar{t\_in\_l'} \coqdocvar{H'}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{t}; \coqdoctac{split}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t1} \coqdockw{as} [\coqdocvar{v1} \ensuremath{|} \coqdocvar{f1} \coqdocvar{l1}]; \coqdoctac{destruct} \coqdocvar{t2} \coqdockw{as} [\coqdocvar{v2} \ensuremath{|} \coqdocvar{f2} \coqdocvar{l2}]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{H} \coqdocvar{v1} \coqdocvar{f2} \coqdocvar{l2}); \coqdoctac{destruct} (\coqdocvar{var\_in\_term\_list} \coqdocvar{v1} \coqdocvar{l2}); \coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{trivial}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{H} \coqdocvar{v2} \coqdocvar{f1} \coqdocvar{l1}); \coqdoctac{destruct} (\coqdocvar{var\_in\_term\_list} \coqdocvar{v2} \coqdocvar{l1}); \coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{trivial}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_exists\_option\_is\_sound} \coqdoceol
\coqdocindent{1.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) \coqdocvar{l1});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{2.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{t1} [\coqdocvar{t1\_in\_l1} \coqdocvar{t1\_gt\_f2l2}]]; \coqdoctac{simpl}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{t1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{t1} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})); \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{try} \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H1}; \coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H1}; \coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_exists\_option\_is\_sound} \coqdoceol
\coqdocindent{1.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) \coqdocvar{l2});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{2.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{t2} [\coqdocvar{t2\_in\_l2} \coqdocvar{t2\_gt\_f1l1}]]; \coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{t2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHn} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t2}); \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{try} \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} \coqdocvar{Equiv}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} \coqdocvar{Lt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{prec\_eval\_is\_sound} \coqdocvar{f1} \coqdocvar{f2}); \coqdoctac{destruct} (\coqdocvar{prec\_eval} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{f1\_eq\_f2}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Sf1}:\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{apply} \coqdocvar{prec\_eq\_status}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}). \coqdoctac{rewrite} \coqdocvar{Sf1}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{lexico\_eval\_is\_sound} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1})\coqdoceol
\coqdocindent{16.00em}
(\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{lexico\_eval} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [\coqdocvar{E\_ll} [\coqdocvar{H1} \coqdocvar{H2}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdoctac{f\_equal} (@\coqdocvar{length} \coqdocvar{\_}) \coqdocvar{H1}); \coqdoctac{rewrite} (\coqdoctac{f\_equal} (@\coqdocvar{length} \coqdocvar{\_}) \coqdocvar{H2}); \coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{length\_map}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{beq\_nat\_refl}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{Eq\_lex} \coqdocvar{f1} \coqdocvar{f2} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Sf1}). \coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}). \coqdoctac{apply} \coqdocvar{H3'}; \coqdoctac{trivial}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H4}; \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{t1} \coqdocvar{t2}] \coqdocvar{ll}]; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_nil}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq\_list\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{t1} \coqdocvar{t2}); \coqdoctac{rewrite} (\coqdocvar{E\_ll} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))); \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{E\_ll}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{beq\_nat} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{length} \coqdocvar{l2})); \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{L}; \coqdoctac{apply} (@\coqdocvar{Top\_eq\_lex} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{f1} \coqdocvar{f2} \coqdocvar{l2} \coqdocvar{l1} \coqdocvar{Sf1}). \coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}). \coqdoctac{apply} \coqdocvar{H3'}; \coqdoctac{trivial}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H4}; \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{sym\_eq}; \coqdoctac{apply} \coqdocvar{beq\_nat\_true}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{t2} [\coqdocvar{l2'} [ \coqdocvar{\_} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{t2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ht} [\coqdocvar{H'} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a2} \coqdocvar{l2}]; [\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{H2}; \coqdoctac{apply} \coqdocvar{refl\_equal} \ensuremath{|} \coqdoctac{subst} \coqdocvar{l1}; \coqdoctac{discriminate}].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{rewrite} \coqdocvar{length\_app} \coqdoctac{in} \coqdocvar{L}; \coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{length\_map} \coqdoctac{in} \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{generalize} (\coqdocvar{beq\_nat\_true} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}); \coqdoctac{clear} \coqdocvar{L}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{u1} \coqdocvar{u2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{L}; \coqdoctac{injection} \coqdocvar{L}; \coqdoctac{clear} \coqdocvar{L}; \coqdoctac{intro} \coqdocvar{L}; \coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{L} \coqdocvar{H'}; \coqdoctac{subst} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{u1} \coqdocvar{u2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 1; \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{t1} \coqdocvar{t2}); \coqdoctac{rewrite} \coqdocvar{Ht}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 2.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u2}); \coqdoctac{rewrite} (\coqdocvar{Hll} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))); \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Hll}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{t2} [\coqdocvar{l2'} [\coqdocvar{\_} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{t2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ht} [\coqdocvar{H'} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst} \coqdocvar{l1}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{rewrite} \coqdocvar{length\_app} \coqdoctac{in} \coqdocvar{L}; \coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{length\_map} \coqdoctac{in} \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{generalize} (\coqdocvar{beq\_nat\_true} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}); \coqdoctac{clear} \coqdocvar{L}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{u1} \coqdocvar{u2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{L}; \coqdoctac{injection} \coqdocvar{L}; \coqdoctac{clear} \coqdocvar{L}; \coqdoctac{intro} \coqdocvar{L}; \coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l1}; \coqdoctac{rewrite} \coqdocvar{mem\_in\_eq} \coqdoctac{in} \coqdocvar{u\_in\_l1}; \coqdoctac{destruct} \coqdocvar{u\_in\_l1} \coqdockw{as} [\coqdocvar{u'} [\coqdocvar{u\_eq\_u'} \coqdocvar{u'\_in\_l1}]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H'} \coqdocvar{\_} \coqdocvar{u'\_in\_l1}) \coqdockw{as} [ [\coqdocvar{u2} [\coqdocvar{u2\_in\_l2} \coqdocvar{u'\_le\_u2}]] \ensuremath{|} \coqdocvar{H'{}'}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{u2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{u'\_le\_u2} \coqdockw{as} [\coqdocvar{u'\_eq\_u2} \ensuremath{|} \coqdocvar{u'\_lt\_u2}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} (\coqdocvar{equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{with} \coqdocvar{u'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u'} \coqdocvar{u2}); \coqdoctac{rewrite} \coqdocvar{u'\_eq\_u2}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_u'}); \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u'} \coqdocvar{u2}); \coqdoctac{rewrite} \coqdocvar{u'\_lt\_u2}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_u'}); \coqdoctac{generalize} (\coqdocvar{IHn} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdocvar{u'}); \coqdoctac{rewrite} \coqdocvar{H'{}'}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{generalize} (\coqdocvar{leb\_complete} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{rpo\_infos}.(\coqdocvar{bb}))); \coqdoctac{case} (\coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l1}) \coqdocvar{rpo\_infos}.(\coqdocvar{bb})); [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{simpl}; \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{leb\_complete} (\coqdocvar{length} \coqdocvar{l2}) (\coqdocvar{rpo\_infos}.(\coqdocvar{bb}))); \coqdoctac{case} (\coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l2}) (\coqdocvar{bb} \coqdocvar{rpo\_infos})); \coqdoctac{simpl}; [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{L2} \coqdocvar{L1}; \coqdoctac{apply} (@\coqdocvar{Top\_eq\_lex} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{f1} \coqdocvar{f2} \coqdocvar{l2} \coqdocvar{l1} \coqdocvar{Sf1}). \coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}). \coqdoctac{apply} \coqdocvar{H3'}; \coqdoctac{trivial}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H4}; \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{split}; [\coqdoctac{apply} \coqdocvar{L1} \ensuremath{|} \coqdoctac{apply} \coqdocvar{L2}]; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{L1} \coqdocvar{L2}; \coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{t2} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{t2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ht} [\coqdocvar{H'} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l1}; \coqdoctac{destruct} \coqdocvar{l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a2} \coqdocvar{l2}]; [\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{H2}; \coqdoctac{apply} \coqdocvar{refl\_equal} \ensuremath{|} \coqdoctac{constructor} 3].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{u1} \coqdocvar{u2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 3.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 2.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u2}); \coqdoctac{rewrite} (\coqdocvar{Hll} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))); \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Hll}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H'}; \coqdoctac{subst} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{u1} \coqdocvar{u2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 1; \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{t1} \coqdocvar{t2}); \coqdoctac{rewrite} \coqdocvar{Ht}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 2.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u2}); \coqdoctac{rewrite} (\coqdocvar{Hll} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))); \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Hll}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{L1} \coqdocvar{L2}; \coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{t2} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{t2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ht} [\coqdocvar{H'} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst} \coqdocvar{l1}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l1}; \coqdoctac{rewrite} \coqdocvar{mem\_in\_eq} \coqdoctac{in} \coqdocvar{u\_in\_l1}; \coqdoctac{destruct} \coqdocvar{u\_in\_l1} \coqdockw{as} [\coqdocvar{u'} [\coqdocvar{u\_eq\_u'} \coqdocvar{u'\_in\_l1}]].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l1}; \coqdoctac{rewrite} \coqdocvar{in\_map\_iff} \coqdoctac{in} \coqdocvar{u'\_in\_l1}; \coqdoctac{destruct} \coqdocvar{u'\_in\_l1} \coqdockw{as} [[\coqdocvar{u1} \coqdocvar{u2}] [\coqdocvar{H1} \coqdocvar{K2}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{u2}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l2}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{apply} \coqdocvar{in\_impl\_mem}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{in\_map\_iff}; \coqdoctac{\ensuremath{\exists}} (\coqdocvar{u1},\coqdocvar{u2}); \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}; \coqdoctac{subst} \coqdocvar{u1}; \coqdoctac{left}; \coqdoctac{apply} (\coqdocvar{equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{with} \coqdocvar{u'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u'} \coqdocvar{u2}); \coqdoctac{rewrite} (\coqdocvar{Hll} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{K2}); \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l1}; \coqdoctac{rewrite} \coqdocvar{mem\_in\_eq} \coqdoctac{in} \coqdocvar{u\_in\_l1}; \coqdoctac{destruct} \coqdocvar{u\_in\_l1} \coqdockw{as} [\coqdocvar{u'} [\coqdocvar{u\_eq\_u'} \coqdocvar{u'\_in\_l1}]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H'} \coqdocvar{\_} \coqdocvar{u'\_in\_l1}) \coqdockw{as} [ [\coqdocvar{u2} [\coqdocvar{u2\_in\_l2} \coqdocvar{u'\_le\_u2}]] \ensuremath{|} \coqdocvar{H'{}'}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{u2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{u'\_le\_u2} \coqdockw{as} [\coqdocvar{u'\_eq\_u2} \ensuremath{|} \coqdocvar{u'\_lt\_u2}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} (\coqdocvar{equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{with} \coqdocvar{u'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u'} \coqdocvar{u2}); \coqdoctac{rewrite} \coqdocvar{u'\_eq\_u2}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_u'}); \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u'} \coqdocvar{u2}); \coqdoctac{rewrite} \coqdocvar{u'\_lt\_u2}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_u'}); \coqdoctac{generalize} (\coqdocvar{IHn} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdocvar{u'}); \coqdoctac{rewrite} \coqdocvar{H'{}'}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{beq\_nat} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{length} \coqdocvar{l2})); \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Sf2}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2} = \coqdocvar{Lex}).\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}). \coqdoctac{apply} \coqdocvar{H3'}; \coqdoctac{trivial}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H4}; \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{L}; \coqdoctac{apply} (@\coqdocvar{Top\_eq\_lex} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{f2} \coqdocvar{f1} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Sf2}). \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} \coqdocvar{beq\_nat\_true}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{l1'} [ \coqdocvar{\_} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{t2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ht} [\coqdocvar{H'} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a1} \coqdocvar{l1}]; [\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{H1}; \coqdoctac{apply} \coqdocvar{refl\_equal} \ensuremath{|} \coqdoctac{subst} \coqdocvar{l2}; \coqdoctac{discriminate}].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{rewrite} \coqdocvar{length\_app} \coqdoctac{in} \coqdocvar{L}; \coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{length\_map} \coqdoctac{in} \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{generalize} (\coqdocvar{beq\_nat\_true} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}); \coqdoctac{clear} \coqdocvar{L}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{u1} \coqdocvar{u2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{L}; \coqdoctac{injection} \coqdocvar{L}; \coqdoctac{clear} \coqdocvar{L}; \coqdoctac{intro} \coqdocvar{L}; \coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{L} \coqdocvar{H'}; \coqdoctac{subst} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{u1} \coqdocvar{u2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 1; \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{t1} \coqdocvar{t2}); \coqdoctac{rewrite} \coqdocvar{Ht}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 2.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u2}); \coqdoctac{rewrite} (\coqdocvar{Hll} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))); \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Hll}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{l1'} [\coqdocvar{\_} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{t2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ht} [\coqdocvar{H'} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst} \coqdocvar{l2}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{rewrite} \coqdocvar{length\_app} \coqdoctac{in} \coqdocvar{L}; \coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{length\_map} \coqdoctac{in} \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{generalize} (\coqdocvar{beq\_nat\_true} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L}); \coqdoctac{clear} \coqdocvar{L}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{u1} \coqdocvar{u2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{L}; \coqdoctac{injection} \coqdocvar{L}; \coqdoctac{clear} \coqdocvar{L}; \coqdoctac{intro} \coqdocvar{L}; \coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l2}; \coqdoctac{rewrite} \coqdocvar{mem\_in\_eq} \coqdoctac{in} \coqdocvar{u\_in\_l2}; \coqdoctac{destruct} \coqdocvar{u\_in\_l2} \coqdockw{as} [\coqdocvar{u'} [\coqdocvar{u\_eq\_u'} \coqdocvar{u'\_in\_l2}]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H'} \coqdocvar{\_} \coqdocvar{u'\_in\_l2}) \coqdockw{as} [ [\coqdocvar{u1} [\coqdocvar{u1\_in\_l1} \coqdocvar{u'\_le\_u1}]] \ensuremath{|} \coqdocvar{H'{}'}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{u1}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{u'\_le\_u1} \coqdockw{as} [\coqdocvar{u'\_eq\_u1} \ensuremath{|} \coqdocvar{u'\_lt\_u1}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} (\coqdocvar{equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{with} \coqdocvar{u'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u'}); \coqdoctac{rewrite} \coqdocvar{u'\_eq\_u1}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_u'}); \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u'}); \coqdoctac{rewrite} \coqdocvar{u'\_lt\_u1}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_u'}); \coqdoctac{generalize} (\coqdocvar{IHn} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{u'}); \coqdoctac{rewrite} \coqdocvar{H'{}'}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{generalize} (\coqdocvar{leb\_complete} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{rpo\_infos}.(\coqdocvar{bb}))); \coqdoctac{case} (\coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l1}) \coqdocvar{rpo\_infos}.(\coqdocvar{bb})); [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{simpl}; \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{leb\_complete} (\coqdocvar{length} \coqdocvar{l2}) (\coqdocvar{rpo\_infos}.(\coqdocvar{bb}))); \coqdoctac{case} (\coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l2}) (\coqdocvar{bb} \coqdocvar{rpo\_infos})); \coqdoctac{simpl}; [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{trivial}].\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}). \coqdoctac{apply} \coqdocvar{H3'}; \coqdoctac{trivial}. \coqdoctac{assert} (\coqdocvar{Sf2}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2} = \coqdocvar{Lex}). \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H4}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{L2} \coqdocvar{L1}; \coqdoctac{apply} (@\coqdocvar{Top\_eq\_lex} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{f2} \coqdocvar{f1} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Sf2}). \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym};\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{split}; [\coqdoctac{apply} \coqdocvar{L2} \ensuremath{|} \coqdoctac{apply} \coqdocvar{L1}]; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{L1} \coqdocvar{L2}; \coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{t2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ht} [\coqdocvar{H'} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l2}; \coqdoctac{destruct} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a1} \coqdocvar{l2}]; [\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{H1}; \coqdoctac{apply} \coqdocvar{refl\_equal} \ensuremath{|} \coqdoctac{constructor} 3].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{u1} \coqdocvar{u2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 3.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 2.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u2}); \coqdoctac{rewrite} (\coqdocvar{Hll} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))); \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Hll}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H'}; \coqdoctac{subst} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{u1} \coqdocvar{u2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 1; \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{t1} \coqdocvar{t2}); \coqdoctac{rewrite} \coqdocvar{Ht}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{constructor} 2.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u2}); \coqdoctac{rewrite} (\coqdocvar{Hll} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))); \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}; \coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Hll}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{L1} \coqdocvar{L2}; \coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [[\coqdocvar{H1} \coqdocvar{H2}] \ensuremath{|} [[\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{l1'} [\coqdocvar{Hll} [\coqdocvar{H1} \coqdocvar{H2}]]]]] \ensuremath{|} [\coqdocvar{ll} [\coqdocvar{t1} [\coqdocvar{t2} [\coqdocvar{l1'} [\coqdocvar{l2'} [\coqdocvar{Hll} [\coqdocvar{Ht} [\coqdocvar{H'} [\coqdocvar{H1} \coqdocvar{H2}]]]]]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst} \coqdocvar{l2}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l2}; \coqdoctac{rewrite} \coqdocvar{mem\_in\_eq} \coqdoctac{in} \coqdocvar{u\_in\_l2}; \coqdoctac{destruct} \coqdocvar{u\_in\_l2} \coqdockw{as} [\coqdocvar{u'} [\coqdocvar{u\_eq\_u'} \coqdocvar{u'\_in\_l2}]].\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l2}; \coqdoctac{rewrite} \coqdocvar{in\_map\_iff} \coqdoctac{in} \coqdocvar{u'\_in\_l2}; \coqdoctac{destruct} \coqdocvar{u'\_in\_l2} \coqdockw{as} [[\coqdocvar{u1} \coqdocvar{u2}] [\coqdocvar{K1} \coqdocvar{K2}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{u1}.\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l1}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{apply} \coqdocvar{in\_impl\_mem}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{in\_map\_iff}; \coqdoctac{\ensuremath{\exists}} (\coqdocvar{u1},\coqdocvar{u2}); \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{K1}; \coqdoctac{subst} \coqdocvar{u2}; \coqdoctac{left}; \coqdoctac{apply} (\coqdocvar{equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{with} \coqdocvar{u'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u'}); \coqdoctac{rewrite} (\coqdocvar{Hll} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{K2}); \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_in\_l2}; \coqdoctac{rewrite} \coqdocvar{mem\_in\_eq} \coqdoctac{in} \coqdocvar{u\_in\_l2}; \coqdoctac{destruct} \coqdocvar{u\_in\_l2} \coqdockw{as} [\coqdocvar{u'} [\coqdocvar{u\_eq\_u'} \coqdocvar{u'\_in\_l2}]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H'} \coqdocvar{\_} \coqdocvar{u'\_in\_l2}) \coqdockw{as} [ [\coqdocvar{u1} [\coqdocvar{u1\_in\_l1} \coqdocvar{u'\_le\_u1}]] \ensuremath{|} \coqdocvar{H'{}'}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Subterm} \coqdockw{with} \coqdocvar{u1}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{u'\_le\_u1} \coqdockw{as} [\coqdocvar{u'\_eq\_u1} \ensuremath{|} \coqdocvar{u'\_lt\_u1}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} (\coqdocvar{equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdockw{with} \coqdocvar{u'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u'}); \coqdoctac{rewrite} \coqdocvar{u'\_eq\_u1}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_u'}); \coqdoctac{generalize} (\coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u'}); \coqdoctac{rewrite} \coqdocvar{u'\_lt\_u1}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u\_eq\_u'}); \coqdoctac{generalize} (\coqdocvar{IHn} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{u'}); \coqdoctac{rewrite} \coqdocvar{H'{}'}; \coqdoctac{intro}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{length} \coqdocvar{l2})\coqdoceol
\coqdocindent{3.00em}
|| \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \&\& \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l2}) (\coqdocvar{bb} \coqdocvar{rpo\_infos})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{length} \coqdocvar{l2})\coqdoceol
\coqdocindent{3.00em}
|| \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \&\& \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l2}) (\coqdocvar{bb} \coqdocvar{rpo\_infos})); \coqdoctac{trivial}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{prec\_eq\_status} \coqdocvar{Prec}). \coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{f1} \coqdocvar{f2}). \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1} = \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2}). \coqdoctac{apply} \coqdocvar{H3'}; \coqdoctac{trivial}. \coqdoctac{assert} (\coqdocvar{Sf2}: \coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f2} = \coqdocvar{Mul}). \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H4}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{remove\_equiv\_eval\_list\_is\_sound} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Sf1}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as} [ [[ \ensuremath{|} \coqdocvar{t1'} \coqdocvar{l1'}] [ \ensuremath{|} \coqdocvar{t2'} \coqdocvar{l2'}]] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [\coqdocvar{E\_ll} [\coqdocvar{P1} [\coqdocvar{P2} \coqdocvar{\_}]]]]. \coqdoctac{apply} (@\coqdocvar{Eq\_mul} \coqdocvar{f1} \coqdocvar{f2} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{Sf1}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{P1}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{P2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll}); \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll}); \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{E\_ll'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}; \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{E\_ll} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}) \coqdoctac{in} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{E\_ll} \coqdocvar{P1} \coqdocvar{P2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{t1} \coqdocvar{t2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{right}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [\coqdocvar{E\_ll} [\coqdocvar{P1} [\coqdocvar{P2} \coqdocvar{\_}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_mul}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{\_} \coqdocvar{t2'} \coqdocvar{l2'} \coqdocvar{nil} \coqdocvar{l1}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} ((\coqdocvar{t2'} :: \coqdocvar{l2'}) ++ (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app1}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll}).\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{E\_ll'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}; \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{E\_ll} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}) \coqdoctac{in} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{E\_ll} \coqdocvar{P1} \coqdocvar{P2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{t1} \coqdocvar{t2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{right}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [\coqdocvar{E\_ll} [\coqdocvar{P1} [\coqdocvar{P2} \coqdocvar{\_}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_mul}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{\_} \coqdocvar{t1'} \coqdocvar{l1'} \coqdocvar{nil} \coqdocvar{l2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} ((\coqdocvar{t1'} :: \coqdocvar{l1'}) ++ (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app1}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{E\_ll'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}; \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{E\_ll} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}) \coqdoctac{in} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{E\_ll} \coqdocvar{P1} \coqdocvar{P2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{t1} \coqdocvar{t2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{right}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'} := \coqdocvar{mult\_eval\_is\_sound\_weak} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) (\coqdocvar{t1'} :: \coqdocvar{l1'}) (\coqdocvar{t2'} :: \coqdocvar{l2'})).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mult\_eval} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) (\coqdocvar{t1'} :: \coqdocvar{l1'}) (\coqdocvar{t2'} :: \coqdocvar{l2'})) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [\coqdocvar{E\_ll} [\coqdocvar{P1} [\coqdocvar{P2} \coqdocvar{\_}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{E\_ll'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}; \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{E\_ll} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}) \coqdoctac{in} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_mul}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{\_} \coqdocvar{t2'} \coqdocvar{l2'} (\coqdocvar{t1'} :: \coqdocvar{l1'}) (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} ((\coqdocvar{t2'} :: \coqdocvar{l2'}) ++ \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app1}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{E\_ll} \coqdocvar{P1} \coqdocvar{P2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{t1} \coqdocvar{t2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{right}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{left}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u1\_mem\_l1'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{u1\_mem\_l1'}) \coqdockw{as} [\coqdocvar{u1'} [\coqdocvar{k1} [\coqdocvar{k1'} [\coqdocvar{u1\_eq\_u1'} [\coqdocvar{H'} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{u1\_eq\_u1'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1'\_in\_l1'} : \coqdocvar{In} \coqdocvar{u1'} (\coqdocvar{t1'} :: \coqdocvar{l1'})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H'{}'} \coqdocvar{\_} \coqdocvar{u1'\_in\_l1'}) \coqdockw{as} [\coqdocvar{u2} [\coqdocvar{u2\_in\_l2'} \coqdocvar{u1\_lt\_u2}]];\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{u2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'{}'} := \coqdocvar{IHn} \coqdocvar{u2} \coqdocvar{u1'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{u1\_lt\_u2} \coqdoctac{in} \coqdocvar{H'{}'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u1\_eq\_u1'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [\coqdocvar{E\_ll} [\coqdocvar{P1} [\coqdocvar{P2} \coqdocvar{\_}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{E\_ll'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}; \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{E\_ll} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}) \coqdoctac{in} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Top\_eq\_mul}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{\_} \coqdocvar{t1'} \coqdocvar{l1'} (\coqdocvar{t2'} :: \coqdocvar{l2'}) (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} ((\coqdocvar{t2'} :: \coqdocvar{l2'}) ++ \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app1}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{E\_ll} \coqdocvar{P1} \coqdocvar{P2}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{t1} \coqdocvar{t2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{right}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{left}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u2} \coqdocvar{u2\_mem\_l2'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{u2\_mem\_l2'}) \coqdockw{as} [\coqdocvar{u2'} [\coqdocvar{k2} [\coqdocvar{k2'} [\coqdocvar{u2\_eq\_u2'} [\coqdocvar{H'} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{u2\_eq\_u2'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u2'\_in\_l2'} : \coqdocvar{In} \coqdocvar{u2'} (\coqdocvar{t2'} :: \coqdocvar{l2'})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H'{}'} \coqdocvar{\_} \coqdocvar{u2'\_in\_l2'}) \coqdockw{as} [\coqdocvar{u1} [\coqdocvar{u1\_in\_l1'} \coqdocvar{u2\_lt\_u1}]];\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{u1}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'{}'} := \coqdocvar{IHn} \coqdocvar{u1} \coqdocvar{u2'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{u2\_lt\_u1} \coqdoctac{in} \coqdocvar{H'{}'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u2\_eq\_u2'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{f1\_lt\_f2}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_forall\_option\_is\_sound}\coqdoceol
\coqdocindent{3.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) \coqdocvar{l1});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{3.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l1\_lt\_s2}; \coqdoctac{apply} \coqdocvar{Top\_gt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t1\_mem\_l1};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{t1\_mem\_l1}) \coqdockw{as} [\coqdocvar{t1'} [\coqdocvar{k1} [\coqdocvar{k1'} [\coqdocvar{t1\_eq\_t1'} [\coqdocvar{H'} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{t1\_eq\_t1'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{t1'\_in\_l1} : \coqdocvar{In} \coqdocvar{t1'} \coqdocvar{l1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{t1\_eq\_t1'}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'} := \coqdocvar{l1\_lt\_s2} \coqdocvar{t1'} \coqdocvar{t1'\_in\_l1}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'{}'} := \coqdocvar{IHn} \coqdocvar{t1'} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}));\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1'} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{f2\_lt\_f1}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_forall\_option\_is\_sound}\coqdoceol
\coqdocindent{3.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) \coqdocvar{l2}); \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{3.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{s1\_gt\_l2}; \coqdoctac{apply} \coqdocvar{Top\_gt}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t2} \coqdocvar{t2\_mem\_l2}; \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{t2\_mem\_l2}) \coqdockw{as} [\coqdocvar{t2'} [\coqdocvar{k2} [\coqdocvar{k2'} [\coqdocvar{t2\_eq\_t2'} [\coqdocvar{H'} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{t2\_eq\_t2'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{t2'\_in\_l2} : \coqdocvar{In} \coqdocvar{t2'} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{t2\_eq\_t2'}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'} := \coqdocvar{s1\_gt\_l2} \coqdocvar{t2'} \coqdocvar{t2'\_in\_l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'{}'} := \coqdocvar{IHn} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t2'});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t2'}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{lexico\_eval\_fully\_evaluates} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1} \coqdocvar{l2}, \coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{s2} \coqdocvar{t1} \ensuremath{\not=} \coqdocvar{None}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{t2} \ensuremath{\not=} \coqdocvar{None}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\not=} \coqdocvar{None}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{lexico\_eval} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\not=} \coqdocvar{None}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1}; \coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros} [ \ensuremath{|} \coqdocvar{t2} \coqdocvar{l2}] \coqdocvar{Es2} \coqdocvar{Es1} \coqdocvar{E};\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{try} \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} := \coqdocvar{E} \coqdocvar{t1} \coqdocvar{t2} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})) (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})));\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl1}; \coqdoctac{intros}; [\coqdoctac{apply} \coqdocvar{Es2} \ensuremath{|} \coqdoctac{apply} \coqdocvar{Es1} \ensuremath{|} \coqdoctac{apply} \coqdocvar{E}]; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{term\_gt\_list}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_forall\_option\_is\_sound}\coqdoceol
\coqdocindent{3.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{s2} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{end}) \coqdocvar{l1});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{s2} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H}; \coqdoctac{assert} (\coqdocvar{H} := \coqdocvar{Es2} \coqdocvar{t1} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{s2} \coqdocvar{t1}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H}; \coqdoctac{assert} (\coqdocvar{H} := \coqdocvar{Es2} \coqdocvar{t1} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{s2} \coqdocvar{t1}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{u1} [\coqdocvar{u1\_in\_l1} \coqdocvar{pt1s2\_eq\_none}]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{Es2} \coqdocvar{\_} (\coqdocvar{or\_intror} \coqdocvar{\_} \coqdocvar{u1\_in\_l1})).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{s2} \coqdocvar{u1}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{term\_gt\_list}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_forall\_option\_is\_sound}\coqdoceol
\coqdocindent{4.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{end}) \coqdocvar{l2});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{4.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{s1} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{end}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H}; \coqdoctac{assert} (\coqdocvar{H} := \coqdocvar{Es1} \coqdocvar{t2} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{s1} \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H}; \coqdoctac{assert} (\coqdocvar{H} := \coqdocvar{Es1} \coqdocvar{t2} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{s1} \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{u2} [\coqdocvar{u2\_in\_l2} \coqdocvar{ps1u2\_eq\_none}]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{Es1} \coqdocvar{\_} (\coqdocvar{or\_intror} \coqdocvar{\_} \coqdocvar{u2\_in\_l2})).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{s1} \coqdocvar{u2}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_eval\_fully\_evaluates} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2}, \coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\not=} \coqdocvar{None}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t2} \coqdocvar{t1} \ensuremath{\not=} \coqdocvar{None}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{mult\_eval} \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\not=} \coqdocvar{None}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}] \coqdocvar{l2} \coqdocvar{E} \coqdocvar{E'}; \coqdoctac{unfold} \coqdocvar{mult\_eval}, \coqdocvar{list\_gt\_list}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{clear} \coqdocvar{E}; \coqdoctac{induction} \coqdocvar{l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t2} \coqdocvar{l2}]; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_forall\_option} (\coqdockw{fun} \coqdocvar{\_} : \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl2}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_forall\_option\_is\_sound}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{s} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) (\coqdocvar{t1} :: \coqdocvar{l1})) \coqdocvar{l2}); \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{s} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) (\coqdocvar{t1} :: \coqdocvar{l1})) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_forall\_option\_is\_sound}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{s} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) \coqdocvar{l2}) (\coqdocvar{t1} :: \coqdocvar{l1}));\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{s} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) \coqdocvar{l2}) (\coqdocvar{t1} :: \coqdocvar{l1})) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{u1} [\coqdocvar{u1\_in\_l1} \coqdocvar{H}]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{list\_exists\_option\_is\_sound}\coqdoceol
\coqdocindent{3.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{u1} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) \coqdocvar{l2}); \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [ [\coqdocvar{u2} [\coqdocvar{u2\_in\_l2} \coqdocvar{pu1u2\_eq\_none}]] \coqdocvar{\_}].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{E'} \coqdocvar{u1} \coqdocvar{u2} \coqdocvar{u1\_in\_l1} \coqdocvar{u2\_in\_l2});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{u2} \coqdocvar{u1}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{u2} [\coqdocvar{u2\_in\_l2} \coqdocvar{H}]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{list\_exists\_option\_is\_sound}\coqdoceol
\coqdocindent{3.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{u2} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) (\coqdocvar{t1} :: \coqdocvar{l1})); \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [ [\coqdocvar{u1} [\coqdocvar{u1\_in\_l1} \coqdocvar{pu1u2\_eq\_none}]] \coqdocvar{\_}].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{E} \coqdocvar{u1} \coqdocvar{u2} \coqdocvar{u1\_in\_l1} \coqdocvar{u2\_in\_l2});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{u1} \coqdocvar{u2}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_eval\_terminates} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\not=} \coqdocvar{None}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n}; \coqdoctac{induction} \coqdocvar{n} \coqdockw{as} [ \ensuremath{|} \coqdocvar{n}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St1}; \coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (1 \ensuremath{\le} 0); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (1 + \coqdocvar{size} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
[\coqdoctac{apply} \coqdocvar{le\_plus\_l} \ensuremath{|} \coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}; \coqdoctac{apply} \coqdocvar{size\_ge\_one}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St}; \coqdoctac{rewrite} \coqdocvar{rpo\_eval\_equation}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intro};\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intro};\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intro};\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intro};\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{T} := @\coqdocvar{equiv\_eval\_terminates} \coqdocvar{rpo\_infos} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St}); \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t1} \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{try} \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t1} \coqdockw{as} [\coqdocvar{v1} \ensuremath{|} \coqdocvar{f1} \coqdocvar{l1}]; \coqdoctac{destruct} \coqdocvar{t2} \coqdockw{as} [\coqdocvar{v2} \ensuremath{|} \coqdocvar{f2} \coqdocvar{l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{var\_in\_term\_list} \coqdocvar{v1} \coqdocvar{l2}); \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{var\_in\_term\_list} \coqdocvar{v2} \coqdocvar{l1}); \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_exists\_option\_is\_sound} \coqdoceol
\coqdocindent{1.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}) \coqdocvar{l1});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{1.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{simpl}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_exists\_option\_is\_sound} \coqdoceol
\coqdocindent{1.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{l2});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{4.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{simpl}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{simpl}; \coqdoctac{destruct} (\coqdocvar{prec\_eval} \coqdocvar{f1} \coqdocvar{f2}); \coqdoctac{try} \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{status} \coqdocvar{Prec} \coqdocvar{f1}).\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{beq\_nat} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{length} \coqdocvar{l2})\coqdoceol
\coqdocindent{2.00em}
|| \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \&\& \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l2}) (\coqdocvar{bb} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lexico\_eval\_fully\_evaluates}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t1\_in\_l1}; \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St}).\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}))) \coqdockw{with} \coqdoceol
\coqdocindent{8.00em}
(\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}; \coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t2} \coqdocvar{t2\_in\_l2}; \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St}); \coqdoctac{rewrite} \coqdocvar{plus\_comm};\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t2} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}))) \coqdockw{with} \coqdoceol
\coqdocindent{8.00em}
(\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t2}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1})); \coqdoctac{trivial}; \coqdoctac{rewrite} \coqdocvar{plus\_comm};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_l}; \coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1\_in\_l1} \coqdocvar{t2\_in\_l2}; \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2})) \coqdockw{with}  (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1}) + \coqdocvar{size} \coqdocvar{t2}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_le\_weak}; \coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{remove\_equiv\_eval\_list\_is\_sound} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as} [ [[ \ensuremath{|} \coqdocvar{t1'} \coqdocvar{l1'}] [ \ensuremath{|} \coqdocvar{t2'} \coqdocvar{l2'}]] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{ll} [\coqdocvar{H} [\coqdocvar{P1} [\coqdocvar{P2} \coqdocvar{H'}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{mult\_eval\_fully\_evaluates}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1\_in\_l1'} \coqdocvar{t2\_in\_l2'}; \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2})) \coqdockw{with}  (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1}) + \coqdocvar{size} \coqdocvar{t2}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{simpl};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P1}); \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_le\_weak}; \coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{simpl};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P2}); \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1\_in\_l1'} \coqdocvar{t2\_in\_l2'}; \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t2} + \coqdocvar{size} \coqdocvar{t1})) \coqdockw{with}  (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t2}) + \coqdocvar{size} \coqdocvar{t1}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm}; \coqdoctac{apply} \coqdocvar{plus\_le\_compat}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_le\_weak}; \coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{simpl};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P1}); \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{simpl};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P2}); \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{t1} [\coqdocvar{t2} [\coqdocvar{t1\_in\_l1} [\coqdocvar{t2\_in\_l2} \coqdocvar{H}]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := @\coqdocvar{equiv\_eval\_terminates} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2})) \coqdockw{with}  (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1}) + \coqdocvar{size} \coqdocvar{t2}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_le\_weak}; \coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_forall\_option\_is\_sound}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}) \coqdocvar{l1});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{u1} [\coqdocvar{u1\_in\_l1} \coqdocvar{H}]]; \coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{IHn} \coqdocvar{u1} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})); \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u1} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{u1} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}))) \coqdockw{with} \coqdoceol
\coqdocindent{8.00em}
(\coqdocvar{S} (\coqdocvar{size} \coqdocvar{u1}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}; \coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize}  (\coqdocvar{list\_forall\_option\_is\_sound}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}) \coqdocvar{l2});\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{u2} [\coqdocvar{u2\_in\_l2} \coqdocvar{H}]]; \coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{IHn} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{u2}); \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{u2}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St}); \coqdoctac{rewrite} \coqdocvar{plus\_comm};\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{u2} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}))) \coqdockw{with} \coqdoceol
\coqdocindent{8.00em}
(\coqdocvar{S} (\coqdocvar{size} \coqdocvar{u2}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1})); \coqdoctac{trivial}; \coqdoctac{rewrite} \coqdocvar{plus\_comm};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_l}; \coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [[\coqdocvar{u2} [\coqdocvar{u2\_in\_l2} \coqdocvar{H}]] \coqdocvar{\_}]; \coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{IHn} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{u2}); \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{u2}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St}); \coqdoctac{rewrite} \coqdocvar{plus\_comm};\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{u2} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}))) \coqdockw{with} \coqdoceol
\coqdocindent{8.00em}
(\coqdocvar{S} (\coqdocvar{size} \coqdocvar{u2}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1})); \coqdoctac{trivial}; \coqdoctac{rewrite} \coqdocvar{plus\_comm};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_l}; \coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [[\coqdocvar{u1} [\coqdocvar{u1\_in\_l1} \coqdocvar{H}]] \coqdocvar{\_}]; \coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{IHn} \coqdocvar{u1} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})); \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u1} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{u1} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}))) \coqdockw{with} \coqdoceol
\coqdocindent{8.00em}
(\coqdocvar{S} (\coqdocvar{size} \coqdocvar{u1}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}; \coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{T}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_eval\_is\_complete\_equivalent} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Equivalent}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St} \coqdocvar{t1\_eq\_t2}; \coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{rpo\_eval\_equation}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{abs}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{find\_is\_sound} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb})) \coqdocvar{\_} (\coqdocvar{rpo\_l\_valid} \coqdocvar{rpo\_infos}) \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{abs}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{h};\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro};\coqdoctac{apply} \coqdocvar{rpo\_antirefl} \coqdockw{with} (1:=\coqdocvar{H}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{t1\_eq\_t2}) \coqdoctac{in} \coqdocvar{h}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{h1}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{abs}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{find\_is\_sound} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb})) \coqdocvar{\_} (\coqdocvar{rpo\_l\_valid} \coqdocvar{rpo\_infos}) \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{abs}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{h};\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t2} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro};\coqdoctac{apply} \coqdocvar{rpo\_antirefl} \coqdockw{with} (1:=\coqdocvar{H}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{t1\_eq\_t2}) \coqdoctac{in} \coqdocvar{h}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{h2}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{h3}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{h4}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} := @\coqdocvar{equiv\_eval\_is\_sound}  \coqdocvar{rpo\_infos} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{var\_case2} : \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{v} \coqdocvar{f} \coqdocvar{l}, \coqdocvar{rpo} \coqdocvar{n} (\coqdocvar{Var} \coqdocvar{v}) (\coqdocvar{Term} \coqdocvar{f} \coqdocvar{l}) \ensuremath{\rightarrow} \coqdocvar{var\_in\_term\_list} \coqdocvar{v} \coqdocvar{l} = \coqdocvar{true} .\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{m} \coqdocvar{v} \coqdocvar{f} \coqdocvar{l} \coqdocvar{v\_lt\_t}; \coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{v\_lt\_t} \coqdockw{as} [ \coqdocvar{f2} \coqdocvar{l2} \coqdocvar{u} \coqdocvar{s} \coqdocvar{s\_in\_l} \coqdocvar{v\_le\_s} \ensuremath{|} \ensuremath{|} \ensuremath{|} ]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{s} \coqdocvar{s\_in\_l} \coqdocvar{v\_le\_s}; \coqdoctac{clear} \coqdocvar{v\_lt\_t} \coqdocvar{s} \coqdocvar{s\_in\_l} \coqdocvar{v\_le\_s}; \coqdoceol
\coqdocnoindent
\coqdoctac{pattern} \coqdocvar{l}; \coqdoctac{apply} (\coqdocvar{list\_rec3} \coqdocvar{size}); \coqdoctac{clear} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{n}; \coqdoctac{induction} \coqdocvar{n} \coqdockw{as} [ \ensuremath{|} \coqdocvar{n}]; \coqdoctac{intros} [ \ensuremath{|} \coqdocvar{t} \coqdocvar{l}] \coqdocvar{Sl} \coqdocvar{s} \coqdocvar{s\_in\_l} \coqdocvar{v\_le\_s}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Sl}; \coqdocvar{absurd} (1 \ensuremath{\le} 0); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{Sl}); \coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_ge\_one}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_plus\_l}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{s\_in\_l}; \coqdoctac{destruct} \coqdocvar{s\_in\_l} \coqdockw{as} [\coqdocvar{s\_eq\_t} \ensuremath{|} \coqdocvar{s\_in\_l}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{equiv\_rpo\_equiv\_3} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{s\_eq\_t}) \coqdoctac{in} \coqdocvar{v\_le\_s}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{v\_le\_s}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H}; \coqdoctac{subst};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{var\_in\_term\_list\_equation}; \coqdoctac{simpl};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{eq\_var\_bool\_refl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{g} \coqdocvar{k} \coqdocvar{u1} \coqdocvar{s'} \coqdocvar{s'\_in\_k} \coqdocvar{v\_le\_s'} \ensuremath{|} \ensuremath{|} |]; \coqdoctac{subst};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{var\_in\_term\_list\_equation}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Sk} : \coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{k} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{Sl}); \coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{le\_n\_S};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{list\_size\_fold} \coqdocvar{size} \coqdocvar{k}); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{IHn} \coqdocvar{k} \coqdocvar{Sk} \coqdocvar{s'} \coqdocvar{s'\_in\_k} \coqdocvar{v\_le\_s'}); \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Sl'} : \coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{Sl}); \coqdoctac{simpl};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{plus\_le\_compat\_r} 1 (\coqdocvar{size} \coqdocvar{t}) (\coqdocvar{list\_size} \coqdocvar{size} \coqdocvar{l}));\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_ge\_one}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{var\_in\_term\_list\_equation}; \coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{IHn} \coqdocvar{l} \coqdocvar{Sl'} \coqdocvar{s} \coqdocvar{s\_in\_l} \coqdocvar{v\_le\_s}); \coqdoctac{destruct} \coqdocvar{t} \coqdockw{as} [\coqdocvar{v'} \ensuremath{|} \coqdocvar{g} \coqdocvar{k}].\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{X.eq\_bool} \coqdocvar{v} \coqdocvar{v'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{case} (\coqdocvar{var\_in\_term\_list} \coqdocvar{v} \coqdocvar{k}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_eval\_is\_complete\_less\_greater} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\land}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t2} \coqdocvar{t1} = \coqdocvar{Some} \coqdocvar{Greater\_than}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n}; \coqdoctac{induction} \coqdocvar{n} \coqdockw{as} [ \ensuremath{|} \coqdocvar{n}]; \coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St} \coqdocvar{t1\_lt\_t2}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (1 \ensuremath{\le} 0); \coqdoctac{auto} \coqdockw{with} \coqdocvar{arith}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_trans} \coqdockw{with} (1 + \coqdocvar{size} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
[\coqdoctac{apply} \coqdocvar{le\_plus\_l} \ensuremath{|} \coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}; \coqdoctac{apply} \coqdocvar{size\_ge\_one}].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{TE} := @\coqdocvar{equiv\_eval\_terminates} \coqdocvar{rpo\_infos} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{R} := \coqdocvar{rpo\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t1} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{T} := @\coqdocvar{rpo\_eval\_terminates} \coqdocvar{rpo\_infos} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm} \coqdoctac{in} \coqdocvar{St};\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{TE'} := @\coqdocvar{equiv\_eval\_terminates} \coqdocvar{rpo\_infos} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{R'} := \coqdocvar{rpo\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t2} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{T'} := @\coqdocvar{rpo\_eval\_terminates} \coqdocvar{rpo\_infos} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t2} \coqdocvar{t1} \coqdocvar{St}).\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \coqdocvar{rpo\_eval\_equation};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{rpo\_eval\_equation} \coqdoctac{in} \coqdocvar{R}; \coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{rpo\_eval\_equation} \coqdoctac{in} \coqdocvar{T};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{rpo\_eval\_equation} \coqdoctac{in} \coqdocvar{R'}; \coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{rpo\_eval\_equation} \coqdoctac{in} \coqdocvar{T'}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{R} \coqdocvar{T} \coqdocvar{R'} \coqdocvar{T'}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos})); \coqdoctac{intro} \coqdocvar{Heq\_1};\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{rpo\_l} \coqdocvar{rpo\_infos})); \coqdoctac{intro} \coqdocvar{Heq\_2};\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t1}, \coqdocvar{t2}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})); \coqdoctac{intro} \coqdocvar{Heq\_3};\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{mem\_bool} \coqdocvar{eq\_tt\_bool} (\coqdocvar{t2}, \coqdocvar{t1}) (\coqdocvar{equiv\_l} \coqdocvar{rpo\_infos})); \coqdoctac{intro} \coqdocvar{Heq\_4}; \coqdoctac{intros} \coqdocvar{R} \coqdocvar{T} \coqdocvar{R'} \coqdocvar{T'}; \coqdoctac{try}\coqdoceol
\coqdocnoindent
(\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1});[\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial}\ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} \coqdocvar{t2};\coqdoctac{assumption}]). \coqdoctac{try} \coqdoctac{intuition}. \coqdoctac{try} \coqdoctac{intuition}. \coqdoctac{try} \coqdoctac{intuition}. \coqdoctac{try} \coqdoctac{intuition}.\coqdoceol
\coqdocnoindent
\coqdoctac{try} (\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
[\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial} \ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{R'}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}]).\coqdoceol
\coqdocnoindent
\coqdoctac{try} (\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
[\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial} \ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{R'}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}]).\coqdoceol
\coqdocnoindent
\coqdoctac{try} (\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
[\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial} \ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{R'}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}]).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{Heq\_1} \coqdocvar{Heq\_2} \coqdocvar{Heq\_3} \coqdocvar{Heq\_4}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t1} \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ];\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} (\coqdocvar{S} \coqdocvar{n}) \coqdocvar{t2} \coqdocvar{t1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ];\coqdoceol
\coqdocnoindent
\coqdoctac{try} (\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1}); [\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial} \ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{R}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}]). \coqdoctac{try}  \coqdoctac{intuition}. \coqdoctac{try} (\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
[\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial}\ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{R'}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}]). \coqdoctac{try} (\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
[\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial}\ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{R'}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}]). \coqdocvar{Focus} 2. \coqdoctac{try} \coqdoctac{intuition}; \coqdoctac{try} (\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
[\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial}\ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{R'}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}]). \coqdocvar{Focus} 2. \coqdoctac{try} \coqdoctac{intuition}; \coqdoctac{try} (\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
[\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial}\ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{R'}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}]). \coqdocvar{Focus} 2. \coqdoctac{try}  \coqdoctac{intuition}; \coqdoctac{try} (\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
[\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial}\ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{R'}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}]). \coqdocvar{Focus} 2. \coqdoctac{try}  \coqdoctac{intuition}; \coqdoctac{try} (\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
[\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial}\ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{R'}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}]). \coqdoctac{try} (\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t1});\coqdoceol
\coqdocnoindent
[\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1}); \coqdoctac{trivial}\ensuremath{|}\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{R'}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}]).\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{TE} \coqdocvar{TE'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{t1} \coqdockw{as} [\coqdocvar{v1} \ensuremath{|} \coqdocvar{f1} \coqdocvar{l1}]; \coqdoctac{destruct} \coqdocvar{t2} \coqdockw{as} [\coqdocvar{v2} \ensuremath{|} \coqdocvar{f2} \coqdocvar{l2}].\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t1\_lt\_t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{var\_case2} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{t1\_lt\_t2}); \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t1\_lt\_t2}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Sl} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1\_in\_l1} \coqdocvar{t2\_in\_l2}; \coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2})) \coqdockw{with} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1}) + \coqdocvar{size} \coqdocvar{t2}); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm}; \coqdoctac{apply} \coqdocvar{plus\_le\_compat}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{lt\_le\_weak}; \coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IHl1l2} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\land}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t2} \coqdocvar{t1} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHn}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Sl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IHl2l1} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t2} \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t2} \coqdocvar{t1} = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\land}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHn}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm}; \coqdoctac{apply} \coqdocvar{Sl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IHl1s2} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\land}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdocvar{t1} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHn}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}))) \coqdockw{with} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm}; \coqdoctac{apply} \coqdocvar{plus\_le\_compat\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IHs2l1} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdocvar{t1} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdocvar{t1} = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\land}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHn}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm}; \coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}))) \coqdockw{with} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t1}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm}; \coqdoctac{apply} \coqdocvar{plus\_le\_compat\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IHs1l2} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\land}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t2} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHn}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t2} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}))) \coqdockw{with} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t2}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1})); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IHl2s1} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t2} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t2} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\land}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHn}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t2} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}))) \coqdockw{with} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{t2}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1})); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{t1\_lt\_t2} \coqdockw{as}\coqdoceol
\coqdocnoindent
[ \coqdocvar{f2'} \coqdocvar{l2'} \coqdocvar{u1} \coqdocvar{s2} \coqdocvar{s2\_in\_l2} \coqdocvar{u1\_le\_s2}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{f2'} \coqdocvar{f1'} \coqdocvar{l2'} \coqdocvar{l1'} \coqdocvar{f1\_lt\_f2} \coqdocvar{H}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l2'} \coqdocvar{l1'} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f\_eq\_g} \coqdocvar{L} \coqdocvar{l1\_lt\_l2} \coqdocvar{H}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{f} \coqdocvar{g} \coqdocvar{l2'} \coqdocvar{l1'} \coqdocvar{Sf} \coqdocvar{Sg} \coqdocvar{f\_eq\_g} \coqdocvar{l1\_lt\_l2}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{5.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdockw{with}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{6.00em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R}; \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_closure} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})) \coqdockw{as} [\coqdocvar{\_} [\coqdocvar{Antisym} \coqdocvar{\_}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{Antisym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{t1\_lt\_l2} : \coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{5.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{5.50em}
\coqdockw{end}) \coqdocvar{l2} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_exists\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{s2\_in\_l2}) \coqdockw{as} [\coqdocvar{s2'} [\coqdocvar{l2'} [\coqdocvar{l2'{}'} [\coqdocvar{s2\_eq\_s2'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{s2\_eq\_s2'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{s2'\_in\_l2} : \coqdocvar{In} \coqdocvar{s2'} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l2}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{s2'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_3}  \coqdocvar{\_} \coqdocvar{s2\_eq\_s2'}) \coqdoctac{in} \coqdocvar{u1\_le\_s2}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{u1\_le\_s2}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{rpo\_eval\_is\_complete\_equivalent} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{s2'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{s2'} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}))) \coqdockw{with} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{s2'}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1})); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IHs1l2} \coqdocvar{s2'} \coqdocvar{s2'\_in\_l2} \coqdocvar{H0}) \coqdockw{as} [\coqdocvar{H1} \coqdocvar{\_}]; \coqdoctac{rewrite} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{t1\_lt\_l2}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{l2\_gt\_t1} : \coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{6.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdockw{with}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{6.50em}
\coqdockw{end}) \coqdocvar{l2} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_exists\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{s2\_in\_l2}) \coqdockw{as} [\coqdocvar{s2'} [\coqdocvar{l2'} [\coqdocvar{l2'{}'} [\coqdocvar{s2\_eq\_s2'} [\coqdocvar{H} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{s2\_eq\_s2'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{s2'\_in\_l2} : \coqdocvar{In} \coqdocvar{s2'} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{l2}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{s2'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{u1\_le\_s2}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (@\coqdocvar{rpo\_eval\_is\_complete\_equivalent} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s2'} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{le\_S\_n}; \coqdoctac{refine} (\coqdocvar{le\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{replace} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{s2'} + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}))) \coqdockw{with} (\coqdocvar{S} (\coqdocvar{size} \coqdocvar{s2'}) + \coqdocvar{size} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1})); \coqdoctac{trivial};\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{plus\_le\_compat\_r}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_direct\_subterm}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{transitivity} \coqdocvar{s2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{s2\_eq\_s2'}) \coqdoctac{in} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IHs1l2} \coqdocvar{s2'} \coqdocvar{s2'\_in\_l2} \coqdocvar{H0}) \coqdockw{as} [\coqdocvar{\_} \coqdocvar{H2}]; \coqdoctac{rewrite} \coqdocvar{H2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{l2\_gt\_t1}; \coqdoctac{simpl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; [\coqdoctac{clear} \coqdocvar{R'} \coqdocvar{T'} \ensuremath{|} \coqdoctac{clear} \coqdocvar{R} \coqdocvar{T}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{5.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdockw{with}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{6.00em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_closure} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})) \coqdockw{as} [\coqdocvar{\_} [\coqdocvar{Antisym} \coqdocvar{\_}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{Antisym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{7.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{8.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{8.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{8.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{8.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{8.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{8.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{8.00em}
\coqdockw{end}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{prec\_eval\_is\_sound} \coqdocvar{f1} \coqdocvar{f2}); \coqdoctac{destruct} (\coqdocvar{prec\_eval} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro}. \coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f2}); \coqdoctac{trivial}. \coqdoctac{assert} (\coqdocvar{H5}: \coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H5}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{assert} (\coqdocvar{H'} : \coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}) \coqdocvar{l1} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_forall\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u1\_in\_l1}; \coqdoctac{destruct} (\coqdocvar{IHl1s2} \coqdocvar{u1} \coqdocvar{u1\_in\_l1}) \coqdockw{as} [\coqdocvar{H1} \coqdocvar{\_}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{f2\_lt\_f1}; \coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f1}); \coqdoctac{apply} \coqdocvar{prec\_transitive} \coqdockw{with} \coqdocvar{f2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{\_} [\coqdocvar{not\_f1\_lt\_f2} \coqdocvar{\_}]]; \coqdocvar{absurd} (\coqdocvar{prec} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{6.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdockw{with}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{6.50em}
\coqdockw{end}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{4.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_closure} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) (\coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2})) \coqdockw{as} [\coqdocvar{\_} [\coqdocvar{Antisym} \coqdocvar{\_}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{Antisym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{prec\_eval\_is\_sound} \coqdocvar{f2} \coqdocvar{f1}); \coqdoctac{destruct} (\coqdocvar{prec\_eval} \coqdocvar{f2} \coqdocvar{f1}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f1}); \coqdoctac{trivial}. \coqdoctac{assert} (\coqdocvar{H5}: \coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H5}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{f2\_lt\_f1}; \coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f1}); \coqdoctac{apply} \coqdocvar{prec\_transitive} \coqdockw{with} \coqdocvar{f2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{assert} (\coqdocvar{H'} : \coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}) \coqdocvar{l1} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_forall\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u1\_in\_l1}; \coqdoctac{destruct} (\coqdocvar{IHl1s2} \coqdocvar{u1} \coqdocvar{u1\_in\_l1}) \coqdockw{as} [\coqdocvar{\_} \coqdocvar{H2}].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{\_} [\coqdocvar{\_} \coqdocvar{not\_f1\_lt\_f2}]]; \coqdocvar{absurd} (\coqdocvar{prec} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; [\coqdoctac{clear} \coqdocvar{R'} \coqdocvar{T'} \ensuremath{|} \coqdoctac{clear} \coqdocvar{R} \coqdocvar{T}].\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{beq\_nat} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{length} \coqdocvar{l2})\coqdoceol
\coqdocindent{2.00em}
|| \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \&\& \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l2}) (\coqdocvar{bb} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{L}; \coqdoctac{intros} \coqdocvar{L}; \coqdoctac{rewrite} \coqdocvar{L} \coqdoctac{in} \coqdocvar{R}, \coqdocvar{T}; \coqdoctac{clear} \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdoctac{set} (\coqdocvar{s1} := \coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdoctac{in} *; \coqdocvar{clearbody} \coqdocvar{s1}.\coqdoceol
\coqdocnoindent
\coqdoctac{set} (\coqdocvar{s2} := \coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdoctac{in} *; \coqdocvar{clearbody} \coqdocvar{s2}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{2.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s2} \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_closure} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{s2}) \coqdockw{as} [\coqdocvar{\_} [\coqdocvar{Antisym} \coqdocvar{\_}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{Antisym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{4.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s1} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{generalize} (\coqdocvar{prec\_eval\_is\_sound} \coqdocvar{f1} \coqdocvar{f2}); \coqdoctac{destruct} (\coqdocvar{prec\_eval} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{rewrite} \coqdocvar{Sf}; \coqdoctac{rewrite} \coqdocvar{Sf} \coqdoctac{in} \coqdocvar{R}; \coqdoctac{rewrite} \coqdocvar{Sf} \coqdoctac{in} \coqdocvar{T}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{t1\_lt\_t2} \coqdocvar{H} \coqdocvar{St} \coqdocvar{IHl1l2} \coqdocvar{IHl2l1} \coqdocvar{IHl1s2} \coqdocvar{IHs2l1} \coqdocvar{IHs1l2} \coqdocvar{IHl2s1} \coqdocvar{R} \coqdocvar{T} \coqdocvar{l1\_lt\_l2} \coqdocvar{Sl}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear}; \coqdocvar{revert} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l2}; \coqdoctac{induction} \coqdocvar{l1} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros} \coqdocvar{s1} \coqdocvar{s2} [ \ensuremath{|} \coqdocvar{t2} \coqdocvar{l2}]; \coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_lt\_l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_lt\_l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_lt\_l2}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} (\coqdocvar{proj1} (\coqdocvar{IHl1l2} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})) (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})) \coqdocvar{H1})).\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{term\_gt\_list}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'} : \coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s2} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}) (\coqdocvar{t1} :: \coqdocvar{l1}) = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_forall\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u1\_in\_t1l1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1\_lt\_s2} : \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{u1} \coqdocvar{s2}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}; \coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{proj2} (\coqdocvar{IHl1s2} \coqdocvar{\_} \coqdocvar{u1\_in\_t1l1} \coqdocvar{u1\_lt\_s2})); \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'{}'}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := @\coqdocvar{rpo\_eval\_is\_complete\_equivalent} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{H'} (\coqdocvar{Sl} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})) \coqdoceol
\coqdocindent{12.00em}
(\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))) \coqdocvar{H3});\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H'}; \coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{rewrite} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHl1l2}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHl2l1}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHl1s2}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHs2l1}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHs1l2}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHl2s1}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R}; \coqdoctac{rewrite} \coqdocvar{H'} \coqdoctac{in} \coqdocvar{R}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T}; \coqdoctac{rewrite} \coqdocvar{H'} \coqdoctac{in} \coqdocvar{T}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Sl}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}. \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}. \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{f2} \coqdocvar{f1}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{f2\_diff\_f2} \coqdocvar{\_}]; \coqdocvar{absurd} (\coqdocvar{f2} = \coqdocvar{f2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T}; \coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T}; \coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{f2\_diff\_f2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T}; \coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T}; \coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{L} \coqdockw{as} [\coqdocvar{L} \ensuremath{|} [\coqdocvar{L1} \coqdocvar{L2}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{L}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{beq\_nat\_refl}; \coqdoctac{intro}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{leb\_correct} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L1}); \coqdoctac{rewrite} (\coqdocvar{leb\_correct} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L2}); \coqdoctac{rewrite} \coqdocvar{orb\_true\_r}; \coqdoctac{intro}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{beq\_nat} (\coqdocvar{length} \coqdocvar{l2}) (\coqdocvar{length} \coqdocvar{l1})\coqdoceol
\coqdocindent{2.00em}
|| \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l2}) (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \&\& \coqdocvar{leb} (\coqdocvar{length} \coqdocvar{l1}) (\coqdocvar{bb} \coqdocvar{rpo\_infos})).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{L}; \coqdoctac{intros} \coqdocvar{L}; \coqdoctac{rewrite} \coqdocvar{L} \coqdoctac{in} \coqdocvar{R'}, \coqdocvar{T'}; \coqdoctac{clear} \coqdocvar{L}.\coqdoceol
\coqdocnoindent
\coqdoctac{set} (\coqdocvar{s1} := \coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdoctac{in} *; \coqdocvar{clearbody} \coqdocvar{s1}.\coqdoceol
\coqdocnoindent
\coqdoctac{set} (\coqdocvar{s2} := \coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdoctac{in} *; \coqdocvar{clearbody} \coqdocvar{s2}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{2.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s1} \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{4.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s2} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_closure} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s2} \coqdocvar{s1} \coqdocvar{s2}) \coqdockw{as} [\coqdocvar{\_} [\coqdocvar{Antisym} \coqdocvar{\_}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{Antisym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{generalize} (\coqdocvar{prec\_eval\_is\_sound} \coqdocvar{f2} \coqdocvar{f1}); \coqdoctac{destruct} (\coqdocvar{prec\_eval} \coqdocvar{f2} \coqdocvar{f1}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{rewrite} \coqdocvar{Sg}; \coqdoctac{rewrite} \coqdocvar{Sg} \coqdoctac{in} \coqdocvar{R'}; \coqdoctac{rewrite} \coqdocvar{Sg} \coqdoctac{in} \coqdocvar{T'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T'}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{t1\_lt\_t2} \coqdocvar{H} \coqdocvar{St} \coqdocvar{IHl1l2} \coqdocvar{IHl2l1} \coqdocvar{IHl1s2} \coqdocvar{IHs2l1} \coqdocvar{IHs1l2} \coqdocvar{IHl2s1} \coqdocvar{R'} \coqdocvar{T'} \coqdocvar{l1\_lt\_l2} \coqdocvar{Sl}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear}; \coqdocvar{revert} \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{l1}; \coqdoctac{induction} \coqdocvar{l2} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t2} \coqdocvar{l2}]; \coqdoctac{intros} \coqdocvar{s1} \coqdocvar{s2} [ \ensuremath{|} \coqdocvar{t1} \coqdocvar{l1}]; \coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_lt\_l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_lt\_l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_lt\_l2}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} (\coqdocvar{proj2} (\coqdocvar{IHl1l2} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})) (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})) \coqdocvar{H1})).\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{term\_gt\_list}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Hnew} : \coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s2} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}) (\coqdocvar{t1} :: \coqdocvar{l1}) = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_forall\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u1\_in\_t1l1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1\_lt\_s2} : \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{u1} \coqdocvar{s2}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}; \coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{proj2} (\coqdocvar{IHl1s2} \coqdocvar{\_} \coqdocvar{u1\_in\_t1l1} \coqdocvar{u1\_lt\_s2})); \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Hnew}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := @\coqdocvar{rpo\_eval\_is\_complete\_equivalent} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t2} \coqdocvar{t1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm} \coqdoctac{in} \coqdocvar{H'}; \coqdoctac{generalize} (\coqdocvar{H'} (\coqdocvar{Sl} \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_})) \coqdoceol
\coqdocindent{12.00em}
(\coqdocvar{or\_introl} \coqdocvar{\_} (\coqdocvar{refl\_equal} \coqdocvar{\_}))) (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{H3}));\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H'}; \coqdoctac{intro} \coqdocvar{H'}; \coqdoctac{rewrite} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHl1l2}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHl2l1}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHl1s2}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHs2l1}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHs1l2}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IHl2s1}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R'}; \coqdoctac{rewrite} \coqdocvar{H'} \coqdoctac{in} \coqdocvar{R'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T'}; \coqdoctac{rewrite} \coqdocvar{H'} \coqdoctac{in} \coqdocvar{T'}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Sl}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}. \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{f2} \coqdocvar{f1}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}. \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{f2\_diff\_f2} \coqdocvar{\_}]; \coqdocvar{absurd} (\coqdocvar{f2} = \coqdocvar{f2}); \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{f2\_diff\_f2}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T'}; \coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T'}; \coqdocvar{absurd} (@\coqdocvar{None} \coqdocvar{comp} = \coqdocvar{None}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{L} \coqdockw{as} [\coqdocvar{L} \ensuremath{|} [\coqdocvar{L1} \coqdocvar{L2}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{L}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{beq\_nat\_refl}; \coqdoctac{intro}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{leb\_correct} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L1}); \coqdoctac{rewrite} (\coqdocvar{leb\_correct} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{L2}); \coqdoctac{rewrite} \coqdocvar{orb\_true\_r}; \coqdoctac{intro}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{set} (\coqdocvar{s1} := \coqdocvar{Term} \coqdocvar{f1} \coqdocvar{l1}) \coqdoctac{in} *.\coqdoceol
\coqdocnoindent
\coqdoctac{set} (\coqdocvar{s2} := \coqdocvar{Term} \coqdocvar{f2} \coqdocvar{l2}) \coqdoctac{in} *.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; [\coqdoctac{clear} \coqdocvar{R'} \coqdocvar{T'} \ensuremath{|} \coqdoctac{clear} \coqdocvar{R} \coqdocvar{T}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{2.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{rpo\_eval}  \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s2} \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R};  \coqdoctac{destruct} (\coqdocvar{rpo\_closure} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{s2}) \coqdockw{as} [\coqdocvar{\_} [\coqdocvar{Antisym} \coqdocvar{\_}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{Antisym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{4.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s1} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{generalize} (\coqdocvar{prec\_eval\_is\_sound} \coqdocvar{f1} \coqdocvar{f2}); \coqdoctac{destruct} (\coqdocvar{prec\_eval} \coqdocvar{f1} \coqdocvar{f2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{rewrite} \coqdocvar{Sf}; \coqdoctac{rewrite} \coqdocvar{Sf} \coqdoctac{in} \coqdocvar{R}; \coqdoctac{rewrite} \coqdocvar{Sf} \coqdoctac{in} \coqdocvar{T}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{remove\_equiv\_eval\_list\_is\_sound} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{l1'} \coqdocvar{l2'}] \coqdocvar{H}; \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{R}, \coqdocvar{T}, \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'} : \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{l1'} \coqdocvar{l2'}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [\coqdocvar{Ell} [\coqdocvar{P1} [\coqdocvar{P2} \coqdocvar{\_}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Ell'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{Ell} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{t1t2\_in\_ll}); \coqdoctac{intro} \coqdocvar{t1\_eq\_t2}; \coqdoctac{apply} \coqdocvar{t1\_eq\_t2}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{Ell'} \coqdocvar{l1\_lt\_l2} \coqdocvar{P1} \coqdocvar{P2}; \coqdoctac{clear}; \coqdocvar{revert} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l1'} \coqdocvar{l2'}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{t1} \coqdocvar{t2}] \coqdocvar{ll}];\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{Ell} \coqdocvar{l1\_lt\_l2} \coqdocvar{P1} \coqdocvar{P2}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end} \coqdoctac{in} \coqdocvar{P1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end} \coqdoctac{in} \coqdocvar{P2}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_lt\_l2}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{\_} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{l1}; [\coqdoctac{symmetry}; \coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} \coqdocvar{eq} \ensuremath{|} \coqdoctac{idtac}]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a'} \coqdocvar{b} \coqdocvar{a\_eq\_b}; \coqdoctac{subst} \coqdocvar{a'}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{l2}; [\coqdoctac{symmetry}; \coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} \coqdocvar{eq} \ensuremath{|} \coqdoctac{idtac}]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a'} \coqdocvar{b} \coqdocvar{a\_eq\_b}; \coqdoctac{subst} \coqdocvar{a'}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{rpo\_mul\_remove\_equiv\_aux} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{\_}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ell}; \coqdoctac{left}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll} \coqdockw{with} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Ell}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{list\_permut.permut\_trans} \coqdocvar{\_} \coqdocvar{P1} \coqdocvar{\_}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_permut.permut\_sym}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Pcons}; [\coqdoctac{trivial} \ensuremath{|} \coqdoctac{apply} \coqdocvar{list\_permut.permut\_refl}; \coqdoctac{intros}; \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{list\_permut.permut\_trans} \coqdocvar{\_} \coqdocvar{P2} \coqdocvar{\_}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_permut.permut\_sym}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Pcons}; [\coqdoctac{trivial} \ensuremath{|} \coqdoctac{apply} \coqdocvar{list\_permut.permut\_refl}; \coqdoctac{intros}; \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l1'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1'} \coqdocvar{l1'}]; \coqdoctac{destruct} \coqdocvar{l2'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t2'} \coqdocvar{l2'}].\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s1} \coqdocvar{s1}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s1}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{R}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s1} \coqdocvar{s1}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s1}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} \coqdocvar{s2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{mult\_eval}, \coqdocvar{list\_gt\_list}; \coqdoctac{unfold} \coqdocvar{mult\_eval}, \coqdocvar{list\_gt\_list} \coqdoctac{in} \coqdocvar{R},\coqdocvar{T}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{5.00em}
(\coqdockw{fun} \coqdocvar{t2} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{6.50em}
(\coqdockw{fun} \coqdocvar{t1} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{7.00em}
\coqdockw{end}) (\coqdocvar{t1'} :: \coqdocvar{l1'})) (\coqdocvar{t2'} :: \coqdocvar{l2'})) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s1} \coqdocvar{s1}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s1}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} \coqdocvar{s2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{K} : \coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{t1} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{t2} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t2} \coqdocvar{t1} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) (\coqdocvar{t2'} :: \coqdocvar{l2'})) (\coqdocvar{t1'} :: \coqdocvar{l1'}) = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_forall\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u1\_in\_l1'}; \coqdoctac{apply} \coqdocvar{list\_exists\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'{}'}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1\_in\_l1} : \coqdocvar{In} \coqdocvar{u1} \coqdocvar{l1}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [ \coqdocvar{\_} [\coqdocvar{P1} \coqdocvar{\_}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P1}); \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1\_mem\_ls\_lc} : \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{u1} (\coqdocvar{ls} ++ \coqdocvar{lc})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{u1} \coqdocvar{H0}); \coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{u1\_mem\_ls\_lc}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{u1\_mem\_ls\_lc} \coqdockw{as} [\coqdocvar{u1\_mem\_ls} \ensuremath{|} \coqdocvar{u1\_mem\_lc}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H2} \coqdocvar{\_} \coqdocvar{u1\_mem\_ls}) \coqdockw{as} [\coqdocvar{a'} [\coqdocvar{a'\_in\_lg} \coqdocvar{u1\_lt\_a'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{a'\_in\_tl2'} : \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a'} (\coqdocvar{t2'} :: \coqdocvar{l2'})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{a'} \coqdocvar{H1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{mem\_in\_eq} \coqdoctac{in} \coqdocvar{a'\_in\_tl2'}; \coqdoctac{destruct} \coqdocvar{a'\_in\_tl2'} \coqdockw{as} [\coqdocvar{a'{}'} [\coqdocvar{a'{}'\_eq\_a'} \coqdocvar{a'{}'\_in\_tl2'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'{}'}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1\_lt\_a'{}'} : \coqdocvar{rpo} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{u1} \coqdocvar{a'{}'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a'{}'\_eq\_a'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{a'{}'\_in\_l2} : \coqdocvar{In} \coqdocvar{a'{}'} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [ \coqdocvar{\_} [\coqdocvar{\_} [\coqdocvar{P2} \coqdocvar{\_}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P2}); \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{proj2} (\coqdocvar{IHl1l2} \coqdocvar{u1} \coqdocvar{a'{}'} \coqdocvar{u1\_in\_l1} \coqdocvar{a'{}'\_in\_l2} \coqdocvar{u1\_lt\_a'{}'})); \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1\_mem\_tl2'} : \coqdoctac{\ensuremath{\exists}} \coqdocvar{u2}, \coqdocvar{equiv} \coqdocvar{u1} \coqdocvar{u2} \ensuremath{\land} \coqdocvar{In} \coqdocvar{u2} (\coqdocvar{t2'} :: \coqdocvar{l2'})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_in\_eq} \coqdocvar{equiv}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{u1} \coqdocvar{H1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{u1\_mem\_tl2'} \coqdockw{as} [\coqdocvar{u2} [\coqdocvar{u1\_eq\_u2} \coqdocvar{u2\_in\_tl2'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [ \coqdocvar{\_} [\coqdocvar{\_} [\coqdocvar{P2} \coqdocvar{H'}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{K} := \coqdocvar{H'} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{u1\_in\_l1'} \coqdocvar{u2\_in\_tl2'}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Su} : \coqdocvar{size} \coqdocvar{u1} + \coqdocvar{size} \coqdocvar{u2} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Sl}; [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P2}); \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}]; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{generalize} (@\coqdocvar{equiv\_eval\_is\_sound} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u1} \coqdocvar{u2} \coqdocvar{Su}); \coqdoctac{rewrite} \coqdocvar{K}; \coqdoctac{intro} \coqdocvar{E}; \coqdoctac{apply} \coqdocvar{E}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{K}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{T}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H}; \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{T}; \coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{T}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f2}); \coqdoctac{trivial}. \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f1}); \coqdoctac{trivial}. \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{f2} \coqdocvar{f1}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{f2\_diff\_f2} \coqdocvar{\_}]; \coqdocvar{absurd} (\coqdocvar{f2} = \coqdocvar{f2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{f2\_diff\_f2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{T}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{T}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{2.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdockw{match} \coqdocvar{rpo\_eval}  \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s1} \coqdockw{with}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{3.00em}
\coqdockw{end}) \coqdocvar{l2}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{4.50em}
(\coqdockw{fun} \coqdocvar{t} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s2} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{l1}) \coqdockw{as} [ [ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R'}; \coqdoctac{destruct} (\coqdocvar{rpo\_closure} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s1} \coqdocvar{s2} \coqdocvar{s2}) \coqdockw{as} [\coqdocvar{\_} [\coqdocvar{Antisym} \coqdocvar{\_}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{Antisym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{generalize} (\coqdocvar{prec\_eval\_is\_sound} \coqdocvar{f2} \coqdocvar{f1}); \coqdoctac{destruct} (\coqdocvar{prec\_eval} \coqdocvar{f2} \coqdocvar{f1}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_}; \coqdoctac{rewrite} \coqdocvar{Sg}; \coqdoctac{rewrite} \coqdocvar{Sg} \coqdoctac{in} \coqdocvar{R'}; \coqdoctac{rewrite} \coqdocvar{Sg} \coqdoctac{in} \coqdocvar{T'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{R'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{T'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{remove\_equiv\_eval\_list\_is\_sound} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l2} \coqdocvar{l1}).\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l2} \coqdocvar{l1}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{l2'} \coqdocvar{l1'}] \coqdocvar{H}; \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{R'}, \coqdocvar{T'}, \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'} : \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{l1'} \coqdocvar{l2'}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [\coqdocvar{Ell} [\coqdocvar{P2} [\coqdocvar{P1} \coqdocvar{\_}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Ell'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{Ell} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{t1t2\_in\_ll}); \coqdoctac{intro} \coqdocvar{t1\_eq\_t2}; \coqdoctac{apply} \coqdocvar{t1\_eq\_t2}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdocvar{revert} \coqdocvar{Ell'} \coqdocvar{l1\_lt\_l2} \coqdocvar{P1} \coqdocvar{P2}; \coqdoctac{clear}; \coqdocvar{revert} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l1'} \coqdocvar{l2'}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{t2} \coqdocvar{t1}] \coqdocvar{ll}];\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{Ell} \coqdocvar{l1\_lt\_l2} \coqdocvar{P1} \coqdocvar{P2}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end} \coqdoctac{in} \coqdocvar{P1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end} \coqdoctac{in} \coqdocvar{P2}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{l1\_lt\_l2}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{\_} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{l1}; [\coqdoctac{symmetry}; \coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} \coqdocvar{eq} \ensuremath{|} \coqdoctac{idtac}]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a'} \coqdocvar{b} \coqdocvar{a\_eq\_b}; \coqdoctac{subst} \coqdocvar{a'}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{l2}; [\coqdoctac{symmetry}; \coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} \coqdocvar{eq} \ensuremath{|} \coqdoctac{idtac}]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a'} \coqdocvar{b} \coqdocvar{a\_eq\_b}; \coqdoctac{subst} \coqdocvar{a'}; \coqdoctac{apply} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{rpo\_mul\_remove\_equiv\_aux} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{l1'} \coqdocvar{l2'} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{\_}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{apply} \coqdocvar{Ell}; \coqdoctac{left}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll} \coqdockw{with} \coqdocvar{l1} \coqdocvar{l2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{Ell}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{list\_permut.permut\_trans} \coqdocvar{\_} \coqdocvar{P1} \coqdocvar{\_}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_permut.permut\_sym}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Pcons}; [\coqdoctac{trivial} \ensuremath{|} \coqdoctac{apply} \coqdocvar{list\_permut.permut\_refl}; \coqdoctac{intros}; \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (\coqdocvar{list\_permut.permut\_trans} \coqdocvar{\_} \coqdocvar{P2} \coqdocvar{\_}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_permut.permut\_sym}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{apply} \coqdocvar{Pcons}; [\coqdoctac{trivial} \ensuremath{|} \coqdoctac{apply} \coqdocvar{list\_permut.permut\_refl}; \coqdoctac{intros}; \coqdoctac{trivial}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l1'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t1'} \coqdocvar{l1'}]; \coqdoctac{destruct} \coqdocvar{l2'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{t2'} \coqdocvar{l2'}].\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s2} \coqdocvar{s2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{R'}) \coqdoctac{in} \coqdocvar{t1\_lt\_t2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{absurd} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s2} \coqdocvar{s2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} (@\coqdocvar{rpo\_antirefl} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{s2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} \coqdocvar{s1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{mult\_eval}, \coqdocvar{list\_gt\_list}; \coqdoctac{unfold} \coqdocvar{mult\_eval}, \coqdocvar{list\_gt\_list} \coqdoctac{in} \coqdocvar{R'}, \coqdocvar{T'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{K} : \coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{5.00em}
(\coqdockw{fun} \coqdocvar{t2} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{6.50em}
(\coqdockw{fun} \coqdocvar{t1} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{7.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{7.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None} (\coqdocvar{A}:=\coqdocvar{bool})\coqdoceol
\coqdocindent{7.00em}
\coqdockw{end}) (\coqdocvar{t2'} :: \coqdocvar{l2'})) (\coqdocvar{t1'} :: \coqdocvar{l1'}) = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_forall\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u1\_in\_l1'}; \coqdoctac{apply} \coqdocvar{list\_exists\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H'{}'}; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1\_in\_l1} : \coqdocvar{In} \coqdocvar{u1} \coqdocvar{l1}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [ \coqdocvar{\_} [\coqdocvar{\_} [\coqdocvar{P1} \coqdocvar{\_}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P1}); \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1\_mem\_ls\_lc} : \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{u1} (\coqdocvar{ls} ++ \coqdocvar{lc})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{u1} \coqdocvar{H0}); \coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{u1\_mem\_ls\_lc}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{u1\_mem\_ls\_lc} \coqdockw{as} [\coqdocvar{u1\_mem\_ls} \ensuremath{|} \coqdocvar{u1\_mem\_lc}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H2} \coqdocvar{\_} \coqdocvar{u1\_mem\_ls}) \coqdockw{as} [\coqdocvar{a'} [\coqdocvar{a'\_in\_lg} \coqdocvar{u1\_lt\_a'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{a'\_in\_tl2'} : \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a'} (\coqdocvar{t2'} :: \coqdocvar{l2'})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{a'} \coqdocvar{H1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{mem\_in\_eq} \coqdoctac{in} \coqdocvar{a'\_in\_tl2'}; \coqdoctac{destruct} \coqdocvar{a'\_in\_tl2'} \coqdockw{as} [\coqdocvar{a'{}'} [\coqdocvar{a'{}'\_eq\_a'} \coqdocvar{a'{}'\_in\_tl2'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'{}'}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1\_lt\_a'{}'} : \coqdocvar{rpo} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{u1} \coqdocvar{a'{}'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a'{}'\_eq\_a'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{a'{}'\_in\_l2} : \coqdocvar{In} \coqdocvar{a'{}'} \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [ \coqdocvar{\_} [\coqdocvar{P2} \coqdocvar{\_}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P2}); \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{proj2} (\coqdocvar{IHl1l2} \coqdocvar{u1} \coqdocvar{a'{}'} \coqdocvar{u1\_in\_l1} \coqdocvar{a'{}'\_in\_l2} \coqdocvar{u1\_lt\_a'{}'})); \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1\_mem\_tl2'} : \coqdoctac{\ensuremath{\exists}} \coqdocvar{u2}, \coqdocvar{equiv} \coqdocvar{u1} \coqdocvar{u2} \ensuremath{\land} \coqdocvar{In} \coqdocvar{u2} (\coqdocvar{t2'} :: \coqdocvar{l2'})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{mem\_in\_eq} \coqdocvar{equiv}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{u1} \coqdocvar{H1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{u1\_mem\_tl2'} \coqdockw{as} [\coqdocvar{u2} [\coqdocvar{u1\_eq\_u2} \coqdocvar{u2\_in\_tl2'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{ll} [ \coqdocvar{\_} [\coqdocvar{P2} [\coqdocvar{\_} \coqdocvar{H'}]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{K} := \coqdocvar{H'} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{u2\_in\_tl2'} \coqdocvar{u1\_in\_l1'}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Su} : \coqdocvar{size} \coqdocvar{u2} + \coqdocvar{size} \coqdocvar{u1} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm}; \coqdoctac{apply} \coqdocvar{Sl}; [\coqdoctac{idtac} \ensuremath{|} \coqdoctac{rewrite} (\coqdocvar{in\_permut\_in} \coqdocvar{P2}); \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{left}]; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{generalize} (@\coqdocvar{equiv\_eval\_is\_sound} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u2} \coqdocvar{u1} \coqdocvar{Su}); \coqdoctac{rewrite} \coqdocvar{K}; \coqdoctac{intro} \coqdocvar{E}; \coqdoctac{apply} \coqdocvar{E}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{K}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H}; \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{T'}; \coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{T'}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}. \coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{f2} \coqdocvar{f1}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro}; \coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} (\coqdocvar{prec\_antisym} \coqdocvar{Prec} \coqdocvar{f2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{False}). \coqdoctac{apply} \coqdocvar{prec\_not\_prec\_eq} \coqdockw{with} \coqdocvar{symbol} \coqdocvar{Prec} \coqdocvar{f1} \coqdocvar{f2}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{f2\_diff\_f2} \coqdocvar{\_}]; \coqdocvar{absurd} (\coqdocvar{f2} = \coqdocvar{f2}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{f2\_diff\_f2}. \coqdoctac{apply} \coqdocvar{prec\_eq\_sym}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{T'}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{False\_rec}; \coqdoctac{apply} \coqdocvar{T'}; \coqdoctac{apply} \coqdocvar{refl\_equal}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_eval\_is\_complete} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t2}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t2} \coqdocvar{t1}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \ensuremath{\lnot}\coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\land} \ensuremath{\lnot} \coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\land} \ensuremath{\lnot}\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t2} \coqdocvar{t1}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{rpo\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2})\coqdoceol
\coqdocnoindent
(@\coqdocvar{rpo\_eval\_is\_complete\_equivalent} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St})\coqdoceol
\coqdocnoindent
(@\coqdocvar{rpo\_eval\_is\_complete\_less\_greater} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St})\coqdoceol
\coqdocnoindent
(@\coqdocvar{rpo\_eval\_terminates} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{St});\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{plus\_comm} \coqdoctac{in} \coqdocvar{St};\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (@\coqdocvar{rpo\_eval\_is\_complete\_less\_greater} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t2} \coqdocvar{t1} \coqdocvar{St}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2}) \coqdockw{as} [ [ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{not\_t2\_lt\_t1} \coqdocvar{\_} \coqdocvar{t1\_diff\_t2} \coqdocvar{not\_t1\_lt\_t2} \coqdocvar{T}; \coqdoctac{repeat} \coqdoctac{split}; \coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{t1\_diff\_t2} \coqdocvar{H}); \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{not\_t1\_lt\_t2} \coqdocvar{H}); \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{not\_t2\_lt\_t1} \coqdocvar{H}); \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{empty\_rpo\_infos} (\coqdocvar{n} : \coqdocvar{nat}) : \coqdocvar{rpo\_inf}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{constructor} 1 \coqdockw{with} \coqdocvar{n} (@\coqdocvar{nil} (\coqdocvar{term}\ensuremath{\times}\coqdocvar{term})) (@\coqdocvar{nil} (\coqdocvar{term}\ensuremath{\times}\coqdocvar{term})) (@\coqdocvar{nil} (\coqdocvar{term}\ensuremath{\times}\coqdocvar{term}));\coqdoctac{simpl};\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{add\_equiv} (\coqdocvar{rpo\_infos}:\coqdocvar{rpo\_inf}) \coqdocvar{t1} \coqdocvar{t2} (\coqdocvar{H}:\coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}) : \coqdocvar{rpo\_inf}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{rpo\_infos}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{clear} \coqdocvar{rpo\_infos}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{bb0} \coqdocvar{rpo\_l0} \coqdocvar{rpo\_eq\_l0} \coqdocvar{equiv\_l0} \coqdocvar{rpo\_l\_valid0} \coqdocvar{rpo\_eq\_valid0} \coqdocvar{equiv\_l\_valid0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{constructor} 1 \coqdockw{with} \coqdocvar{bb0} \coqdocvar{rpo\_l0} \coqdocvar{rpo\_eq\_l0} ((\coqdocvar{t1},\coqdocvar{t2})::\coqdocvar{equiv\_l0}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{exact} \coqdocvar{rpo\_l\_valid0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{exact} \coqdocvar{rpo\_eq\_valid0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{H0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{case} \coqdocvar{H0};  \coqdoctac{intros} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{injection} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H2} \coqdocvar{H3}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H2};\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H3};\coqdoctac{exact} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{exact} (\coqdocvar{equiv\_l\_valid0} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{H1}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{rpo\_mult\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{l1} \coqdocvar{l2} :=\coqdoceol
\coqdocindent{16.00em}
\coqdockw{match} \coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow}  \coqdocvar{None}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{nil}, \coqdocvar{nil}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Equivalent}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{nil}, \coqdocvar{\_} :: \coqdocvar{\_}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{\_} :: \coqdocvar{\_},\coqdocvar{nil}) \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{16.00em}
\ensuremath{|} \coqdocvar{Some} (\coqdocvar{l}, \coqdocvar{l'}) \ensuremath{\Rightarrow} \coqdocvar{mult\_eval} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l} \coqdocvar{l'}\coqdoceol
\coqdocindent{16.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{rpo\_mul\_subst} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A} \coqdocvar{B}: (\coqdocvar{list} \coqdocvar{term}), \coqdockw{\ensuremath{\forall}} \coqdocvar{bb}:\coqdocvar{nat},  \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{A} \coqdocvar{B} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{sigma},  \coqdocvar{rpo\_mul} \coqdocvar{bb} (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{A}) (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{B}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdocnoindent
\coqdoctac{intros} \coqdocvar{l'} \coqdocvar{l} \coqdocvar{bb} \coqdocvar{Rmul} \coqdocvar{sigma}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{Rmul} \coqdockw{as} [ \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l0} \coqdocvar{k0} \coqdocvar{Pk} \coqdocvar{Pl} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{a}) (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{lg})\coqdoceol
\coqdocnoindent
(\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{ls}) (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{lc})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{map\_app}; \coqdoctac{apply} \coqdocvar{permut\_map} \coqdockw{with} \coqdocvar{equiv}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b'} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{b\_eq\_b'}; \coqdoctac{apply} \coqdocvar{equiv\_subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{map\_app}.\coqdoceol
\coqdocnoindent
\coqdoctac{refine} (@\coqdocvar{permut\_map} \coqdocvar{term} \coqdocvar{term} \coqdocvar{term} \coqdocvar{term} \coqdocvar{equiv} \coqdoceol
\coqdocindent{10.00em}
\coqdocvar{equiv} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{\_} \coqdocvar{\_} (\coqdocvar{a} :: \coqdocvar{lg} ++ \coqdocvar{lc}) \coqdocvar{\_} \coqdocvar{\_}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b'} \coqdocvar{b\_in\_l} \coqdocvar{\_} \coqdocvar{b\_eq\_b'}; \coqdoctac{apply} \coqdocvar{equiv\_subst}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b\_mem\_ls\_sigma}; \coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{b\_mem\_ls\_sigma}) \coqdockw{as} [\coqdocvar{b'} [\coqdocvar{ls1} [\coqdocvar{ls2} [\coqdocvar{b\_eq\_b'} [\coqdocvar{H} \coqdocvar{\_}]]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{b\_eq\_b'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{b'\_in\_ls\_sigma} : \coqdocvar{In} \coqdocvar{b'} (\coqdocvar{map} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) \coqdocvar{ls})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{in\_map\_iff} \coqdoctac{in} \coqdocvar{b'\_in\_ls\_sigma}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{b'\_in\_ls\_sigma} \coqdockw{as} [\coqdocvar{b'{}'} [\coqdocvar{b'{}'\_sigma\_eq\_b'} \coqdocvar{b'{}'\_in\_ls}]].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{b'{}'}) \coqdockw{as} [\coqdocvar{a'} [\coqdocvar{a'\_mem\_alg} \coqdocvar{b'{}'\_lt\_a'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{a'\_mem\_alg}) \coqdockw{as} [\coqdocvar{a'{}'} [\coqdocvar{alg'} [\coqdocvar{alg'{}'} [\coqdocvar{a'\_eq\_a'{}'} [\coqdocvar{H'} \coqdocvar{\_}]]]]];\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{a'\_eq\_a'{}'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{apply\_subst} \coqdocvar{sigma} \coqdocvar{a'{}'}); \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{in\_map\_iff} (\coqdocvar{apply\_subst} \coqdocvar{sigma}) (\coqdocvar{a} :: \coqdocvar{lg})).\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'{}'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{b\_eq\_b'}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IH}:= \coqdocvar{rpo\_subst}).\coqdoceol
\coqdocnoindent
\coqdoctac{subst} \coqdocvar{b'}; \coqdoctac{apply} (\coqdocvar{IH} \coqdocvar{bb} \coqdocvar{b'{}'} \coqdocvar{a'{}'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{a'\_eq\_a'{}'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_dec}: \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{k} \coqdocvar{l}, \{\coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{k} \coqdocvar{l}\}+\{\~{} \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{k} \coqdocvar{l}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{remove\_equiv\_list\_is\_sound} \coqdocvar{k} \coqdocvar{l}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{remove\_equiv\_list} \coqdocvar{k} \coqdocvar{l}) \coqdockw{as} [\coqdocvar{k'} \coqdocvar{l'}];\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{lc} [\coqdocvar{Pk} [\coqdocvar{Pl} \coqdocvar{D}]]].\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Rem} : \coqdocvar{rpo\_mul} \coqdocvar{bb0} \coqdocvar{k} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{bb0} \coqdocvar{k'} \coqdocvar{l'}).\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l} \coqdocvar{k} \coqdocvar{l'} \coqdocvar{k'} \coqdocvar{Pk} \coqdocvar{Pl}; \coqdoctac{clear} \coqdocvar{l} \coqdocvar{k} \coqdocvar{l'} \coqdocvar{k'} \coqdocvar{Pk} \coqdocvar{Pl} \coqdocvar{D}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{lc} \coqdockw{as} [ \ensuremath{|} \coqdocvar{c} \coqdocvar{lc}]; \coqdoctac{intros} \coqdocvar{l} \coqdocvar{k} \coqdocvar{l'} \coqdocvar{k'} \coqdocvar{Pk} \coqdocvar{Pl} \coqdocvar{k\_lt\_l}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{k\_lt\_l} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Rk} \coqdocvar{Rl} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb0} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{k}; \coqdoctac{trivial}; \coqdoctac{symmetry}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end} \coqdoctac{in} \coqdocvar{Pk}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} \coqdocvar{l}; \coqdoctac{trivial}; \coqdoctac{symmetry}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end} \coqdoctac{in} \coqdocvar{Pl}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} := \coqdocvar{IHlc} \coqdocvar{l} \coqdocvar{k} (\coqdocvar{l'} ++ \coqdocvar{c} :: \coqdocvar{nil}) (\coqdocvar{k'} ++ \coqdocvar{c} :: \coqdocvar{nil})).\coqdoceol
\coqdocnoindent
\coqdoctac{do} 2 \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ass\_app} \coqdoctac{in} \coqdocvar{H}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{H} \coqdocvar{Pk} \coqdocvar{Pl} \coqdocvar{k\_lt\_l}); \coqdoctac{clear} \coqdocvar{H}; \coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{rpo\_mul\_remove\_equiv\_aux} \coqdocvar{bb0} \coqdocvar{k'} \coqdocvar{l'} \coqdocvar{c} \coqdocvar{c}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{\_}; \coqdoctac{apply} \coqdocvar{rpo\_antirefl}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Rk} \coqdocvar{Rl} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb0} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc'}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{Rk}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside};[|\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{reflexivity}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{Rl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside};[|\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{reflexivity}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end}; \coqdoctac{reflexivity} || \coqdoctac{auto}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{let} \coqdocvar{P} := \coqdockw{constr}:(\coqdockw{\ensuremath{\forall}} \coqdocvar{u}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{u} \coqdocvar{k'} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{v},  \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{v} \coqdocvar{l'} \ensuremath{\land} \coqdocvar{rpo} \coqdocvar{bb0} \coqdocvar{u} \coqdocvar{v}) \coqdoctac{in}\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} : \{\coqdocvar{P}\} + \{\~{} \coqdocvar{P}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IH'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{u} \coqdocvar{v}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{u} \coqdocvar{k'} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{v} \coqdocvar{l'} \ensuremath{\rightarrow} \{\coqdocvar{rpo} \coqdocvar{bb0} \coqdocvar{u} \coqdocvar{v}\}+\{\~{}\coqdocvar{rpo} \coqdocvar{bb0} \coqdocvar{u} \coqdocvar{v}\}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{v} \coqdocvar{u\_mem\_k'} \coqdocvar{v\_mem\_l'}. \coqdoctac{apply} \coqdocvar{rpo\_dec}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{l'} \coqdocvar{IH'}; \coqdoctac{clear} \coqdocvar{l} \coqdocvar{k}  \coqdocvar{l'} \coqdocvar{lc} \coqdocvar{Pk} \coqdocvar{Pl} \coqdocvar{D} \coqdocvar{IH'} \coqdocvar{Rem}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{k'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{u'} \coqdocvar{k'}]; \coqdoctac{intros} \coqdocvar{l'} \coqdocvar{IH'}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{let} \coqdocvar{P}:=\coqdockw{constr}:(\coqdockw{\ensuremath{\forall}} \coqdocvar{v}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{v} \coqdocvar{l'} \ensuremath{\rightarrow} \ensuremath{\lnot}\coqdocvar{rpo} \coqdocvar{bb0} \coqdocvar{u'} \coqdocvar{v}) \coqdoctac{in}\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H} : \{\coqdocvar{v} \ensuremath{|} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{v} \coqdocvar{l'} \ensuremath{\land} \coqdocvar{rpo} \coqdocvar{bb0} \coqdocvar{u'} \coqdocvar{v}\}+\{\coqdocvar{P}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{IH'{}'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{v}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{v} \coqdocvar{l'} \ensuremath{\rightarrow} \{\coqdocvar{rpo} \coqdocvar{bb0} \coqdocvar{u'} \coqdocvar{v}\}+\{\~{}\coqdocvar{rpo} \coqdocvar{bb0} \coqdocvar{u'} \coqdocvar{v}\}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v} \coqdocvar{v\_mem\_l'}; \coqdoctac{apply} (\coqdocvar{IH'} \coqdocvar{u'} \coqdocvar{v}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{IHk'} \coqdocvar{IH'}; \coqdoctac{induction} \coqdocvar{l'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{v'} \coqdocvar{l'}].\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{IHl'} \coqdockw{as} [\coqdocvar{Ok} \ensuremath{|} \coqdocvar{Ko}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{IH'{}'}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{Ok} \coqdockw{as} [\coqdocvar{v} [\coqdocvar{v\_mem\_l'} \coqdocvar{u'\_lt\_v}]]; \coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{v}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IH'{}'} \coqdocvar{v'}) \coqdockw{as} [\coqdocvar{Ok'} \ensuremath{|} \coqdocvar{Ko'}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{\ensuremath{\exists}} \coqdocvar{v'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intros} \coqdocvar{v} [\coqdocvar{v'\_eq\_v} \ensuremath{|} \coqdocvar{v\_mem\_l'}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u'\_lt\_v}; \coqdoctac{apply} \coqdocvar{Ko'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{v'\_eq\_v}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ko}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [[\coqdocvar{v} [\coqdocvar{v\_mem\_l'} \coqdocvar{u'\_lt\_v}]] \ensuremath{|} \coqdocvar{Ko}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{IHk'} \coqdocvar{l'}) \coqdockw{as} [\coqdocvar{Ok'} \ensuremath{|} \coqdocvar{Ko'}].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{v'} \coqdocvar{u\_mem\_k'} \coqdocvar{v'\_mem\_l'}; \coqdoctac{apply} \coqdocvar{IH'}; \coqdoctac{trivial}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{intros} \coqdocvar{u} [\coqdocvar{u'\_eq\_u} \ensuremath{|} \coqdocvar{u\_mem\_k'}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{v}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u'\_eq\_u}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Ok'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{H}; \coqdoctac{apply} \coqdocvar{Ko'}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u} \coqdocvar{u\_mem\_k'}; \coqdoctac{apply} \coqdocvar{H}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H} \coqdocvar{u'}) \coqdockw{as} [\coqdocvar{v} [\coqdocvar{v\_mem\_l'} \coqdocvar{u'\_lt\_v}]].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Ko} \coqdocvar{v}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l'} \coqdockw{as} [ \ensuremath{|} \coqdocvar{v'} \coqdocvar{l'}].\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{intro} \coqdocvar{fk\_lt\_fl}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{rpo\_mul} \coqdocvar{bb0} \coqdocvar{k'} []).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Rem}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H1}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{Ok} \ensuremath{|} \coqdocvar{Ko}].\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb0} \coqdocvar{v'} \coqdocvar{l'} \coqdocvar{k'} \coqdocvar{lc}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}. \coqdoctac{intro}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{Ko}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{rpo\_mul} \coqdocvar{bb0} \coqdocvar{k'} (\coqdocvar{v'} :: \coqdocvar{l'})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Rem}. \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H0} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc'} \coqdocvar{k'{}'} \coqdocvar{l'{}'} \coqdocvar{Rk} \coqdocvar{Rl} \coqdocvar{ls\_lt\_alg}]; \coqdoctac{subst}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{u}. \coqdoctac{rewrite} \coqdocvar{Rk}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{u\_mem\_ls} \ensuremath{|} \coqdocvar{u\_mem\_lc'}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{\_} \coqdocvar{u\_mem\_ls}) \coqdockw{as} [\coqdocvar{a'} [\coqdocvar{a'\_mem\_alg} \coqdocvar{u\_lt\_a'}]];\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Rl}; \coqdoctac{rewrite} \coqdocvar{app\_comm\_cons};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} \coqdocvar{False}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{D} \coqdocvar{u} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Rk}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Rl}; \coqdoctac{rewrite} \coqdocvar{app\_comm\_cons};\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{rpo\_mul\_rest\_dec}: \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{k} \coqdocvar{l},  \coqdocvar{well\_founded} (\coqdocvar{prec} \coqdocvar{Prec}) \ensuremath{\rightarrow} \{\coqdocvar{rpo\_mul\_rest} \coqdocvar{bb} \coqdocvar{k} \coqdocvar{l}\}+\{\~{} \coqdocvar{rpo\_mul\_rest} \coqdocvar{bb} \coqdocvar{k} \coqdocvar{l}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= @\coqdocvar{rpo\_mul\_dec} \coqdocvar{bb0} \coqdocvar{k} \coqdocvar{l}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:=\coqdocvar{wf\_rpo}). \coqdoctac{assert} (\coqdocvar{well\_founded} (\coqdocvar{rpo} \coqdocvar{bb0})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H3}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}. \coqdoctac{apply} \coqdocvar{Rpo\_mul\_rest}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{H0}. \coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{H0}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}. \coqdoctac{intro}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{n}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H1}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{permut0\_eq\_equiv}: \coqdockw{\ensuremath{\forall}} \coqdocvar{A} \coqdocvar{B}, \coqdocvar{permut0} \coqdocvar{eq} \coqdocvar{A} \coqdocvar{B} \ensuremath{\rightarrow} \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{A} \coqdocvar{B}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{A0} \coqdocvar{B} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:=\coqdocvar{permut\_impl}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{H'} \coqdocvar{term} \coqdocvar{term} \coqdocvar{eq} \coqdocvar{equiv} \coqdocvar{A0} \coqdocvar{B}); \coqdoctac{clear} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a} \coqdocvar{b} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}).\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_eval\_lists}: \coqdockw{\ensuremath{\forall}} \coqdocvar{A} \coqdocvar{ll} \coqdocvar{n} \coqdocvar{rpo\_infos}, \coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1}, \coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{true}) \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{3.00em}
\coqdocvar{permut0} \coqdocvar{equiv} (\coqdocvar{A} ++ \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll}) (\coqdocvar{A} ++ \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{ll}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{rpo\_infos} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{permut\_refl}. \coqdoctac{intros} \coqdocvar{a} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= \coqdocvar{IHll} \coqdocvar{n} \coqdocvar{rpo\_infos}); \coqdoctac{clear} \coqdocvar{IHll}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:  \coqdocvar{permut0} \coqdocvar{equiv} (\coqdocvar{H} ++ \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll})\coqdoceol
\coqdocindent{4.50em}
(\coqdocvar{H} ++ \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}. \coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H0'}:= \coqdocvar{H0} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H0'}. \coqdoctac{simpl}. \coqdoctac{right}; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H0'}:= \coqdocvar{H0} (\coqdocvar{fst} \coqdocvar{a}) (\coqdocvar{snd} \coqdocvar{a})); \coqdoctac{clear} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{fst} \coqdocvar{a}) (\coqdocvar{snd} \coqdocvar{a}) = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H0'}. \coqdoctac{simpl}; \coqdoctac{left}. \coqdoctac{destruct} \coqdocvar{a}. \coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_strong}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{equiv\_eval\_is\_sound\_weak}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{H1'} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{fst} \coqdocvar{a}) (\coqdocvar{snd} \coqdocvar{a})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H2}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Omega}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{equiv\_rpo\_eval}: \coqdockw{\ensuremath{\forall}}  \coqdocvar{n} \coqdocvar{rpo\_infos} \coqdocvar{t} \coqdocvar{s} \coqdocvar{u}, \coqdocvar{size} \coqdocvar{t} + \coqdocvar{size} \coqdocvar{u} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t} + \coqdocvar{size} \coqdocvar{s} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{u} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u} = \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{rpo\_infos} \coqdocvar{t} \coqdocvar{s} \coqdocvar{u} \coqdocvar{tu} \coqdocvar{ts} \coqdocvar{H}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{equiv\_rpo\_equiv\_1}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{rpo\_eval\_is\_complete\_less\_greater}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{rpo\_eval\_is\_complete}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H2} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'{}'}:= \coqdocvar{H2} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s}); \coqdoctac{clear} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3'{}'}:= \coqdocvar{H3} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s}); \coqdoctac{clear} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H31}: \coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{s}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{rpo} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{t} \coqdocvar{s}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{rpo} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{s} \coqdocvar{t}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{\lnot} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{s} \ensuremath{\land}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{\lnot} \coqdocvar{rpo} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{t} \coqdocvar{s} \ensuremath{\land} \ensuremath{\lnot} \coqdocvar{rpo} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{s} \coqdocvar{t}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H3'{}'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H32}: \coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{u}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{rpo} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{t} \coqdocvar{u}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{rpo} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{u} \coqdocvar{t}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{\lnot} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{u} \ensuremath{\land}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{\lnot} \coqdocvar{rpo} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{t} \coqdocvar{u} \ensuremath{\land} \ensuremath{\lnot} \coqdocvar{rpo} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{u} \coqdocvar{t}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H3'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H3'{}'} \coqdocvar{H3'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u}) \coqdockw{as} [[ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s}) \coqdockw{as} [[ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= (\coqdocvar{Relation\_Definitions.equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})  \coqdocvar{t} \coqdocvar{u} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}: \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}: \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s} \coqdocvar{t} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{rpo\_eval\_is\_complete\_equivalent}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4'}: \coqdocvar{size} \coqdocvar{s} + \coqdocvar{size} \coqdocvar{t} \ensuremath{\le}\coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s} \coqdocvar{t} = \coqdocvar{Some} \coqdocvar{Equivalent}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H3'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5'}:= (\coqdocvar{Relation\_Definitions.equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdocvar{t} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5}: \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{t}). \coqdoctac{apply} \coqdocvar{H5'}; \coqdoctac{assumption}. \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= (\coqdocvar{Relation\_Definitions.equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})  \coqdocvar{t} \coqdocvar{u} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}: \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H2'} \coqdocvar{H2'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s} \coqdocvar{t} = \coqdocvar{Some} \coqdocvar{Less\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{rpo\_eval\_is\_complete\_less\_greater}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6}:= \coqdocvar{H3} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s} \coqdocvar{t}). \coqdoctac{apply} \coqdocvar{H6}. \coqdoctac{omega}. \coqdoctac{assumption}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{rpo\_eval\_is\_complete\_equivalent}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5'}:= (\coqdocvar{Relation\_Definitions.equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdocvar{t} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6}: \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{t}). \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4'}: \coqdocvar{size} \coqdocvar{s} + \coqdocvar{size} \coqdocvar{t} \ensuremath{\le}\coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H4} \coqdoctac{in} \coqdocvar{H3'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Some} \coqdocvar{Less\_than} = \coqdocvar{Some} \coqdocvar{Equivalent}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H2'} \coqdocvar{H2'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H31}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= (\coqdocvar{Relation\_Definitions.equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})  \coqdocvar{t} \coqdocvar{u} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{H31}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s}) \coqdockw{as} [[ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5'}:= (\coqdocvar{Relation\_Definitions.equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdocvar{u} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5'{}'}: \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= (\coqdocvar{Relation\_Definitions.equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})  \coqdocvar{t} \coqdocvar{s} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}: \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}: \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u} \coqdocvar{t} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{rpo\_eval\_is\_complete\_equivalent}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4'}: \coqdocvar{size} \coqdocvar{u} + \coqdocvar{size} \coqdocvar{t} \ensuremath{\le}\coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u} \coqdocvar{t} = \coqdocvar{Some} \coqdocvar{Equivalent}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H3'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6'}:= (\coqdocvar{Relation\_Definitions.equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdocvar{t} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5}: \coqdocvar{equiv} \coqdocvar{u} \coqdocvar{t}). \coqdoctac{apply} \coqdocvar{H6'}; \coqdoctac{assumption}. \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{rewrite}  (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{H}) \coqdoctac{in} \coqdocvar{H32}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{rpo\_eval\_is\_complete\_less\_greater}); \coqdoctac{clear} \coqdocvar{H2'} \coqdocvar{H2'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H2} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'{}'}:= \coqdocvar{H2} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{s} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4'}: \coqdocvar{size} \coqdocvar{s} + \coqdocvar{size} \coqdocvar{t} \ensuremath{\le}\coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5}: \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Less\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5'}: \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H5'}; \coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H31} \coqdockw{as} (\coqdocvar{H41}, (\coqdocvar{H42}, \coqdocvar{H43})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{H}) \coqdoctac{in} \coqdocvar{H32}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s}) \coqdockw{as} [[ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5'}:= (\coqdocvar{Relation\_Definitions.equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}) \coqdocvar{t} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5'{}'}: \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= (\coqdocvar{Relation\_Definitions.equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})  \coqdocvar{u} \coqdocvar{s} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}: \coqdocvar{equiv} \coqdocvar{u} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{rpo\_eval\_is\_complete\_equivalent}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4'}: \coqdocvar{size} \coqdocvar{u} + \coqdocvar{size} \coqdocvar{t} \ensuremath{\le}\coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4}: \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u} \coqdocvar{t} = \coqdocvar{Some} \coqdocvar{Equivalent}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{rpo\_eval\_is\_complete\_less\_greater}); \coqdoctac{clear} \coqdocvar{H2'} \coqdocvar{H2'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H2} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u} \coqdocvar{t} = \coqdocvar{Some} \coqdocvar{Less\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{H}) \coqdoctac{in} \coqdocvar{H31}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{rpo\_eval\_is\_complete\_less\_greater}); \coqdoctac{clear} \coqdocvar{H2'} \coqdocvar{H2'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H2} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'{}'}:= \coqdocvar{H2} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{u} \coqdocvar{t}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4'}: \coqdocvar{size} \coqdocvar{u} + \coqdocvar{size} \coqdocvar{t} \ensuremath{\le}\coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5}: \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u} = \coqdocvar{Some} \coqdocvar{Less\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5'}: \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{u} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H5'}; \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H31} \coqdockw{as} (\coqdocvar{H41}, (\coqdocvar{H42}, \coqdocvar{H43})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\rightarrow} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{H}) \coqdoctac{in} \coqdocvar{H32}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s}) \coqdockw{as} [[ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H32} \coqdockw{as} (\coqdocvar{H41}, (\coqdocvar{H42}, \coqdocvar{H43})).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5'}:= (\coqdocvar{Relation\_Definitions.equiv\_sym} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})  \coqdocvar{u} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5'{}'}: \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= (\coqdocvar{Relation\_Definitions.equiv\_trans} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})  \coqdocvar{t} \coqdocvar{s} \coqdocvar{u}).\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H32} \coqdockw{as} (\coqdocvar{H41}, (\coqdocvar{H42}, \coqdocvar{H43})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_1} \coqdocvar{\_} \coqdocvar{H}) \coqdoctac{in} \coqdocvar{H31}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H32} \coqdockw{as} (\coqdocvar{H41}, (\coqdocvar{H42}, \coqdocvar{H43})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{H}) \coqdoctac{in} \coqdocvar{H31}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t} \coqdocvar{s}) \coqdockw{as} [[ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_is\_sound\_mem\_equiv} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{lg} \coqdocvar{ls}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'} :\coqdocvar{term}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t'} \coqdocvar{lg} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t} + \coqdocvar{size} \coqdocvar{t'} \ensuremath{\le} \coqdocvar{n}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{match} \coqdocvar{list\_gt\_list} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{lg} \coqdocvar{ls} \coqdockw{with}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{g}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{g} \coqdocvar{lg} \ensuremath{\land}  \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{1.50em}
\ensuremath{|} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'} : \coqdocvar{term},\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t'} \coqdocvar{lg} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t'} + \coqdocvar{size} \coqdocvar{t} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H0'}:= \coqdocvar{H0} \coqdocvar{t} \coqdocvar{t'}). \coqdoctac{assert} (\coqdocvar{size} \coqdocvar{t} + \coqdocvar{size} \coqdocvar{t'} \ensuremath{\le} \coqdocvar{n}). \coqdoctac{tauto}. \coqdoctac{omega}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{ls} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{ls}].\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdockw{match} \coqdocvar{list\_gt\_list} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{lg} \coqdocvar{ls} \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{s} : \coqdocvar{term},\coqdoceol
\coqdocindent{6.50em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{ls} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{6.50em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{g} : \coqdocvar{term},\coqdoceol
\coqdocindent{7.50em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{g} \coqdocvar{lg} \ensuremath{\land} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Greater\_than}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHls}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{H'}. \coqdoctac{apply} \coqdocvar{H0}. \coqdoctac{simpl}. \coqdoctac{tauto}. \coqdoctac{clear} \coqdocvar{IHls}. \coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}. \coqdoctac{simpl}. \coqdoctac{right}. \coqdoctac{trivial}. \coqdoctac{simpl}. \coqdoctac{trivial}. \coqdoctac{clear} \coqdocvar{IHls}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_exists\_option\_is\_sound}\coqdoceol
\coqdocindent{1.00em}
( \coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) \coqdocvar{lg}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct}\coqdoceol
\coqdocnoindent
(\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}) \coqdocvar{lg}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{g} [\coqdocvar{g\_in\_ls} \coqdocvar{H'}]].\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{H1}. \coqdoctac{unfold} \coqdocvar{list\_gt\_list}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} ( \coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{s0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{5.00em}
(\coqdockw{fun} \coqdocvar{g0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g0} \coqdocvar{s0} \coqdockw{with}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{end}) \coqdocvar{lg}) \coqdocvar{ls}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H0'} \coqdocvar{u} [\coqdocvar{s\_eq\_u} \ensuremath{|} \coqdocvar{u\_in\_ls}].\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{g}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_mem}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{in\_mem} \coqdocvar{g} \coqdocvar{lg}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}: \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{g} \coqdocvar{lg}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{equiv\_rpo\_eval}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{H3'} \coqdocvar{n} \coqdocvar{rpo\_infos} \coqdocvar{g} \coqdocvar{s} \coqdocvar{u}); \coqdoctac{clear} \coqdocvar{H3'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4'}:= \coqdocvar{H0'} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5}: \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{u} = \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6}:= \coqdocvar{equiv\_same\_size}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6'}:= \coqdocvar{H6} \coqdocvar{u} \coqdocvar{s}); \coqdoctac{clear} \coqdocvar{H6}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{size} \coqdocvar{u} = \coqdocvar{size} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H3}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}. \coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}). \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{s}) \coqdockw{as} [[ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{intros}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}. \coqdoctac{trivial}. \coqdoctac{discriminate}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H10'}:= \coqdocvar{H0'} \coqdocvar{u}); \coqdoctac{clear} \coqdocvar{H0'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H0'}: \coqdoctac{\ensuremath{\exists}} \coqdocvar{g} : \coqdocvar{term},\coqdoceol
\coqdocindent{5.50em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{g} \coqdocvar{lg} \ensuremath{\land} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{u} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H10'}. \coqdoctac{trivial}. \coqdoctac{trivial}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{\_};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct}\coqdoceol
\coqdocnoindent
(\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{s0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{g0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g0} \coqdocvar{s0} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) \coqdocvar{lg}) \coqdocvar{ls}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_eval\_is\_sound\_weak\_equiv} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{l1} \coqdocvar{l2}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'} :\coqdocvar{term}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t'} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t} + \coqdocvar{size} \coqdocvar{t'} \ensuremath{\le} \coqdocvar{n}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.50em}
\coqdockw{match} \coqdocvar{mult\_eval} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n})  \coqdocvar{l1} \coqdocvar{l2} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow}  \coqdoceol
\coqdocindent{3.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t1}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{t2},  \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\land} (\coqdocvar{size} \coqdocvar{t2} + \coqdocvar{size} \coqdocvar{t1} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t2} \coqdocvar{t1} = \coqdocvar{Some} \coqdocvar{Greater\_than})\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow}  \coqdoceol
\coqdocindent{3.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\land} (\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Greater\_than})\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{H}; \coqdoctac{unfold} \coqdocvar{mult\_eval}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'} : \coqdocvar{term},\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t'} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t} + \coqdocvar{size} \coqdocvar{t'} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{t'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t'} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t'} + \coqdocvar{size} \coqdocvar{t} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H1'} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{size} \coqdocvar{t'} + \coqdocvar{size} \coqdocvar{t} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_gt\_list\_is\_sound\_mem\_equiv} \coqdocvar{rpo\_infos} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{H0}). \coqdoctac{destruct} (\coqdocvar{list\_gt\_list} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l1} \coqdocvar{l2}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ]. \coqdoctac{trivial}. \coqdoctac{intros} \coqdocvar{H'} \coqdocvar{t2} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H'} \coqdocvar{t2}); \coqdoctac{clear} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}: \coqdoctac{\ensuremath{\exists}} \coqdocvar{g} : \coqdocvar{term},\coqdoceol
\coqdocindent{5.00em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{g} \coqdocvar{l1} \ensuremath{\land} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}: \coqdocvar{size} \coqdocvar{x} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{H2}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}. \coqdoctac{apply} \coqdocvar{H2}. \coqdoctac{intro}; \coqdoctac{apply} \coqdocvar{H2}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_gt\_list\_is\_sound\_mem\_equiv} \coqdocvar{rpo\_infos} \coqdocvar{l2} \coqdocvar{l1} \coqdocvar{H}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{list\_gt\_list} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{l2} \coqdocvar{l1}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocindent{0.50em}
\coqdoctac{intros} \coqdocvar{H'} \coqdocvar{t2} \coqdocvar{H1'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H'} \coqdocvar{t2}); \coqdoctac{clear} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}: \coqdoctac{\ensuremath{\exists}} \coqdocvar{g} : \coqdocvar{term},\coqdoceol
\coqdocindent{5.00em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{g} \coqdocvar{l2} \ensuremath{\land} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}: \coqdocvar{size} \coqdocvar{x} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H0}. \coqdoctac{apply} \coqdocvar{H2}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}. \coqdoctac{apply} \coqdocvar{H2}. \coqdoctac{intro}; \coqdoctac{apply} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{permut0\_mem} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A} \coqdocvar{X} \coqdocvar{L} \coqdocvar{b}, \coqdocvar{permut0} \coqdocvar{eq} \coqdocvar{A} (\coqdocvar{X} ++ \coqdocvar{L}) \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} \coqdocvar{X} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} \coqdocvar{A}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{permut\_impl}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{term} \coqdocvar{term} \coqdocvar{eq} \coqdocvar{equiv} \coqdocvar{A} (\coqdocvar{X} ++ \coqdocvar{L})); \coqdoctac{clear} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{A} (\coqdocvar{X}++\coqdocvar{L})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1'}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{a} \coqdocvar{b0} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2}. \coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}).\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:=\coqdocvar{mem\_permut0\_mem}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H2} \coqdocvar{term} \coqdocvar{equiv}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} (\coqdocvar{l1} \coqdocvar{l2} : \coqdocvar{list} \coqdocvar{term}) (\coqdocvar{a} : \coqdocvar{term}),\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow} (\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a} \coqdocvar{l1} \ensuremath{\leftrightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a} \coqdocvar{l2})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H2'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H3} \coqdocvar{A} (\coqdocvar{X} ++ \coqdocvar{L}) \coqdocvar{b}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} \coqdocvar{A} \ensuremath{\leftrightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{b} (\coqdocvar{X} ++ \coqdocvar{L})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H3'}. \coqdoctac{assumption}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H4}; \coqdoctac{clear} \coqdocvar{H} \coqdocvar{H1} \coqdocvar{H1'} \coqdocvar{H2} \coqdocvar{H3} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} \coqdocvar{H0}. \coqdoctac{generalize} \coqdocvar{X}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{X0}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}. \coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{H1}. \coqdoctac{left}; \coqdoctac{trivial}. \coqdoctac{right}. \coqdoctac{apply} \coqdocvar{IHX0}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{rpo\_mult\_eval\_rpo\_mul\_less}: \coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{A} \coqdocvar{B}, \coqdocvar{rpo\_mult\_eval} \coqdocvar{rpo\_infos} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{A} \coqdocvar{B} =  \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{A} \coqdocvar{B}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{A0} \coqdocvar{B} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{rpo\_mult\_eval} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{rpo\_infos}.(\coqdocvar{bb})) \coqdocvar{A0} \coqdocvar{B}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} (\coqdocvar{l1},\coqdocvar{l2}) \coqdocvar{Hrem}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Hrem} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} \coqdocvar{l1}; \coqdocvar{case\_eq} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{Hl2} \coqdocvar{Hl1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Hl2}, \coqdocvar{Hl1} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{l} \coqdocvar{Hl2} \coqdocvar{Hl1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Hl2}, \coqdocvar{Hl1} \coqdoctac{in} \coqdocvar{H}, \coqdocvar{Hrem}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Hequiv}:=\coqdocvar{remove\_equiv\_eval\_list\_is\_sound} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{rpo\_infos}.(\coqdocvar{bb})) \coqdocvar{A0} \coqdocvar{B}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Hrem} \coqdoctac{in} \coqdocvar{Hequiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{elim} \coqdocvar{Hequiv}; \coqdoctac{clear} \coqdocvar{Hequiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{ll} (\coqdocvar{H1},(\coqdocvar{H2},(\coqdocvar{H3},\coqdocvar{\_}))).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{\_} \coqdocvar{t} \coqdocvar{l} \coqdocvar{nil} \coqdocvar{A0}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} ((\coqdocvar{t} :: \coqdocvar{l}) ++ (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app1}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll}).\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{E\_ll'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}; \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{H1} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}) \coqdoctac{in} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H1} \coqdocvar{H2} \coqdocvar{H3}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{t1} \coqdocvar{t2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{right}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{Hl2} \coqdocvar{t} \coqdocvar{l} \coqdocvar{Hl1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Hl1}, \coqdocvar{Hl2} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate} \coqdocvar{H}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{l} \coqdocvar{Hl2} \coqdocvar{t'} \coqdocvar{l'} \coqdocvar{Hl1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Hl1}, \coqdocvar{Hl2} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Hequiv}:=\coqdocvar{remove\_equiv\_eval\_list\_is\_sound} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{rpo\_infos}.(\coqdocvar{bb})) \coqdocvar{A0} \coqdocvar{B}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Hrem} \coqdoctac{in} \coqdocvar{Hequiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{elim} \coqdocvar{Hequiv}; \coqdoctac{clear} \coqdocvar{Hequiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{ll} (\coqdocvar{H1},(\coqdocvar{H2},(\coqdocvar{H3},\coqdocvar{H4}))).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{E\_ll'} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{In} (\coqdocvar{t1},\coqdocvar{t2}) \coqdocvar{ll} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}; \coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'} := \coqdocvar{equiv\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{t1} \coqdocvar{t2});\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{H1} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{t1t2\_in\_ll}) \coqdoctac{in} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Hl1} \coqdoctac{in} \coqdocvar{H2},\coqdocvar{H4},\coqdocvar{Hrem}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Hl2} \coqdoctac{in} \coqdocvar{H3},\coqdocvar{H4},\coqdocvar{Hrem}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{Hl1} \coqdocvar{Hl2} \coqdocvar{l1} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{\_} \coqdocvar{t} \coqdocvar{l} (\coqdocvar{t'} :: \coqdocvar{l'}) (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll})); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{transitivity} ((\coqdocvar{t} :: \coqdocvar{l}) ++ \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut\_impl} \coqdockw{with} (@\coqdocvar{eq} \coqdocvar{term}); \coqdoctac{trivial}; \coqdoctac{intros}; \coqdoctac{subst}; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app1}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H2} \coqdocvar{H3}; \coqdoctac{induction} \coqdocvar{ll} \coqdockw{as} [ \ensuremath{|} [\coqdocvar{t1} \coqdocvar{t2}] \coqdocvar{ll}].\coqdoceol
\coqdocnoindent
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHll}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{H1}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}; \coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{right}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{symmetry}; \coqdoctac{apply} \coqdocvar{E\_ll'}; \coqdoctac{left}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{u1} \coqdocvar{u1\_mem\_l1'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{u1\_mem\_l1'}) \coqdockw{as} [\coqdocvar{u1'} [\coqdocvar{k1} [\coqdocvar{k1'} [\coqdocvar{u1\_eq\_u1'} [\coqdocvar{H'} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{u1\_eq\_u1'}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{u1'\_in\_l1'} : \coqdocvar{In} \coqdocvar{u1'} (\coqdocvar{t'} :: \coqdocvar{l'})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H'}; \coqdoctac{apply} \coqdocvar{in\_or\_app}; \coqdoctac{right}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'} := \coqdocvar{mult\_eval\_is\_sound\_weak} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{rpo\_infos}.(\coqdocvar{bb})) (\coqdocvar{t'} :: \coqdocvar{l'}) (\coqdocvar{t} :: \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{H'{}'} \coqdocvar{\_} \coqdocvar{u1'\_in\_l1'}) \coqdockw{as} [\coqdocvar{u2} [\coqdocvar{u2\_in\_l2'} \coqdocvar{u1\_lt\_u2}]];\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{u2}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{in\_impl\_mem}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{exact} \coqdocvar{Eq}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'{}'} := @\coqdocvar{rpo\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{u2} \coqdocvar{u1'}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{u1\_lt\_u2} \coqdoctac{in} \coqdocvar{H'{}'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_2} \coqdocvar{\_} \coqdocvar{u1\_eq\_u1'}); \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{Hrem}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Hrem} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{Hrem}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_trans} : \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{t} \coqdocvar{s}, \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{t} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{t} \coqdocvar{s} \ensuremath{\rightarrow}  \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{u} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0} \coqdockw{as} [\coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{P'} \coqdocvar{P} \coqdocvar{ls\_lt\_alg}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{a'} \coqdocvar{lg'} \coqdocvar{ls'} \coqdocvar{lc'} \coqdocvar{l'} \coqdocvar{l'{}'} \coqdocvar{Q'} \coqdocvar{Q} \coqdocvar{ls'\_lt\_alg'}].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P'} \coqdoctac{in} \coqdocvar{Q}; \coqdoctac{rewrite} \coqdocvar{app\_comm\_cons} \coqdoctac{in} \coqdocvar{Q}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (@\coqdocvar{ac\_syntactic} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{Q}) \coqdockw{as} [\coqdocvar{k1} [\coqdocvar{k2} [\coqdocvar{k3} [\coqdocvar{k4} [\coqdocvar{P1} [\coqdocvar{P2} [\coqdocvar{P3} \coqdocvar{P4}]]]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{bb0} \coqdocvar{a} (\coqdocvar{lg} ++ \coqdocvar{k2}) (\coqdocvar{ls'} ++ \coqdocvar{k3}) \coqdocvar{k1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{Q'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ass\_app}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{list\_permut0\_app\_app}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{P}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons};[|\coqdoctac{apply} \coqdocvar{equiv\_equiv}\ensuremath{|}\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv})].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ass\_app}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut\_app1}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{list\_permut0\_app\_app}; \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{b\_mem\_ls'\_k3}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{b\_mem\_ls'\_k3}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{b\_mem\_ls'\_k3} \coqdockw{as} [\coqdocvar{b\_mem\_ls'} \ensuremath{|} \coqdocvar{b\_mem\_k3}].\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls'\_lt\_alg'}  \coqdocvar{\_} \coqdocvar{b\_mem\_ls'}) \coqdockw{as} [\coqdocvar{a'{}'} [\coqdocvar{a'{}'\_in\_a'lg'} \coqdocvar{b\_lt\_a'{}'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{a'{}'} \coqdocvar{P4}) \coqdoctac{in} \coqdocvar{a'{}'\_in\_a'lg'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app} \coqdoctac{in} \coqdocvar{a'{}'\_in\_a'lg'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{a'{}'\_in\_a'lg'} \coqdockw{as} [\coqdocvar{a'{}'\_mem\_k2} \ensuremath{|} \coqdocvar{a'{}'\_mem\_k4}].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'{}'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{a'{}'}) \coqdockw{as} [\coqdocvar{a3} [\coqdocvar{a3\_in\_alg} \coqdocvar{a'{}'\_lt\_a3}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{a'{}'} \coqdocvar{P2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a3}; \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_trans} \coqdockw{with} (\coqdocvar{a'{}'}). \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{ls\_lt\_alg} \coqdocvar{b}) \coqdockw{as} [\coqdocvar{a'{}'} [\coqdocvar{a'{}'\_in\_alg} \coqdocvar{b\_lt\_a'{}'}]].\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{mem\_permut0\_mem} \coqdocvar{equiv\_equiv} \coqdocvar{b} \coqdocvar{P2}); \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'{}'}; \coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{app\_comm\_cons}; \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{mem\_or\_app}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{rpo\_mul\_rest\_trans}: \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l3}, \coqdocvar{well\_founded} (\coqdocvar{prec} \coqdocvar{Prec}) \ensuremath{\rightarrow} \coqdocvar{rpo\_mul\_rest} \coqdocvar{bb} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul\_rest} \coqdocvar{bb} \coqdocvar{l2} \coqdocvar{l3} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul\_rest} \coqdocvar{bb} \coqdocvar{l1} \coqdocvar{l3}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= @\coqdocvar{rpo\_mul\_trans} \coqdocvar{bb0} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l3}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:=\coqdocvar{wf\_rpo}). \coqdoctac{assert} (\coqdocvar{well\_founded} (\coqdocvar{rpo} \coqdocvar{bb0})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H3}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{Rpo\_mul\_rest}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{well\_founded} \coqdoctac{in} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{well\_founded} \coqdoctac{in} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_remove\_equiv\_aux1} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{l} \coqdocvar{l'} \coqdocvar{s} \coqdocvar{s'},  \coqdocvar{equiv} \coqdocvar{s} \coqdocvar{s'} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{bb} (\coqdocvar{s} :: \coqdocvar{l}) (\coqdocvar{s'} :: \coqdocvar{l'}) \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{bb} \coqdocvar{l} \coqdocvar{l'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_mul\_remove\_equiv\_aux} \coqdockw{with} \coqdocvar{s} \coqdocvar{s'}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_antirefl}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{rpo\_mul\_antirefl} : \coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{l}, \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{l} \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{False}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_mul\_remove\_equiv\_aux1} \coqdockw{with} \coqdocvar{a} \coqdocvar{a}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_refl}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{eq\_equiv}: \coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t2}, \coqdocvar{eq} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\rightarrow} \coqdocvar{equiv} \coqdocvar{t1} \coqdocvar{t2}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (\coqdocvar{Relation\_Definitions.equiv\_refl} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_equiv}); \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_dickson}: \coqdockw{\ensuremath{\forall}} \coqdocvar{bb} \coqdocvar{l} \coqdocvar{l'}, \coqdocvar{rpo\_mul\_rest} \coqdocvar{bb} \coqdocvar{l} \coqdocvar{l'} \ensuremath{\rightarrow} \coqdocvar{clos\_trans} (\coqdocvar{list} \coqdocvar{term}) (\coqdocvar{rpo\_mul\_step\_rest} \coqdocvar{bb}) \coqdocvar{l} \coqdocvar{l'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:=  (\coqdocvar{rpo\_mul\_rest\_trans\_clos})).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{H1} \coqdocvar{bb0}).\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{inclusion} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H2} \coqdocvar{l} \coqdocvar{l'}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} ( \coqdocvar{clos\_trans} (\coqdocvar{list} \coqdocvar{term}) (\coqdocvar{rpo\_mul\_step\_rest} \coqdocvar{bb0}) \coqdocvar{l} \coqdocvar{l'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H2'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mem\_in\_1}: \coqdockw{\ensuremath{\forall}} \coqdocvar{t}: \coqdocvar{term}, \coqdockw{\ensuremath{\forall}} \coqdocvar{A},  \coqdocvar{mem} \coqdocvar{eq} \coqdocvar{t} \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{t} \coqdocvar{A}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{A}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{mem} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{mem}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{In}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{In} \coqdocvar{t} \coqdocvar{A}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHA}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mem\_in\_2}: \coqdockw{\ensuremath{\forall}} \coqdocvar{t}: \coqdocvar{term}, \coqdockw{\ensuremath{\forall}} \coqdocvar{A},  \coqdocvar{In} \coqdocvar{t} \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{eq} \coqdocvar{t} \coqdocvar{A}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{t}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{A}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{In} \coqdoctac{in}  \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{In}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{mem}.\coqdoceol
\coqdocnoindent
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{mem} \coqdocvar{eq} \coqdocvar{t} \coqdocvar{A}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHA}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{rpo\_mult\_eval\_rpo\_mul\_greater}: \coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{A} \coqdocvar{B},  (\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{t'} :\coqdocvar{term}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t} \coqdocvar{B} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t'} \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t} + \coqdocvar{size} \coqdocvar{t'} \ensuremath{\le} \coqdocvar{n}) \ensuremath{\rightarrow}  \coqdocvar{rpo\_mult\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{A} \coqdocvar{B} =  \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{B} \coqdocvar{A}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{A0} \coqdocvar{B} \coqdocvar{H1} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{rpo\_mult\_eval} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= \coqdocvar{remove\_equiv\_eval\_list\_is\_sound}).\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{remove\_equiv\_eval\_list} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{A0} \coqdocvar{B}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l0}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{l0}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H'} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{A0} \coqdocvar{B}); \coqdoctac{clear} \coqdocvar{H'} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct}  \coqdocvar{H2'} \coqdockw{as} (\coqdocvar{l'}, (\coqdocvar{H01}, (\coqdocvar{H02}, (\coqdocvar{H03}, \coqdocvar{H4})))).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{\_} \coqdocvar{t} \coqdocvar{l} \coqdocvar{nil} (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{l'})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_eq\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} (\coqdocvar{t} :: \coqdocvar{l} ++ \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{l'}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_eq\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{equiv\_eval\_lists} (\coqdocvar{t}::\coqdocvar{l}) \coqdocvar{l'} \coqdocvar{n} \coqdocvar{rpo\_infos} \coqdocvar{H01}). \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{H'}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3'}:= \coqdocvar{H'} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{A0} \coqdocvar{B}); \coqdoctac{clear} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H3'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H3'} \coqdockw{as} (\coqdocvar{ll}, (\coqdocvar{H01}, (\coqdocvar{H02}, (\coqdocvar{H03}, \coqdocvar{H4})))).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} (@\coqdocvar{List\_mul} \coqdocvar{\_} \coqdocvar{t} \coqdocvar{l} (\coqdocvar{t0} :: \coqdocvar{l0}) ( \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_eq\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{equiv\_eval\_lists} (\coqdocvar{t}::\coqdocvar{l}) \coqdocvar{ll} \coqdocvar{n} \coqdocvar{rpo\_infos} \coqdocvar{H01}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} ((\coqdocvar{t} :: \coqdocvar{l}) ++ \coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_eq\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{mult\_eval\_is\_sound\_weak\_equiv}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'{}'}:= \coqdocvar{H1'} \coqdocvar{rpo\_infos} \coqdocvar{n} (\coqdocvar{t} :: \coqdocvar{l}) (\coqdocvar{t0} :: \coqdocvar{l0})); \coqdoctac{clear} \coqdocvar{H1'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6}: (\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t'} : \coqdocvar{term},\coqdoceol
\coqdocindent{5.00em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t'} (\coqdocvar{t} :: \coqdocvar{l}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t1} (\coqdocvar{t0} :: \coqdocvar{l0}) \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t'} \ensuremath{\le} \coqdocvar{n})).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t1} \coqdocvar{t2} \coqdocvar{H1'} \coqdocvar{H2}. \coqdoctac{clear} \coqdocvar{H1'{}'}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_mem} \coqdockw{with} (\coqdocvar{t0} :: \coqdocvar{l0}) (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{snd} \coqdocvar{st}) \coqdocvar{ll}).\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_mem} \coqdockw{with} (\coqdocvar{t} :: \coqdocvar{l}) (\coqdocvar{map} (\coqdockw{fun} \coqdocvar{st} : \coqdocvar{term} \ensuremath{\times} \coqdocvar{term} \ensuremath{\Rightarrow} \coqdocvar{fst} \coqdocvar{st}) \coqdocvar{ll}).\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}. \coqdoctac{assumption}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}: \coqdockw{match} \coqdocvar{mult\_eval} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) (\coqdocvar{t} :: \coqdocvar{l}) (\coqdocvar{t0} :: \coqdocvar{l0}) \coqdockw{with}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} : \coqdocvar{term},\coqdoceol
\coqdocindent{6.50em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t1} (\coqdocvar{t} :: \coqdocvar{l}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{6.50em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{t2} : \coqdocvar{term},\coqdoceol
\coqdocindent{7.50em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t2} (\coqdocvar{t0} :: \coqdocvar{l0}) \ensuremath{\land}\coqdoceol
\coqdocindent{7.50em}
(\coqdocvar{size} \coqdocvar{t2} + \coqdocvar{size} \coqdocvar{t1} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{8.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t2} \coqdocvar{t1} = \coqdocvar{Some} \coqdocvar{Greater\_than})\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} : \coqdocvar{term},\coqdoceol
\coqdocindent{6.50em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t2} (\coqdocvar{t0} :: \coqdocvar{l0}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{6.50em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{t1} : \coqdocvar{term},\coqdoceol
\coqdocindent{7.50em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t1} (\coqdocvar{t} :: \coqdocvar{l}) \ensuremath{\land}\coqdoceol
\coqdocindent{7.50em}
(\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{8.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{Greater\_than})\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{4.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{4.50em}
\coqdockw{end}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} \coqdocvar{t1} \coqdocvar{t'} : \coqdocvar{term},\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t'} (\coqdocvar{t} :: \coqdocvar{l}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t1} (\coqdocvar{t0} :: \coqdocvar{l0}) \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t'} + \coqdocvar{size} \coqdocvar{t1} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{t2} \coqdocvar{t'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t'} (\coqdocvar{t} :: \coqdocvar{l}) \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t2} (\coqdocvar{t0} :: \coqdocvar{l0}) \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{t'} + \coqdocvar{size} \coqdocvar{t2} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{H1'} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6'}:= \coqdocvar{H6} \coqdocvar{t'} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H0}: \coqdocvar{size} \coqdocvar{t2} + \coqdocvar{size} \coqdocvar{t'} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}. \coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{H0}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H1'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H1'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'{}'}:= \coqdocvar{H1'} \coqdocvar{b}); \coqdoctac{clear} \coqdocvar{H1'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} ( \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1} : \coqdocvar{term},\coqdoceol
\coqdocindent{5.50em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{t1} (\coqdocvar{t} :: \coqdocvar{l}) \ensuremath{\land}\coqdoceol
\coqdocindent{5.50em}
(\coqdocvar{size} \coqdocvar{t1} + \coqdocvar{size} \coqdocvar{b} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{t1} \coqdocvar{b} = \coqdocvar{Some} \coqdocvar{Greater\_than})).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1'{}'}; \coqdoctac{trivial}. \coqdoctac{clear} \coqdocvar{H1'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{x} \coqdocvar{b} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6'}:= \coqdocvar{H6} \coqdocvar{b} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{size} \coqdocvar{b} + \coqdocvar{size} \coqdocvar{x} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H6'}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6'{}'}:= \coqdocvar{rpo\_eval\_is\_complete}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6'}:= \coqdocvar{H6'{}'} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{x} \coqdocvar{b}); \coqdoctac{clear} \coqdocvar{H6'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H6'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H6'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6'{}'}:= \coqdocvar{H6} \coqdocvar{b} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{size} \coqdocvar{b} + \coqdocvar{size} \coqdocvar{x} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H6'{}'}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6'{}'}:= \coqdocvar{H6} \coqdocvar{b} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{size} \coqdocvar{b} + \coqdocvar{size} \coqdocvar{x} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H6'{}'}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intro}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'{}'}:= \coqdocvar{H'} (\coqdocvar{equiv\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n}) \coqdocvar{A0} \coqdocvar{B}); \coqdoctac{clear} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H'{}'} \coqdockw{as} (\coqdocvar{t1}, (\coqdocvar{t2}, (\coqdocvar{In\_t1\_A}, (\coqdocvar{In\_t2\_B}, \coqdocvar{H4})))).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:=  \coqdocvar{mult\_eval\_is\_sound\_weak\_equiv}).\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{permut0\_rpo\_mul\_antirefl}: \coqdockw{\ensuremath{\forall}} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{rpo\_infos}, \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{l1} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{False}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdocvar{double} \coqdoctac{induction} \coqdocvar{l1} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_mul\_antirefl} \coqdockw{with} \coqdocvar{rpo\_infos} []. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{app\_eq\_nil} \coqdoctac{in} \coqdocvar{H5}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H5}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate} \coqdocvar{H8}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} (\coqdocvar{a} : \coqdocvar{term}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{term}) (\coqdocvar{rpo\_infos} : \coqdocvar{rpo\_inf}),\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{permut0} \coqdocvar{equiv} (\coqdocvar{a} :: \coqdocvar{l}) \coqdocvar{l0} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) (\coqdocvar{a} :: \coqdocvar{l}) \coqdocvar{l0} \ensuremath{\rightarrow} \coqdocvar{False}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H0}; \coqdoctac{trivial}. \coqdoctac{clear} \coqdocvar{H0} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) (\coqdocvar{a1} :: \coqdocvar{l3}) (\coqdocvar{a1} :: \coqdocvar{l3})-> \coqdocvar{False}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_mul\_antirefl}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H8}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_mul} \coqdockw{with} \coqdocvar{a2} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} (\coqdocvar{a0}:: \coqdocvar{l0}). \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_permut0\_left}: \coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{l0} \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l0} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{l0} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{l1} \coqdocvar{l2}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_mul} \coqdockw{with} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} \coqdocvar{l0}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_sym}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_permut0\_right}:  \coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{l0} \coqdocvar{l1} \coqdocvar{l2}, \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l0} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos})  \coqdocvar{l2} \coqdocvar{l0} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{l2} \coqdocvar{l1}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_mul} \coqdockw{with} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} \coqdocvar{l0}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_sym}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_inclusion\_left} : \coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l3}, \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) (\coqdocvar{l1}++ \coqdocvar{l2}) (\coqdocvar{l1} ++ \coqdocvar{l3}) \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{l2} \coqdocvar{l3}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l1}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}. \coqdoctac{intros}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (((\coqdocvar{a}:: \coqdocvar{l1}) ++ \coqdocvar{l2}) = \coqdocvar{a} :: (\coqdocvar{l1} ++ \coqdocvar{l2})).\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (((\coqdocvar{a} :: \coqdocvar{l1}) ++ \coqdocvar{l3}) = \coqdocvar{a}:: (\coqdocvar{l1} ++ \coqdocvar{l3})).\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_mul\_remove\_equiv\_aux1} \coqdockw{with} \coqdocvar{a} \coqdocvar{a}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_refl}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_inclusion\_right} : \coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l3}, \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) (\coqdocvar{l2}++ \coqdocvar{l1}) (\coqdocvar{l3} ++ \coqdocvar{l1}) \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{l2} \coqdocvar{l3}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l1}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{app\_nil\_end} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) (\coqdocvar{a}:: (\coqdocvar{l2} ++ \coqdocvar{l1})) (\coqdocvar{a} :: (\coqdocvar{l3} ++ \coqdocvar{l1}))).\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_mul} \coqdockw{with} \coqdocvar{a0} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{permut0} \coqdocvar{equiv} (\coqdocvar{a} :: \coqdocvar{l2} ++ \coqdocvar{l1}) (\coqdocvar{l2} ++ \coqdocvar{a} :: \coqdocvar{l1})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_refl}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{apply} \coqdocvar{equiv\_refl}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} (\coqdocvar{l2} ++ \coqdocvar{a} :: \coqdocvar{l1}). \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{permut0} \coqdocvar{equiv} (\coqdocvar{a} :: \coqdocvar{l3} ++ \coqdocvar{l1}) (\coqdocvar{l3} ++ \coqdocvar{a} :: \coqdocvar{l1})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_cons\_inside}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_refl}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{apply} \coqdocvar{equiv\_refl}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} (\coqdocvar{l3} ++ \coqdocvar{a} :: \coqdocvar{l1}). \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_mul\_remove\_equiv\_aux1} \coqdockw{with} \coqdocvar{a} \coqdocvar{a}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{equiv\_refl}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_inclusion\_permut0\_left} : \coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{l0} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l3}, \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l0} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) (\coqdocvar{l0}++ \coqdocvar{l2}) (\coqdocvar{l1} ++ \coqdocvar{l3}) \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{l2} \coqdocvar{l3}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{permut0} \coqdocvar{equiv} (\coqdocvar{l1} ++ \coqdocvar{l2}) (\coqdocvar{ls} ++ \coqdocvar{lc})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} (\coqdocvar{l0} ++ \coqdocvar{l2}). \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_app2}. \coqdoctac{apply} \coqdocvar{permut0\_sym}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) (\coqdocvar{l1} ++ \coqdocvar{l2}) (\coqdocvar{l1} ++ \coqdocvar{l3})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_mul} \coqdockw{with} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc}. \coqdoctac{trivial}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_mul\_inclusion\_left} \coqdockw{with} \coqdocvar{l1}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{rpo\_mul\_inclusion\_permut0\_right} : \coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{l0} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{l3}, \coqdocvar{permut0} \coqdocvar{equiv} \coqdocvar{l0} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) (\coqdocvar{l2}++ \coqdocvar{l0}) (\coqdocvar{l3} ++ \coqdocvar{l1}) \ensuremath{\rightarrow} \coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) \coqdocvar{l2} \coqdocvar{l3}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{inversion} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{permut0} \coqdocvar{equiv} (\coqdocvar{l2} ++ \coqdocvar{l1}) (\coqdocvar{ls} ++ \coqdocvar{lc})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{permut0\_trans} \coqdockw{with} (\coqdocvar{l2} ++ \coqdocvar{l0}). \coqdoctac{apply} \coqdocvar{equiv\_equiv}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{permut0\_app1}. \coqdoctac{apply} \coqdocvar{permut0\_sym}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}. \coqdoctac{apply} \coqdocvar{equiv\_equiv}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{rpo\_mul} (\coqdocvar{bb} \coqdocvar{rpo\_infos}) (\coqdocvar{l2} ++ \coqdocvar{l1}) (\coqdocvar{l3} ++ \coqdocvar{l1})).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{List\_mul} \coqdockw{with} \coqdocvar{a} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{lc}. \coqdoctac{trivial}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{rpo\_mul\_inclusion\_right} \coqdockw{with} \coqdocvar{l1}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_forall\_option\_decomposed}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{A}: \coqdockw{Set}) (\coqdocvar{f} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{bool}) (\coqdocvar{l}: \coqdocvar{list} \coqdocvar{A}) (\coqdocvar{t}: \coqdocvar{A}),  \coqdocvar{f} \coqdocvar{t} = \coqdocvar{Some} \coqdocvar{true}  \ensuremath{\rightarrow} (\coqdocvar{list\_forall\_option} \coqdocvar{f} (\coqdocvar{t} :: \coqdocvar{l}) = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\leftrightarrow} \coqdocvar{list\_forall\_option} \coqdocvar{f} \coqdocvar{l} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_exists\_option\_decomposed}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{A}: \coqdockw{Set}) (\coqdocvar{f} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{bool}) (\coqdocvar{l}: \coqdocvar{list} \coqdocvar{A}) (\coqdocvar{t}: \coqdocvar{A}),  \coqdocvar{f} \coqdocvar{t} = \coqdocvar{Some} \coqdocvar{false} \ensuremath{\rightarrow} (\coqdocvar{list\_exists\_option} \coqdocvar{f} (\coqdocvar{t} :: \coqdocvar{l}) = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\leftrightarrow} \coqdocvar{list\_exists\_option} \coqdocvar{f} \coqdocvar{l} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocindent{0.50em}
\coqdockw{Lemma} \coqdocvar{list\_forall\_exists\_option\_true} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{A}: \coqdockw{Set}) (\coqdocvar{f}: \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{bool}) (\coqdocvar{l1} \coqdocvar{l2} : \coqdocvar{list} \coqdocvar{A}), \coqdocvar{list\_forall\_option} (\coqdockw{fun} \coqdocvar{t2}: \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{list\_exists\_option} (\coqdockw{fun} \coqdocvar{t1}: \coqdocvar{A} \ensuremath{\Rightarrow}\coqdoceol
\coqdocnoindent
\coqdocvar{f} \coqdocvar{t1} \coqdocvar{t2}) \coqdocvar{l1}) \coqdocvar{l2} = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow}  \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\land} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= @\coqdocvar{list\_forall\_option\_is\_sound} \coqdocvar{A} (\coqdockw{fun} \coqdocvar{t2} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{list\_exists\_option} (\coqdockw{fun} \coqdocvar{t1} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{t2}) \coqdocvar{l1}) \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} \coqdocvar{a} : \coqdocvar{A},\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{In} \coqdocvar{a} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\land} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{a} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{a}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} ( \coqdocvar{list\_exists\_option} (\coqdockw{fun} \coqdocvar{t1} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{a}) \coqdocvar{l1} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1'}; \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H5}:= @\coqdocvar{list\_exists\_option\_is\_sound} \coqdocvar{A} (\coqdockw{fun} \coqdocvar{t1} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{a}) \coqdocvar{l1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H5}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H5}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}. \coqdoctac{assumption}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H2} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} ( \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1} : \coqdocvar{A}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\land} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H2'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_forall\_exists\_option\_false} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{A}: \coqdockw{Set}) (\coqdocvar{f}: \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{option} \coqdocvar{bool}) (\coqdocvar{l1} \coqdocvar{l2} : \coqdocvar{list} \coqdocvar{A}), \coqdocvar{list\_forall\_option} (\coqdockw{fun} \coqdocvar{t2}: \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{list\_exists\_option} (\coqdockw{fun} \coqdocvar{t1}: \coqdocvar{A} \ensuremath{\Rightarrow}\coqdoceol
\coqdocnoindent
\coqdocvar{f} \coqdocvar{t1} \coqdocvar{t2}) \coqdocvar{l1}) \coqdocvar{l2} = \coqdocvar{Some} \coqdocvar{false} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow}  \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{Some} \coqdocvar{false}) \ensuremath{\lor} (\coqdockw{\ensuremath{\forall}} \coqdocvar{t2} : \coqdocvar{A},\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{In} \coqdocvar{t2} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1} : \coqdocvar{A}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{t2} = \coqdocvar{None} \ensuremath{\rightarrow} \coqdocvar{False}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= @\coqdocvar{list\_forall\_option\_is\_sound} \coqdocvar{A} (\coqdockw{fun} \coqdocvar{t2} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{list\_exists\_option} (\coqdockw{fun} \coqdocvar{t1} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{t2}) \coqdocvar{l1}) \coqdocvar{l2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdoctac{\ensuremath{\exists}} \coqdocvar{a} : \coqdocvar{A},\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{In} \coqdocvar{a} \coqdocvar{l2} \ensuremath{\land} \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{a} = \coqdocvar{Some} \coqdocvar{false}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4}:= @\coqdocvar{list\_exists\_option\_is\_sound} \coqdocvar{A} (\coqdockw{fun} \coqdocvar{t1} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{x}) \coqdocvar{l1}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}. \coqdoctac{apply} \coqdocvar{H4}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} \coqdocvar{a} : \coqdocvar{A}, \coqdocvar{In} \coqdocvar{a} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{l1} \ensuremath{\rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{a} = \coqdocvar{None} \ensuremath{\rightarrow} \coqdocvar{False}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2'}:= \coqdocvar{H1} \coqdocvar{a}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} ( \coqdocvar{list\_exists\_option} (\coqdockw{fun} \coqdocvar{t1} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{a}) \coqdocvar{l1} = \coqdocvar{None} \ensuremath{\rightarrow} \coqdocvar{False}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H2'}; \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6}:= @\coqdocvar{list\_exists\_option\_is\_sound} \coqdocvar{A} (\coqdockw{fun} \coqdocvar{t1} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{a}) \coqdocvar{l1}).\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{list\_exists\_option} (\coqdockw{fun} \coqdocvar{t1} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{f} \coqdocvar{t1} \coqdocvar{a}) \coqdocvar{l1}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{b}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H6}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H6}. \coqdoctac{destruct} \coqdocvar{H6}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H9} \coqdoctac{in} \coqdocvar{H7}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H6}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{a}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H6'}:= \coqdocvar{H6} \coqdocvar{a}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{f} \coqdocvar{a} \coqdocvar{a} =  \coqdocvar{Some} \coqdocvar{false}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H6'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H9} \coqdoctac{in} \coqdocvar{H8}. \coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H6}. \coqdoctac{destruct} \coqdocvar{H6}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H6}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H4}. \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{right}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{exists\_rpo\_eval\_less\_greater}: \coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{a} \coqdocvar{l2}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{a'{}'}, \coqdocvar{In} \coqdocvar{a'{}'} \coqdocvar{l2} \ensuremath{\rightarrow} \coqdocvar{size} \coqdocvar{a} + \coqdocvar{size} \coqdocvar{a'{}'} \ensuremath{\le} \coqdocvar{n}) \ensuremath{\rightarrow} (\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'} : \coqdocvar{term},\coqdoceol
\coqdocindent{4.50em}
\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a'} \coqdocvar{l2} \ensuremath{\land} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{a} \coqdocvar{a'} = \coqdocvar{Some} \coqdocvar{Less\_than}) \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{a'{}'}, \coqdocvar{In} \coqdocvar{a'{}'} \coqdocvar{l2} \ensuremath{\land} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{a'{}'} \coqdocvar{a} = \coqdocvar{Some} \coqdocvar{Greater\_than}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{a} \coqdocvar{l2} \coqdocvar{size\_a} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{mem\_split\_set} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{equiv\_bool\_ok} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{H}) \coqdockw{as} [\coqdocvar{s'{}'} [\coqdocvar{lc'} [\coqdocvar{lc'{}'} [\coqdocvar{s\_eq\_s'{}'} [\coqdocvar{H5} \coqdocvar{\_}]]]]].\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{s'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:=@\coqdocvar{rpo\_eval\_is\_sound\_weak} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{a} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} (\coqdocvar{equiv\_rpo\_equiv\_1} (\coqdocvar{bb} \coqdocvar{rpo\_infos})  \coqdocvar{s\_eq\_s'{}'}) \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}. \coqdoctac{rewrite} \coqdocvar{H5}. \coqdoctac{apply} \coqdocvar{in\_or\_app}. \coqdoctac{right}. \coqdoctac{simpl}. \coqdoctac{left}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{size\_a\_s'{}'}:= \coqdocvar{size\_a} \coqdocvar{s'{}'}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{size} \coqdocvar{a} + \coqdocvar{size} \coqdocvar{s'{}'} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{size\_a\_s'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5}. \coqdoctac{apply} \coqdocvar{in\_or\_app}. \coqdoctac{right}. \coqdoctac{simpl}. \coqdoctac{left}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= @\coqdocvar{rpo\_eval\_is\_complete\_less\_greater} \coqdocvar{rpo\_infos} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{H1}). \coqdoctac{apply} \coqdocvar{H3}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{distribute\_disj\_imply}: \coqdockw{\ensuremath{\forall}} \coqdocvar{P} \coqdocvar{Q} \coqdocvar{R}: \coqdockw{Prop}, ((\coqdocvar{P} \ensuremath{\rightarrow} \coqdocvar{Q}) \ensuremath{\land} (\coqdocvar{R} \ensuremath{\rightarrow} \coqdocvar{Q})) \ensuremath{\rightarrow} ((\coqdocvar{P} \ensuremath{\lor} \coqdocvar{R}) \ensuremath{\rightarrow} \coqdocvar{Q}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{distribute\_impl\_conj}: \coqdockw{\ensuremath{\forall}} \coqdocvar{P} \coqdocvar{Q} \coqdocvar{R}: \coqdockw{Prop}, ((\coqdocvar{P} \ensuremath{\rightarrow} \coqdocvar{Q}) \ensuremath{\land} (\coqdocvar{P} \ensuremath{\rightarrow} \coqdocvar{R})) \ensuremath{\rightarrow} (\coqdocvar{P} \ensuremath{\rightarrow} (\coqdocvar{Q} \ensuremath{\land} \coqdocvar{R})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_is\_sound\_true} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}, \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\rightarrow} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{In} \coqdocvar{s} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{g}, \coqdocvar{In} \coqdocvar{g} \coqdocvar{lg} \ensuremath{\land} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:=@\coqdocvar{list\_gt\_list\_is\_sound} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1'}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_is\_sound\_false} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls},  \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} = \coqdocvar{Some} \coqdocvar{false} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{s}, \coqdocvar{In} \coqdocvar{s} \coqdocvar{ls} \ensuremath{\land} \coqdockw{\ensuremath{\forall}} \coqdocvar{g}, \coqdocvar{In} \coqdocvar{g} \coqdocvar{lg} \ensuremath{\rightarrow} (\coqdocvar{p}  \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\lor} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\lor} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Uncomparable}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}; \coqdocvar{revert} \coqdocvar{lg}; \coqdoctac{induction} \coqdocvar{ls} \coqdockw{as} [ \ensuremath{|} \coqdocvar{s} \coqdocvar{ls}]; \coqdoctac{intro} \coqdocvar{lg}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{compute} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list}; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{list\_exists\_option\_is\_sound} \coqdoceol
\coqdocindent{1.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end}) \coqdocvar{lg}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} \coqdoceol
\coqdocnoindent
(\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{2.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{2.50em}
\coqdockw{end}) \coqdocvar{lg}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros} [\coqdocvar{g} [\coqdocvar{g\_in\_ls} \coqdocvar{H}]].\coqdoceol
\coqdocnoindent
\coqdoctac{generalize} (\coqdocvar{IHls} \coqdocvar{lg}); \coqdoctac{unfold} \coqdocvar{list\_gt\_list};\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdoceol
\coqdocnoindent
(\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{s0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{g0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g0} \coqdocvar{s0} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) \coqdocvar{lg}) \coqdocvar{ls}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{g} \coqdocvar{s}) \coqdockw{as} [[ \ensuremath{|} \ensuremath{|} \ensuremath{|} ] \ensuremath{|} ]. \coqdoctac{discriminate}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdoctac{\ensuremath{\exists}} \coqdocvar{s} : \coqdocvar{term},\coqdoceol
\coqdocindent{4.50em}
\coqdocvar{In} \coqdocvar{s} \coqdocvar{ls} \ensuremath{\land}\coqdoceol
\coqdocindent{4.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{g} : \coqdocvar{term},\coqdoceol
\coqdocindent{5.00em}
\coqdocvar{In} \coqdocvar{g} \coqdocvar{lg} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{5.00em}
(\coqdocvar{p} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\lor}\coqdoceol
\coqdocindent{5.50em}
\coqdocvar{p} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\lor} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Uncomparable}))).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H0}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}. \coqdoctac{trivial}. \coqdoctac{assumption}. \coqdoctac{discriminate}. \coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{destruct} \coqdoceol
\coqdocnoindent
(\coqdocvar{list\_forall\_option}\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{fun} \coqdocvar{s0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{2.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{fun} \coqdocvar{g0} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g0} \coqdocvar{s0} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end}) \coqdocvar{lg}) \coqdocvar{ls}) \coqdockw{as} [[ \ensuremath{|} ] \ensuremath{|} ].\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}. \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= \coqdocvar{H} \coqdocvar{g}). \coqdoctac{assert} (\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end} = \coqdocvar{Some} \coqdocvar{false}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{g} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}. \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{right}. \coqdoctac{right}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}. \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= \coqdocvar{H} \coqdocvar{g}). \coqdoctac{assert} (\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{3.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{3.50em}
\coqdockw{end} = \coqdocvar{Some} \coqdocvar{false}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{g} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}. \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{right}. \coqdoctac{right}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{discriminate}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_is\_sound\_none}:   \coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls},  \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} = \coqdocvar{None} \ensuremath{\rightarrow} (\coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}: \coqdocvar{term}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{ls} \ensuremath{\land} ((\coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}:\coqdocvar{term}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{lg} \ensuremath{\land} \coqdocvar{p} \coqdocvar{t2} \coqdocvar{t1} = \coqdocvar{None}) \ensuremath{\land}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{lg} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t2} \coqdocvar{t1} = \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\rightarrow} \coqdocvar{False}))).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{b}. \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list} \coqdoctac{in} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1} := @\coqdocvar{list\_forall\_option\_is\_sound} \coqdocvar{term} (\coqdockw{fun} \coqdocvar{s} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{6.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{end}) \coqdocvar{lg}) \coqdocvar{ls}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= @\coqdocvar{list\_exists\_option\_is\_sound} \coqdocvar{term} (\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{x} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{lg}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}. \coqdoctac{split}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x0}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{x0} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}. \coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{destruct} \coqdocvar{H3}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{destruct} \coqdocvar{H3}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{destruct} \coqdocvar{H3}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{destruct} \coqdocvar{H3}. \coqdoctac{split}. \coqdoctac{assumption}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4'} := \coqdocvar{H4} \coqdocvar{t2}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H6} \coqdoctac{in} \coqdocvar{H4'}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H4'}. \coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_is\_complete\_true}:\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}, ( \coqdockw{\ensuremath{\forall}} \coqdocvar{s}, \coqdocvar{In} \coqdocvar{s} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdoctac{\ensuremath{\exists}} \coqdocvar{g}, \coqdocvar{In} \coqdocvar{g} \coqdocvar{lg} \ensuremath{\land} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Greater\_than}) \ensuremath{\rightarrow}  \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} = \coqdocvar{Some} \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{ls}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{compute}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_forall\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_exists\_option\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{H} \coqdocvar{a0}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdoctac{\ensuremath{\exists}} \coqdocvar{g} : \coqdocvar{term}, \coqdocvar{In} \coqdocvar{g} \coqdocvar{lg} \ensuremath{\land} \coqdocvar{p} \coqdocvar{g} \coqdocvar{a0} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_is\_complete\_false}: \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{g} \coqdocvar{s}, \coqdocvar{In} \coqdocvar{g} \coqdocvar{lg} \ensuremath{\rightarrow} \coqdocvar{In} \coqdocvar{s} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \ensuremath{\not=} \coqdocvar{None}) \ensuremath{\rightarrow} (\coqdoctac{\ensuremath{\exists}} \coqdocvar{s}, \coqdocvar{In} \coqdocvar{s} \coqdocvar{ls} \ensuremath{\land} \coqdockw{\ensuremath{\forall}} \coqdocvar{g}, \coqdocvar{In} \coqdocvar{g} \coqdocvar{lg} \ensuremath{\rightarrow} (\coqdocvar{p}  \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\lor} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\lor} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Uncomparable})) \ensuremath{\rightarrow}  \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} = \coqdocvar{Some} \coqdocvar{false}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{ls}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_forall\_option\_is\_complete\_false}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_exists\_option\_is\_complete\_false}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{H1} \coqdocvar{a0}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} ( \coqdocvar{p} \coqdocvar{a0} \coqdocvar{x} = \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\lor}\coqdoceol
\coqdocindent{3.50em}
\coqdocvar{p} \coqdocvar{a0} \coqdocvar{x} = \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\lor} \coqdocvar{p} \coqdocvar{a0} \coqdocvar{x} = \coqdocvar{Some} \coqdocvar{Uncomparable}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H3}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H4}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H4}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H4}; \coqdoctac{rewrite} \coqdocvar{H4}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= @\coqdocvar{list\_exists\_option\_is\_sound} \coqdocvar{term} (\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{a0} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{lg}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H3}. \coqdoctac{destruct} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4'}:= \coqdocvar{H4} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdockw{match} \coqdocvar{p} \coqdocvar{x} \coqdocvar{a0} \coqdockw{with}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{4.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{4.00em}
\coqdockw{end} = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{False}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H4'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H6}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{x} \coqdocvar{a0}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H7} \coqdoctac{in} \coqdocvar{H5}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H7} \coqdoctac{in} \coqdocvar{H5}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H7} \coqdoctac{in} \coqdocvar{H5}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H7} \coqdoctac{in} \coqdocvar{H5}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H8}:= \coqdocvar{H} \coqdocvar{x} \coqdocvar{a0}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H8} \coqdoctac{in} \coqdocvar{H7}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_cons\_right\_true}: \coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{a}, \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} (\coqdocvar{a}::\coqdocvar{ls}) = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} = \coqdocvar{Some} \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_gt\_list\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= @\coqdocvar{list\_forall\_option\_is\_sound} \coqdocvar{term} (\coqdockw{fun} \coqdocvar{s} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{5.50em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{end}) ( \coqdocvar{lg})) (\coqdocvar{a}:: \coqdocvar{ls}) ).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{clear} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{s}). \coqdoctac{clear} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{5.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{end}) ( \coqdocvar{lg}) = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1'}. \coqdoctac{simpl}. \coqdoctac{right}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H0'}:= @\coqdocvar{list\_exists\_option\_is\_sound} \coqdocvar{term} (\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) (\coqdocvar{lg})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H0'}. \coqdoctac{destruct} \coqdocvar{H0'}. \coqdoctac{destruct} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{x} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_cons\_right\_true\_1}: \coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{a}, (\coqdoctac{\ensuremath{\exists}} \coqdocvar{a'}, \coqdocvar{In} \coqdocvar{a'} \coqdocvar{lg} \ensuremath{\land} \coqdocvar{p} \coqdocvar{a'} \coqdocvar{a} = \coqdocvar{Some} \coqdocvar{Greater\_than}) \ensuremath{\rightarrow} \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} (\coqdocvar{a} :: \coqdocvar{ls}) = \coqdocvar{Some} \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_gt\_list\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list} \coqdoctac{in} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H0'}:= @\coqdocvar{list\_forall\_option\_is\_sound} \coqdocvar{term} (\coqdockw{fun} \coqdocvar{s} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{6.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{end}) \coqdocvar{lg}) \coqdocvar{ls}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H0'}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H1}. \coqdoctac{clear} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H1}. \coqdoctac{clear} \coqdocvar{H1} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H0'{}'}:= \coqdocvar{H0'} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{clear} \coqdocvar{H0'}. \coqdoctac{assert} ( \coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{5.50em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{end}) \coqdocvar{lg} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H0'{}'}. \coqdoctac{trivial}. \coqdoctac{clear} \coqdocvar{H0'{}'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= @\coqdocvar{list\_exists\_option\_is\_sound} \coqdocvar{term} (\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{lg} ).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{x} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H4} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H4} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H4} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H4} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma}  \coqdocvar{list\_gt\_list\_cons\_left\_true}: \coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{a}, \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{list\_gt\_list} \coqdocvar{p} (\coqdocvar{a}::\coqdocvar{lg}) \coqdocvar{ls} = \coqdocvar{Some} \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_gt\_list\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= @\coqdocvar{list\_forall\_option\_is\_sound} \coqdocvar{term} (\coqdockw{fun} \coqdocvar{s} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{4.50em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{5.50em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{6.00em}
\coqdockw{end}) \coqdocvar{lg}) \coqdocvar{ls}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{clear} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{s}). \coqdoctac{clear} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{5.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.50em}
\coqdockw{end}) \coqdocvar{lg} = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1'}; \coqdoctac{trivial}. \coqdoctac{clear} \coqdocvar{H1'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:=@\coqdocvar{list\_exists\_option\_is\_sound} \coqdocvar{term} (\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) \coqdocvar{lg}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{clear} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H1}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}. \coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}. \coqdoctac{right}. \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{x} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma}  \coqdocvar{list\_gt\_list\_cons\_left\_true\_1}: \coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} \coqdocvar{a}, (\coqdockw{\ensuremath{\forall}} \coqdocvar{a'}, \coqdocvar{In} \coqdocvar{a'} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{a} \coqdocvar{a'} \ensuremath{\not=} \coqdocvar{Some} \coqdocvar{Greater\_than}) \ensuremath{\rightarrow} \coqdocvar{list\_gt\_list} \coqdocvar{p} (\coqdocvar{a}::\coqdocvar{lg}) \coqdocvar{ls} = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} = \coqdocvar{Some} \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_gt\_list\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list} \coqdoctac{in} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H0'}:= @\coqdocvar{list\_forall\_option\_is\_sound} \coqdocvar{term} (\coqdockw{fun} \coqdocvar{s} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{6.00em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{6.50em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{end}) (\coqdocvar{a}::\coqdocvar{lg})) \coqdocvar{ls}).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H0'}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{H0'} \coqdocvar{s}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{list\_exists\_option}\coqdoceol
\coqdocindent{4.50em}
(\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) (\coqdocvar{a} :: \coqdocvar{lg}) = \coqdocvar{Some} \coqdocvar{true}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H2}; \coqdoctac{trivial}. \coqdoctac{clear} \coqdocvar{H0'} \coqdocvar{H2} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4} := @\coqdocvar{list\_exists\_option\_is\_sound} \coqdocvar{term} (\coqdockw{fun} \coqdocvar{g} : \coqdocvar{term} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{match} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Equivalent} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Less\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{true}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{Some} \coqdocvar{Uncomparable} \ensuremath{\Rightarrow} \coqdocvar{Some} \coqdocvar{false}\coqdoceol
\coqdocindent{5.00em}
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{None}\coqdoceol
\coqdocindent{5.00em}
\coqdockw{end}) (\coqdocvar{a} :: \coqdocvar{lg})).\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{clear} \coqdocvar{H3}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H4}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H'}:= \coqdocvar{H} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{x} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\not=} \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H'}; \coqdoctac{trivial}. \coqdocvar{contradict} \coqdocvar{H4}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{x} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H3} \coqdoctac{in} \coqdocvar{H2}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mult\_eval\_greater\_less}: \coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}, \coqdocvar{mult\_eval} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} = \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\land} (\coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{ls} \coqdocvar{lg} = \coqdocvar{Some} \coqdocvar{false}) \ensuremath{\rightarrow} \coqdocvar{mult\_eval} \coqdocvar{p} \coqdocvar{ls} \coqdocvar{lg} = \coqdocvar{Some} \coqdocvar{Less\_than}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{mult\_eval} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}). \coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{b}. \coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{mult\_eval}. \coqdoctac{rewrite} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{ls} \coqdocvar{lg}). \coqdoctac{destruct} \coqdocvar{b}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H1} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_forall\_option\_is\_complete\_none} :\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} (\coqdocvar{A} : \coqdockw{Set}) \coqdocvar{f} \coqdocvar{l}, (\coqdoctac{\ensuremath{\exists}} \coqdocvar{a}, \coqdocvar{In} \coqdocvar{a} \coqdocvar{l} \ensuremath{\land} \coqdocvar{f} \coqdocvar{a} = \coqdocvar{None}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
@\coqdocvar{list\_forall\_option} \coqdocvar{A} \coqdocvar{f} \coqdocvar{l} = \coqdocvar{None}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{A0} \coqdocvar{f} \coqdocvar{l}; \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [ \ensuremath{|} \coqdocvar{a} \coqdocvar{l}].\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}. \coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} ((\coqdoctac{\ensuremath{\exists}} \coqdocvar{a0}, \coqdocvar{a} = \coqdocvar{a0} \ensuremath{\land} \coqdocvar{f} \coqdocvar{a0} = \coqdocvar{None}) \ensuremath{\lor} (\coqdoctac{\ensuremath{\exists}} \coqdocvar{a0}, \coqdocvar{In} \coqdocvar{a0} \coqdocvar{l} \ensuremath{\land} \coqdocvar{f} \coqdocvar{a0} = \coqdocvar{None})).\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{split};\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H1}. \coqdoctac{trivial}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{f} \coqdocvar{a}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{b}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}. \coqdoctac{assumption}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{list\_forall\_option} \coqdocvar{f} \coqdocvar{l}). \coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{list\_forall\_option} \coqdocvar{f} \coqdocvar{l} = \coqdocvar{None}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{IHl}. \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{H3}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_is\_complete\_none\_1}: \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}, \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} \ensuremath{\not=} \coqdocvar{Some} \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} \ensuremath{\not=} \coqdocvar{Some} \coqdocvar{false} \ensuremath{\rightarrow}  \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} =  \coqdocvar{None}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{b}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_is\_complete\_none}: \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls}, (\coqdoctac{\ensuremath{\exists}} \coqdocvar{t1}: \coqdocvar{term}, \coqdocvar{In} \coqdocvar{t1} \coqdocvar{ls} \ensuremath{\land} ((\coqdoctac{\ensuremath{\exists}} \coqdocvar{t2}:\coqdocvar{term}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{lg} \ensuremath{\land} \coqdocvar{p} \coqdocvar{t2} \coqdocvar{t1} = \coqdocvar{None}) \ensuremath{\land}\coqdoceol
\coqdocindent{3.50em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{t2}, \coqdocvar{In} \coqdocvar{t2} \coqdocvar{lg} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{t2} \coqdocvar{t1} = \coqdocvar{Some} \coqdocvar{Greater\_than} \ensuremath{\rightarrow} \coqdocvar{False})))  \ensuremath{\rightarrow}  \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{lg} \coqdocvar{ls} =  \coqdocvar{None}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{list\_gt\_list}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_forall\_option\_is\_complete\_none}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_exists\_option\_is\_complete\_none}.\coqdoceol
\coqdocnoindent
\coqdoctac{\ensuremath{\exists}} \coqdocvar{x0}.\coqdoceol
\coqdocnoindent
\coqdoctac{split}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H2}. \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}:= \coqdocvar{H1} \coqdocvar{a}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1'}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdocvar{case\_eq} (\coqdocvar{p} \coqdocvar{a} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{c}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H5} \coqdoctac{in} \coqdocvar{H4}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{forall\_not} :\coqdoceol
\coqdocindent{1.50em}
\coqdockw{\ensuremath{\forall}} (\coqdocvar{V}: \coqdockw{Set}) (\coqdocvar{P} : \coqdocvar{V} \ensuremath{\rightarrow} \coqdockw{Prop}),  \ensuremath{\lnot} (\coqdoctac{\ensuremath{\exists}} \coqdocvar{x} : \coqdocvar{V}, \coqdocvar{P} \coqdocvar{x}) \ensuremath{\rightarrow} \coqdockw{\ensuremath{\forall}} \coqdocvar{x} : \coqdocvar{V}, \ensuremath{\lnot} \coqdocvar{P} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{firstorder}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{not\_forall}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{V}:\coqdockw{Set})(\coqdocvar{P} : \coqdocvar{V} \ensuremath{\rightarrow} \coqdockw{Prop}), (\coqdoctac{\ensuremath{\exists}} \coqdocvar{x} : \coqdocvar{V},  \ensuremath{\lnot} \coqdocvar{P} \coqdocvar{x}) \ensuremath{\rightarrow} \ensuremath{\lnot} (\coqdockw{\ensuremath{\forall}} \coqdocvar{x} : \coqdocvar{V},  \coqdocvar{P} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{not}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{firstorder}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{exists\_not\_impl}: \coqdockw{\ensuremath{\forall}} \coqdocvar{l2} \coqdocvar{a1} \coqdocvar{l1} \coqdocvar{n} \coqdocvar{rpo\_infos}, (\coqdoctac{\ensuremath{\exists}} \coqdocvar{x},  (\coqdocvar{In} \coqdocvar{x} \coqdocvar{l2}) \ensuremath{\land}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\lnot} (\coqdoctac{\ensuremath{\exists}} \coqdocvar{g} : \coqdocvar{term},\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{In} \coqdocvar{g} (\coqdocvar{a1} :: \coqdocvar{l1}) \ensuremath{\land} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{x} = \coqdocvar{Some} \coqdocvar{Greater\_than}))->(\coqdoctac{\ensuremath{\exists}} \coqdocvar{x} : \coqdocvar{term},\coqdoceol
\coqdocindent{2.50em}
\ensuremath{\lnot}\coqdoceol
\coqdocindent{2.50em}
(\coqdocvar{In} \coqdocvar{x} \coqdocvar{l2} \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{g} : \coqdocvar{term},\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{In} \coqdocvar{g} (\coqdocvar{a1} :: \coqdocvar{l1}) \ensuremath{\land} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{x} = \coqdocvar{Some} \coqdocvar{Greater\_than})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{firstorder}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{exists\_exists\_not} :  \coqdockw{\ensuremath{\forall}} \coqdocvar{l2} \coqdocvar{a1} \coqdocvar{l1} \coqdocvar{n} \coqdocvar{rpo\_infos}, \coqdoceol
\coqdocindent{1.00em}
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{x},  (\coqdocvar{In} \coqdocvar{x} \coqdocvar{l2}) \ensuremath{\land}\coqdoceol
\coqdocindent{3.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{g} : \coqdocvar{term},\coqdoceol
\coqdocindent{3.50em}
\ensuremath{\lnot} \coqdocvar{In} \coqdocvar{g} (\coqdocvar{a1} :: \coqdocvar{l1}) \ensuremath{\lor} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{x} \ensuremath{\not=} \coqdocvar{Some} \coqdocvar{Greater\_than})) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
(\coqdoctac{\ensuremath{\exists}} \coqdocvar{x},  (\coqdocvar{In} \coqdocvar{x} \coqdocvar{l2}) \ensuremath{\land}\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\lnot} (\coqdoctac{\ensuremath{\exists}} \coqdocvar{g} : \coqdocvar{term},\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{In} \coqdocvar{g} (\coqdocvar{a1} :: \coqdocvar{l1}) \ensuremath{\land} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{g} \coqdocvar{x} = \coqdocvar{Some} \coqdocvar{Greater\_than})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{firstorder}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{list\_gt\_list\_cons\_commute\_right\_true}:  \coqdockw{\ensuremath{\forall}}  \coqdocvar{p} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{a1} \coqdocvar{a2}, \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{l2} (\coqdocvar{a1}:: \coqdocvar{a2} :: \coqdocvar{l1}) = \coqdocvar{Some} \coqdocvar{true} \ensuremath{\rightarrow} \coqdocvar{list\_gt\_list} \coqdocvar{p} \coqdocvar{l2} (\coqdocvar{a2} :: \coqdocvar{a1} :: \coqdocvar{l1})  = \coqdocvar{Some} \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{list\_gt\_list\_is\_complete\_true}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1'}:= @\coqdocvar{list\_gt\_list\_is\_sound\_true} \coqdocvar{p}  \coqdocvar{l2} (\coqdocvar{a1} :: \coqdocvar{a2} :: \coqdocvar{l1})).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} \coqdocvar{s} : \coqdocvar{term},\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{In} \coqdocvar{s} (\coqdocvar{a1} :: \coqdocvar{a2} :: \coqdocvar{l1}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{g} : \coqdocvar{term}, \coqdocvar{In} \coqdocvar{g} \coqdocvar{l2} \ensuremath{\land} \coqdocvar{p} \coqdocvar{g} \coqdocvar{s} = \coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1'}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H0'}:= \coqdocvar{H0} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H0'}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{antisym\_rpo}: \coqdockw{\ensuremath{\forall}} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{a} \coqdocvar{b}, \coqdocvar{size} \coqdocvar{a} + \coqdocvar{size} \coqdocvar{b} \ensuremath{\le} \coqdocvar{n} \ensuremath{\rightarrow} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{a} \coqdocvar{b}) \ensuremath{\land} (\coqdocvar{rpo} \coqdocvar{rpo\_infos}.(\coqdocvar{bb}) \coqdocvar{b} \coqdocvar{a}) \ensuremath{\rightarrow} \coqdocvar{False}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H2}:= \coqdocvar{rpo\_eval\_is\_complete\_less\_greater}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H3}:= \coqdocvar{H2} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{a} \coqdocvar{b}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H4}:= \coqdocvar{H2} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{b} \coqdocvar{a}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{size} \coqdocvar{b} + \coqdocvar{size} \coqdocvar{a} \ensuremath{\le} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdoctac{omega}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{a} \coqdocvar{b} = \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{\land} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{b} \coqdocvar{a} =\coqdoceol
\coqdocindent{6.50em}
\coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H3}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{b} \coqdocvar{a} = \coqdocvar{Some} \coqdocvar{Less\_than}\coqdoceol
\coqdocindent{5.50em}
\ensuremath{\land} \coqdocvar{rpo\_eval} \coqdocvar{rpo\_infos} \coqdocvar{n} \coqdocvar{a} \coqdocvar{b} =\coqdoceol
\coqdocindent{6.50em}
\coqdocvar{Some} \coqdocvar{Greater\_than}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H4}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H6}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H7}.\coqdoceol
\coqdocnoindent
\coqdoctac{rewrite} \coqdocvar{H6} \coqdoctac{in} \coqdocvar{H9}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradict} \coqdocvar{H9}.\coqdoceol
\coqdocnoindent
\coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mem\_concat}: \coqdockw{\ensuremath{\forall}} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a} (\coqdocvar{ls} ++ \coqdocvar{lc}) \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a} \coqdocvar{ls} \ensuremath{\lor} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a} \coqdocvar{lc}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{ls}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{right}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H1}:= \coqdocvar{IHls} \coqdocvar{lc}).\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a} \coqdocvar{ls} \ensuremath{\lor} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a} \coqdocvar{lc}).\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H1}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{tauto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{mem\_concat\_1}: \coqdockw{\ensuremath{\forall}} \coqdocvar{a} \coqdocvar{ls} \coqdocvar{lc}, \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a} \coqdocvar{ls} \ensuremath{\rightarrow} \coqdocvar{mem} \coqdocvar{equiv} \coqdocvar{a} (\coqdocvar{ls} ++ \coqdocvar{lc}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{ls}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}.\coqdoceol
\coqdocnoindent
\coqdoctac{simpl}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdoctac{left}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdoctac{assert} (\coqdocvar{H0}:= \coqdocvar{IHls} \coqdocvar{lc}).\coqdoceol
\coqdocnoindent
\coqdoctac{right}.\coqdoceol
\coqdocnoindent
\coqdoctac{apply} \coqdocvar{H0}; \coqdoctac{trivial}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqdocvar{S}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqdocvar{Make}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\end{coqdoccode}
\end{document}
